import{K as ve,S as he,i as de,s as me,k as A,l as C,m as D,h as p,n as L,b as N,I as le,a as x,q as G,c as j,r as F,H as $,L as be,g as y,v as oe,d as M,f as ce,u as Ne,y as W,z as J,A as K,B as Z,M as ur,e as re,J as se,N as Rt,C as He,E as xe,F as je,G as qe,w as it,O as at,P as lt,Q as ke,R as Ve,T as Ct,U as xn,V as ot,W as jn,X as Ke,Y as Be,Z as qn,_ as hr,$ as Yn,a0 as Vt,p as Ht,a1 as xt,o as dr}from"../chunks/index.f1dec4c8.js";import{w as ye}from"../chunks/index.1d5e81c1.js";function mr(i){if(i.__esModule)return i;var e=i.default;if(typeof e=="function"){var t=function n(){if(this instanceof n){var r=[null];r.push.apply(r,arguments);var s=Function.bind.apply(e,r);return new s}return e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(i).forEach(function(n){var r=Object.getOwnPropertyDescriptor(i,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return i[n]}})}),t}var Ce={},pr={get exports(){return Ce},set exports(i){Ce=i}};const Er="2.0.0",_r=256,gr=Number.MAX_SAFE_INTEGER||9007199254740991,br=16,vr=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var ht={MAX_LENGTH:_r,MAX_SAFE_COMPONENT_LENGTH:br,MAX_SAFE_INTEGER:gr,RELEASE_TYPES:vr,SEMVER_SPEC_VERSION:Er,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2};const $r=typeof process=="object"&&process.env&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?(...i)=>console.error("SEMVER",...i):()=>{};var dt=$r;(function(i,e){const{MAX_SAFE_COMPONENT_LENGTH:t}=ht,n=dt;e=i.exports={};const r=e.re=[],s=e.src=[],a=e.t={};let l=0;const o=(c,u,f)=>{const d=l++;n(c,d,u),a[c]=d,s[d]=u,r[d]=new RegExp(u,f?"g":void 0)};o("NUMERICIDENTIFIER","0|[1-9]\\d*"),o("NUMERICIDENTIFIERLOOSE","[0-9]+"),o("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),o("MAINVERSION",`(${s[a.NUMERICIDENTIFIER]})\\.(${s[a.NUMERICIDENTIFIER]})\\.(${s[a.NUMERICIDENTIFIER]})`),o("MAINVERSIONLOOSE",`(${s[a.NUMERICIDENTIFIERLOOSE]})\\.(${s[a.NUMERICIDENTIFIERLOOSE]})\\.(${s[a.NUMERICIDENTIFIERLOOSE]})`),o("PRERELEASEIDENTIFIER",`(?:${s[a.NUMERICIDENTIFIER]}|${s[a.NONNUMERICIDENTIFIER]})`),o("PRERELEASEIDENTIFIERLOOSE",`(?:${s[a.NUMERICIDENTIFIERLOOSE]}|${s[a.NONNUMERICIDENTIFIER]})`),o("PRERELEASE",`(?:-(${s[a.PRERELEASEIDENTIFIER]}(?:\\.${s[a.PRERELEASEIDENTIFIER]})*))`),o("PRERELEASELOOSE",`(?:-?(${s[a.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[a.PRERELEASEIDENTIFIERLOOSE]})*))`),o("BUILDIDENTIFIER","[0-9A-Za-z-]+"),o("BUILD",`(?:\\+(${s[a.BUILDIDENTIFIER]}(?:\\.${s[a.BUILDIDENTIFIER]})*))`),o("FULLPLAIN",`v?${s[a.MAINVERSION]}${s[a.PRERELEASE]}?${s[a.BUILD]}?`),o("FULL",`^${s[a.FULLPLAIN]}$`),o("LOOSEPLAIN",`[v=\\s]*${s[a.MAINVERSIONLOOSE]}${s[a.PRERELEASELOOSE]}?${s[a.BUILD]}?`),o("LOOSE",`^${s[a.LOOSEPLAIN]}$`),o("GTLT","((?:<|>)?=?)"),o("XRANGEIDENTIFIERLOOSE",`${s[a.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),o("XRANGEIDENTIFIER",`${s[a.NUMERICIDENTIFIER]}|x|X|\\*`),o("XRANGEPLAIN",`[v=\\s]*(${s[a.XRANGEIDENTIFIER]})(?:\\.(${s[a.XRANGEIDENTIFIER]})(?:\\.(${s[a.XRANGEIDENTIFIER]})(?:${s[a.PRERELEASE]})?${s[a.BUILD]}?)?)?`),o("XRANGEPLAINLOOSE",`[v=\\s]*(${s[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[a.XRANGEIDENTIFIERLOOSE]})(?:${s[a.PRERELEASELOOSE]})?${s[a.BUILD]}?)?)?`),o("XRANGE",`^${s[a.GTLT]}\\s*${s[a.XRANGEPLAIN]}$`),o("XRANGELOOSE",`^${s[a.GTLT]}\\s*${s[a.XRANGEPLAINLOOSE]}$`),o("COERCE",`(^|[^\\d])(\\d{1,${t}})(?:\\.(\\d{1,${t}}))?(?:\\.(\\d{1,${t}}))?(?:$|[^\\d])`),o("COERCERTL",s[a.COERCE],!0),o("LONETILDE","(?:~>?)"),o("TILDETRIM",`(\\s*)${s[a.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",o("TILDE",`^${s[a.LONETILDE]}${s[a.XRANGEPLAIN]}$`),o("TILDELOOSE",`^${s[a.LONETILDE]}${s[a.XRANGEPLAINLOOSE]}$`),o("LONECARET","(?:\\^)"),o("CARETTRIM",`(\\s*)${s[a.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",o("CARET",`^${s[a.LONECARET]}${s[a.XRANGEPLAIN]}$`),o("CARETLOOSE",`^${s[a.LONECARET]}${s[a.XRANGEPLAINLOOSE]}$`),o("COMPARATORLOOSE",`^${s[a.GTLT]}\\s*(${s[a.LOOSEPLAIN]})$|^$`),o("COMPARATOR",`^${s[a.GTLT]}\\s*(${s[a.FULLPLAIN]})$|^$`),o("COMPARATORTRIM",`(\\s*)${s[a.GTLT]}\\s*(${s[a.LOOSEPLAIN]}|${s[a.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",o("HYPHENRANGE",`^\\s*(${s[a.XRANGEPLAIN]})\\s+-\\s+(${s[a.XRANGEPLAIN]})\\s*$`),o("HYPHENRANGELOOSE",`^\\s*(${s[a.XRANGEPLAINLOOSE]})\\s+-\\s+(${s[a.XRANGEPLAINLOOSE]})\\s*$`),o("STAR","(<|>)?=?\\s*\\*"),o("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),o("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(pr,Ce);const Nr=Object.freeze({loose:!0}),yr=Object.freeze({}),Sr=i=>i?typeof i!="object"?Nr:i:yr;var Mt=Sr;const jt=/^[0-9]+$/,zn=(i,e)=>{const t=jt.test(i),n=jt.test(e);return t&&n&&(i=+i,e=+e),i===e?0:t&&!n?-1:n&&!t?1:i<e?-1:1},wr=(i,e)=>zn(e,i);var Xn={compareIdentifiers:zn,rcompareIdentifiers:wr};const Ir={},Rr=Object.freeze(Object.defineProperty({__proto__:null,default:Ir},Symbol.toStringTag,{value:"Module"})),Ar=mr(Rr),Qe=dt,{MAX_LENGTH:qt,MAX_SAFE_INTEGER:et}=ht,{re:Yt,t:zt}=Ce,Cr=Mt,{compareIdentifiers:Le}=Xn;let Mr=class Ie{constructor(e,t){if(t=Cr(t),e instanceof Ie){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid Version: ${Ar.inspect(e)}`);if(e.length>qt)throw new TypeError(`version is longer than ${qt} characters`);Qe("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?Yt[zt.LOOSE]:Yt[zt.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>et||this.major<0)throw new TypeError("Invalid major version");if(this.minor>et||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>et||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(r=>{if(/^[0-9]+$/.test(r)){const s=+r;if(s>=0&&s<et)return s}return r}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(Qe("SemVer.compare",this.version,this.options,e),!(e instanceof Ie)){if(typeof e=="string"&&e===this.version)return 0;e=new Ie(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof Ie||(e=new Ie(e,this.options)),Le(this.major,e.major)||Le(this.minor,e.minor)||Le(this.patch,e.patch)}comparePre(e){if(e instanceof Ie||(e=new Ie(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],r=e.prerelease[t];if(Qe("prerelease compare",t,n,r),n===void 0&&r===void 0)return 0;if(r===void 0)return 1;if(n===void 0)return-1;if(n===r)continue;return Le(n,r)}while(++t)}compareBuild(e){e instanceof Ie||(e=new Ie(e,this.options));let t=0;do{const n=this.build[t],r=e.build[t];if(Qe("prerelease compare",t,n,r),n===void 0&&r===void 0)return 0;if(r===void 0)return 1;if(n===void 0)return-1;if(n===r)continue;return Le(n,r)}while(++t)}inc(e,t,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const r=Number(n)?1:0;if(!t&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[r];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);if(s===-1){if(t===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(r)}}if(t){let s=[t,r];n===!1&&(s=[t]),Le(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}};var ge=Mr;const Xt=ge,Tr=(i,e,t=!1)=>{if(i instanceof Xt)return i;try{return new Xt(i,e)}catch(n){if(!t)return null;throw n}};var Ye=Tr;const Or=Ye,Lr=(i,e)=>{const t=Or(i,e);return t?t.version:null};var Dr=Lr;const kr=Ye,Pr=(i,e)=>{const t=kr(i.trim().replace(/^[=v]+/,""),e);return t?t.version:null};var Br=Pr;const Wt=ge,Ur=(i,e,t,n,r)=>{typeof t=="string"&&(r=n,n=t,t=void 0);try{return new Wt(i instanceof Wt?i.version:i,t).inc(e,n,r).version}catch{return null}};var Gr=Ur;const Jt=Ye,Fr=(i,e)=>{const t=Jt(i,null,!0),n=Jt(e,null,!0),r=t.compare(n);if(r===0)return null;const s=r>0,a=s?t:n,l=s?n:t,o=!!a.prerelease.length,c=o?"pre":"";return t.major!==n.major?c+"major":t.minor!==n.minor?c+"minor":t.patch!==n.patch?c+"patch":o?"prerelease":l.patch?"patch":l.minor?"minor":"major"};var Vr=Fr;const Hr=ge,xr=(i,e)=>new Hr(i,e).major;var jr=xr;const qr=ge,Yr=(i,e)=>new qr(i,e).minor;var zr=Yr;const Xr=ge,Wr=(i,e)=>new Xr(i,e).patch;var Jr=Wr;const Kr=Ye,Zr=(i,e)=>{const t=Kr(i,e);return t&&t.prerelease.length?t.prerelease:null};var Qr=Zr;const Kt=ge,es=(i,e,t)=>new Kt(i,t).compare(new Kt(e,t));var Se=es;const ts=Se,ns=(i,e,t)=>ts(e,i,t);var rs=ns;const ss=Se,is=(i,e)=>ss(i,e,!0);var as=is;const Zt=ge,ls=(i,e,t)=>{const n=new Zt(i,t),r=new Zt(e,t);return n.compare(r)||n.compareBuild(r)};var Tt=ls;const os=Tt,cs=(i,e)=>i.sort((t,n)=>os(t,n,e));var fs=cs;const us=Tt,hs=(i,e)=>i.sort((t,n)=>us(n,t,e));var ds=hs;const ms=Se,ps=(i,e,t)=>ms(i,e,t)>0;var mt=ps;const Es=Se,_s=(i,e,t)=>Es(i,e,t)<0;var Ot=_s;const gs=Se,bs=(i,e,t)=>gs(i,e,t)===0;var Wn=bs;const vs=Se,$s=(i,e,t)=>vs(i,e,t)!==0;var Jn=$s;const Ns=Se,ys=(i,e,t)=>Ns(i,e,t)>=0;var Lt=ys;const Ss=Se,ws=(i,e,t)=>Ss(i,e,t)<=0;var Dt=ws;const Is=Wn,Rs=Jn,As=mt,Cs=Lt,Ms=Ot,Ts=Dt,Os=(i,e,t,n)=>{switch(e){case"===":return typeof i=="object"&&(i=i.version),typeof t=="object"&&(t=t.version),i===t;case"!==":return typeof i=="object"&&(i=i.version),typeof t=="object"&&(t=t.version),i!==t;case"":case"=":case"==":return Is(i,t,n);case"!=":return Rs(i,t,n);case">":return As(i,t,n);case">=":return Cs(i,t,n);case"<":return Ms(i,t,n);case"<=":return Ts(i,t,n);default:throw new TypeError(`Invalid operator: ${e}`)}};var Kn=Os;const Ls=ge,Ds=Ye,{re:tt,t:nt}=Ce,ks=(i,e)=>{if(i instanceof Ls)return i;if(typeof i=="number"&&(i=String(i)),typeof i!="string")return null;e=e||{};let t=null;if(!e.rtl)t=i.match(tt[nt.COERCE]);else{let n;for(;(n=tt[nt.COERCERTL].exec(i))&&(!t||t.index+t[0].length!==i.length);)(!t||n.index+n[0].length!==t.index+t[0].length)&&(t=n),tt[nt.COERCERTL].lastIndex=n.index+n[1].length+n[2].length;tt[nt.COERCERTL].lastIndex=-1}return t===null?null:Ds(`${t[2]}.${t[3]||"0"}.${t[4]||"0"}`,e)};var Ps=ks,_t,Qt;function Bs(){return Qt||(Qt=1,_t=function(i){i.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}),_t}var gt,en;function Us(){if(en)return gt;en=1,gt=i,i.Node=r,i.create=i;function i(s){var a=this;if(a instanceof i||(a=new i),a.tail=null,a.head=null,a.length=0,s&&typeof s.forEach=="function")s.forEach(function(c){a.push(c)});else if(arguments.length>0)for(var l=0,o=arguments.length;l<o;l++)a.push(arguments[l]);return a}i.prototype.removeNode=function(s){if(s.list!==this)throw new Error("removing node which does not belong to this list");var a=s.next,l=s.prev;return a&&(a.prev=l),l&&(l.next=a),s===this.head&&(this.head=a),s===this.tail&&(this.tail=l),s.list.length--,s.next=null,s.prev=null,s.list=null,a},i.prototype.unshiftNode=function(s){if(s!==this.head){s.list&&s.list.removeNode(s);var a=this.head;s.list=this,s.next=a,a&&(a.prev=s),this.head=s,this.tail||(this.tail=s),this.length++}},i.prototype.pushNode=function(s){if(s!==this.tail){s.list&&s.list.removeNode(s);var a=this.tail;s.list=this,s.prev=a,a&&(a.next=s),this.tail=s,this.head||(this.head=s),this.length++}},i.prototype.push=function(){for(var s=0,a=arguments.length;s<a;s++)t(this,arguments[s]);return this.length},i.prototype.unshift=function(){for(var s=0,a=arguments.length;s<a;s++)n(this,arguments[s]);return this.length},i.prototype.pop=function(){if(this.tail){var s=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,s}},i.prototype.shift=function(){if(this.head){var s=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,s}},i.prototype.forEach=function(s,a){a=a||this;for(var l=this.head,o=0;l!==null;o++)s.call(a,l.value,o,this),l=l.next},i.prototype.forEachReverse=function(s,a){a=a||this;for(var l=this.tail,o=this.length-1;l!==null;o--)s.call(a,l.value,o,this),l=l.prev},i.prototype.get=function(s){for(var a=0,l=this.head;l!==null&&a<s;a++)l=l.next;if(a===s&&l!==null)return l.value},i.prototype.getReverse=function(s){for(var a=0,l=this.tail;l!==null&&a<s;a++)l=l.prev;if(a===s&&l!==null)return l.value},i.prototype.map=function(s,a){a=a||this;for(var l=new i,o=this.head;o!==null;)l.push(s.call(a,o.value,this)),o=o.next;return l},i.prototype.mapReverse=function(s,a){a=a||this;for(var l=new i,o=this.tail;o!==null;)l.push(s.call(a,o.value,this)),o=o.prev;return l},i.prototype.reduce=function(s,a){var l,o=this.head;if(arguments.length>1)l=a;else if(this.head)o=this.head.next,l=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var c=0;o!==null;c++)l=s(l,o.value,c),o=o.next;return l},i.prototype.reduceReverse=function(s,a){var l,o=this.tail;if(arguments.length>1)l=a;else if(this.tail)o=this.tail.prev,l=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var c=this.length-1;o!==null;c--)l=s(l,o.value,c),o=o.prev;return l},i.prototype.toArray=function(){for(var s=new Array(this.length),a=0,l=this.head;l!==null;a++)s[a]=l.value,l=l.next;return s},i.prototype.toArrayReverse=function(){for(var s=new Array(this.length),a=0,l=this.tail;l!==null;a++)s[a]=l.value,l=l.prev;return s},i.prototype.slice=function(s,a){a=a||this.length,a<0&&(a+=this.length),s=s||0,s<0&&(s+=this.length);var l=new i;if(a<s||a<0)return l;s<0&&(s=0),a>this.length&&(a=this.length);for(var o=0,c=this.head;c!==null&&o<s;o++)c=c.next;for(;c!==null&&o<a;o++,c=c.next)l.push(c.value);return l},i.prototype.sliceReverse=function(s,a){a=a||this.length,a<0&&(a+=this.length),s=s||0,s<0&&(s+=this.length);var l=new i;if(a<s||a<0)return l;s<0&&(s=0),a>this.length&&(a=this.length);for(var o=this.length,c=this.tail;c!==null&&o>a;o--)c=c.prev;for(;c!==null&&o>s;o--,c=c.prev)l.push(c.value);return l},i.prototype.splice=function(s,a,...l){s>this.length&&(s=this.length-1),s<0&&(s=this.length+s);for(var o=0,c=this.head;c!==null&&o<s;o++)c=c.next;for(var u=[],o=0;c&&o<a;o++)u.push(c.value),c=this.removeNode(c);c===null&&(c=this.tail),c!==this.head&&c!==this.tail&&(c=c.prev);for(var o=0;o<l.length;o++)c=e(this,c,l[o]);return u},i.prototype.reverse=function(){for(var s=this.head,a=this.tail,l=s;l!==null;l=l.prev){var o=l.prev;l.prev=l.next,l.next=o}return this.head=a,this.tail=s,this};function e(s,a,l){var o=a===s.head?new r(l,null,a,s):new r(l,a,a.next,s);return o.next===null&&(s.tail=o),o.prev===null&&(s.head=o),s.length++,o}function t(s,a){s.tail=new r(a,s.tail,null,s),s.head||(s.head=s.tail),s.length++}function n(s,a){s.head=new r(a,null,s.head,s),s.tail||(s.tail=s.head),s.length++}function r(s,a,l,o){if(!(this instanceof r))return new r(s,a,l,o);this.list=o,this.value=s,a?(a.next=this,this.prev=a):this.prev=null,l?(l.prev=this,this.next=l):this.next=null}try{Bs()(i)}catch{}return gt}var bt,tn;function Gs(){if(tn)return bt;tn=1;const i=Us(),e=Symbol("max"),t=Symbol("length"),n=Symbol("lengthCalculator"),r=Symbol("allowStale"),s=Symbol("maxAge"),a=Symbol("dispose"),l=Symbol("noDisposeOnSet"),o=Symbol("lruList"),c=Symbol("cache"),u=Symbol("updateAgeOnGet"),f=()=>1;class d{constructor(m){if(typeof m=="number"&&(m={max:m}),m||(m={}),m.max&&(typeof m.max!="number"||m.max<0))throw new TypeError("max must be a non-negative number");this[e]=m.max||1/0;const T=m.length||f;if(this[n]=typeof T!="function"?f:T,this[r]=m.stale||!1,m.maxAge&&typeof m.maxAge!="number")throw new TypeError("maxAge must be a number");this[s]=m.maxAge||0,this[a]=m.dispose,this[l]=m.noDisposeOnSet||!1,this[u]=m.updateAgeOnGet||!1,this.reset()}set max(m){if(typeof m!="number"||m<0)throw new TypeError("max must be a non-negative number");this[e]=m||1/0,B(this)}get max(){return this[e]}set allowStale(m){this[r]=!!m}get allowStale(){return this[r]}set maxAge(m){if(typeof m!="number")throw new TypeError("maxAge must be a non-negative number");this[s]=m,B(this)}get maxAge(){return this[s]}set lengthCalculator(m){typeof m!="function"&&(m=f),m!==this[n]&&(this[n]=m,this[t]=0,this[o].forEach(T=>{T.length=this[n](T.value,T.key),this[t]+=T.length})),B(this)}get lengthCalculator(){return this[n]}get length(){return this[t]}get itemCount(){return this[o].length}rforEach(m,T){T=T||this;for(let P=this[o].tail;P!==null;){const Y=P.prev;b(this,m,P,T),P=Y}}forEach(m,T){T=T||this;for(let P=this[o].head;P!==null;){const Y=P.next;b(this,m,P,T),P=Y}}keys(){return this[o].toArray().map(m=>m.key)}values(){return this[o].toArray().map(m=>m.value)}reset(){this[a]&&this[o]&&this[o].length&&this[o].forEach(m=>this[a](m.key,m.value)),this[c]=new Map,this[o]=new i,this[t]=0}dump(){return this[o].map(m=>O(this,m)?!1:{k:m.key,v:m.value,e:m.now+(m.maxAge||0)}).toArray().filter(m=>m)}dumpLru(){return this[o]}set(m,T,P){if(P=P||this[s],P&&typeof P!="number")throw new TypeError("maxAge must be a number");const Y=P?Date.now():0,ee=this[n](T,m);if(this[c].has(m)){if(ee>this[e])return I(this,this[c].get(m)),!1;const pe=this[c].get(m).value;return this[a]&&(this[l]||this[a](m,pe.value)),pe.now=Y,pe.maxAge=P,pe.value=T,this[t]+=ee-pe.length,pe.length=ee,this.get(m),B(this),!0}const te=new S(m,T,ee,Y,P);return te.length>this[e]?(this[a]&&this[a](m,T),!1):(this[t]+=te.length,this[o].unshift(te),this[c].set(m,this[o].head),B(this),!0)}has(m){if(!this[c].has(m))return!1;const T=this[c].get(m).value;return!O(this,T)}get(m){return h(this,m,!0)}peek(m){return h(this,m,!1)}pop(){const m=this[o].tail;return m?(I(this,m),m.value):null}del(m){I(this,this[c].get(m))}load(m){this.reset();const T=Date.now();for(let P=m.length-1;P>=0;P--){const Y=m[P],ee=Y.e||0;if(ee===0)this.set(Y.k,Y.v);else{const te=ee-T;te>0&&this.set(Y.k,Y.v,te)}}}prune(){this[c].forEach((m,T)=>h(this,T,!1))}}const h=(g,m,T)=>{const P=g[c].get(m);if(P){const Y=P.value;if(O(g,Y)){if(I(g,P),!g[r])return}else T&&(g[u]&&(P.value.now=Date.now()),g[o].unshiftNode(P));return Y.value}},O=(g,m)=>{if(!m||!m.maxAge&&!g[s])return!1;const T=Date.now()-m.now;return m.maxAge?T>m.maxAge:g[s]&&T>g[s]},B=g=>{if(g[t]>g[e])for(let m=g[o].tail;g[t]>g[e]&&m!==null;){const T=m.prev;I(g,m),m=T}},I=(g,m)=>{if(m){const T=m.value;g[a]&&g[a](T.key,T.value),g[t]-=T.length,g[c].delete(T.key),g[o].removeNode(m)}};class S{constructor(m,T,P,Y,ee){this.key=m,this.value=T,this.length=P,this.now=Y,this.maxAge=ee||0}}const b=(g,m,T,P)=>{let Y=T.value;O(g,Y)&&(I(g,T),g[r]||(Y=void 0)),Y&&m.call(P,Y.value,Y.key,g)};return bt=d,bt}var vt,nn;function we(){if(nn)return vt;nn=1;class i{constructor(v,H){if(H=n(H),v instanceof i)return v.loose===!!H.loose&&v.includePrerelease===!!H.includePrerelease?v:new i(v.raw,H);if(v instanceof r)return this.raw=v.value,this.set=[[v]],this.format(),this;if(this.options=H,this.loose=!!H.loose,this.includePrerelease=!!H.includePrerelease,this.raw=v,this.set=v.split("||").map(U=>this.parseRange(U.trim())).filter(U=>U.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${v}`);if(this.set.length>1){const U=this.set[0];if(this.set=this.set.filter(V=>!O(V[0])),this.set.length===0)this.set=[U];else if(this.set.length>1){for(const V of this.set)if(V.length===1&&B(V[0])){this.set=[V];break}}}this.format()}format(){return this.range=this.set.map(v=>v.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(v){v=v.trim();const U=((this.options.includePrerelease&&d)|(this.options.loose&&h))+":"+v,V=t.get(U);if(V)return V;const k=this.options.loose,q=k?l[o.HYPHENRANGELOOSE]:l[o.HYPHENRANGE];v=v.replace(q,pe(this.options.includePrerelease)),s("hyphen replace",v),v=v.replace(l[o.COMPARATORTRIM],c),s("comparator trim",v),v=v.replace(l[o.TILDETRIM],u),v=v.replace(l[o.CARETTRIM],f),v=v.split(/\s+/).join(" ");let Q=v.split(" ").map(ie=>S(ie,this.options)).join(" ").split(/\s+/).map(ie=>ae(ie,this.options));k&&(Q=Q.filter(ie=>(s("loose invalid filter",ie,this.options),!!ie.match(l[o.COMPARATORLOOSE])))),s("range list",Q);const X=new Map,ne=Q.map(ie=>new r(ie,this.options));for(const ie of ne){if(O(ie))return[ie];X.set(ie.value,ie)}X.size>1&&X.has("")&&X.delete("");const ue=[...X.values()];return t.set(U,ue),ue}intersects(v,H){if(!(v instanceof i))throw new TypeError("a Range is required");return this.set.some(U=>I(U,H)&&v.set.some(V=>I(V,H)&&U.every(k=>V.every(q=>k.intersects(q,H)))))}test(v){if(!v)return!1;if(typeof v=="string")try{v=new a(v,this.options)}catch{return!1}for(let H=0;H<this.set.length;H++)if(z(this.set[H],v,this.options))return!0;return!1}}vt=i;const e=Gs(),t=new e({max:1e3}),n=Mt,r=pt(),s=dt,a=ge,{re:l,t:o,comparatorTrimReplace:c,tildeTrimReplace:u,caretTrimReplace:f}=Ce,{FLAG_INCLUDE_PRERELEASE:d,FLAG_LOOSE:h}=ht,O=E=>E.value==="<0.0.0-0",B=E=>E.value==="",I=(E,v)=>{let H=!0;const U=E.slice();let V=U.pop();for(;H&&U.length;)H=U.every(k=>V.intersects(k,v)),V=U.pop();return H},S=(E,v)=>(s("comp",E,v),E=T(E,v),s("caret",E),E=g(E,v),s("tildes",E),E=Y(E,v),s("xrange",E),E=te(E,v),s("stars",E),E),b=E=>!E||E.toLowerCase()==="x"||E==="*",g=(E,v)=>E.trim().split(/\s+/).map(H=>m(H,v)).join(" "),m=(E,v)=>{const H=v.loose?l[o.TILDELOOSE]:l[o.TILDE];return E.replace(H,(U,V,k,q,Q)=>{s("tilde",E,U,V,k,q,Q);let X;return b(V)?X="":b(k)?X=`>=${V}.0.0 <${+V+1}.0.0-0`:b(q)?X=`>=${V}.${k}.0 <${V}.${+k+1}.0-0`:Q?(s("replaceTilde pr",Q),X=`>=${V}.${k}.${q}-${Q} <${V}.${+k+1}.0-0`):X=`>=${V}.${k}.${q} <${V}.${+k+1}.0-0`,s("tilde return",X),X})},T=(E,v)=>E.trim().split(/\s+/).map(H=>P(H,v)).join(" "),P=(E,v)=>{s("caret",E,v);const H=v.loose?l[o.CARETLOOSE]:l[o.CARET],U=v.includePrerelease?"-0":"";return E.replace(H,(V,k,q,Q,X)=>{s("caret",E,V,k,q,Q,X);let ne;return b(k)?ne="":b(q)?ne=`>=${k}.0.0${U} <${+k+1}.0.0-0`:b(Q)?k==="0"?ne=`>=${k}.${q}.0${U} <${k}.${+q+1}.0-0`:ne=`>=${k}.${q}.0${U} <${+k+1}.0.0-0`:X?(s("replaceCaret pr",X),k==="0"?q==="0"?ne=`>=${k}.${q}.${Q}-${X} <${k}.${q}.${+Q+1}-0`:ne=`>=${k}.${q}.${Q}-${X} <${k}.${+q+1}.0-0`:ne=`>=${k}.${q}.${Q}-${X} <${+k+1}.0.0-0`):(s("no pr"),k==="0"?q==="0"?ne=`>=${k}.${q}.${Q}${U} <${k}.${q}.${+Q+1}-0`:ne=`>=${k}.${q}.${Q}${U} <${k}.${+q+1}.0-0`:ne=`>=${k}.${q}.${Q} <${+k+1}.0.0-0`),s("caret return",ne),ne})},Y=(E,v)=>(s("replaceXRanges",E,v),E.split(/\s+/).map(H=>ee(H,v)).join(" ")),ee=(E,v)=>{E=E.trim();const H=v.loose?l[o.XRANGELOOSE]:l[o.XRANGE];return E.replace(H,(U,V,k,q,Q,X)=>{s("xRange",E,U,V,k,q,Q,X);const ne=b(k),ue=ne||b(q),ie=ue||b(Q),ze=ie;return V==="="&&ze&&(V=""),X=v.includePrerelease?"-0":"",ne?V===">"||V==="<"?U="<0.0.0-0":U="*":V&&ze?(ue&&(q=0),Q=0,V===">"?(V=">=",ue?(k=+k+1,q=0,Q=0):(q=+q+1,Q=0)):V==="<="&&(V="<",ue?k=+k+1:q=+q+1),V==="<"&&(X="-0"),U=`${V+k}.${q}.${Q}${X}`):ue?U=`>=${k}.0.0${X} <${+k+1}.0.0-0`:ie&&(U=`>=${k}.${q}.0${X} <${k}.${+q+1}.0-0`),s("xRange return",U),U})},te=(E,v)=>(s("replaceStars",E,v),E.trim().replace(l[o.STAR],"")),ae=(E,v)=>(s("replaceGTE0",E,v),E.trim().replace(l[v.includePrerelease?o.GTE0PRE:o.GTE0],"")),pe=E=>(v,H,U,V,k,q,Q,X,ne,ue,ie,ze,Wl)=>(b(U)?H="":b(V)?H=`>=${U}.0.0${E?"-0":""}`:b(k)?H=`>=${U}.${V}.0${E?"-0":""}`:q?H=`>=${H}`:H=`>=${H}${E?"-0":""}`,b(ne)?X="":b(ue)?X=`<${+ne+1}.0.0-0`:b(ie)?X=`<${ne}.${+ue+1}.0-0`:ze?X=`<=${ne}.${ue}.${ie}-${ze}`:E?X=`<${ne}.${ue}.${+ie+1}-0`:X=`<=${X}`,`${H} ${X}`.trim()),z=(E,v,H)=>{for(let U=0;U<E.length;U++)if(!E[U].test(v))return!1;if(v.prerelease.length&&!H.includePrerelease){for(let U=0;U<E.length;U++)if(s(E[U].semver),E[U].semver!==r.ANY&&E[U].semver.prerelease.length>0){const V=E[U].semver;if(V.major===v.major&&V.minor===v.minor&&V.patch===v.patch)return!0}return!1}return!0};return vt}var $t,rn;function pt(){if(rn)return $t;rn=1;const i=Symbol("SemVer ANY");class e{static get ANY(){return i}constructor(u,f){if(f=t(f),u instanceof e){if(u.loose===!!f.loose)return u;u=u.value}a("comparator",u,f),this.options=f,this.loose=!!f.loose,this.parse(u),this.semver===i?this.value="":this.value=this.operator+this.semver.version,a("comp",this)}parse(u){const f=this.options.loose?n[r.COMPARATORLOOSE]:n[r.COMPARATOR],d=u.match(f);if(!d)throw new TypeError(`Invalid comparator: ${u}`);this.operator=d[1]!==void 0?d[1]:"",this.operator==="="&&(this.operator=""),d[2]?this.semver=new l(d[2],this.options.loose):this.semver=i}toString(){return this.value}test(u){if(a("Comparator.test",u,this.options.loose),this.semver===i||u===i)return!0;if(typeof u=="string")try{u=new l(u,this.options)}catch{return!1}return s(u,this.operator,this.semver,this.options)}intersects(u,f){if(!(u instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new o(u.value,f).test(this.value):u.operator===""?u.value===""?!0:new o(this.value,f).test(u.semver):(f=t(f),f.includePrerelease&&(this.value==="<0.0.0-0"||u.value==="<0.0.0-0")||!f.includePrerelease&&(this.value.startsWith("<0.0.0")||u.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&u.operator.startsWith(">")||this.operator.startsWith("<")&&u.operator.startsWith("<")||this.semver.version===u.semver.version&&this.operator.includes("=")&&u.operator.includes("=")||s(this.semver,"<",u.semver,f)&&this.operator.startsWith(">")&&u.operator.startsWith("<")||s(this.semver,">",u.semver,f)&&this.operator.startsWith("<")&&u.operator.startsWith(">")))}}$t=e;const t=Mt,{re:n,t:r}=Ce,s=Kn,a=dt,l=ge,o=we();return $t}const Fs=we(),Vs=(i,e,t)=>{try{e=new Fs(e,t)}catch{return!1}return e.test(i)};var Et=Vs;const Hs=we(),xs=(i,e)=>new Hs(i,e).set.map(t=>t.map(n=>n.value).join(" ").trim().split(" "));var js=xs;const qs=ge,Ys=we(),zs=(i,e,t)=>{let n=null,r=null,s=null;try{s=new Ys(e,t)}catch{return null}return i.forEach(a=>{s.test(a)&&(!n||r.compare(a)===-1)&&(n=a,r=new qs(n,t))}),n};var Xs=zs;const Ws=ge,Js=we(),Ks=(i,e,t)=>{let n=null,r=null,s=null;try{s=new Js(e,t)}catch{return null}return i.forEach(a=>{s.test(a)&&(!n||r.compare(a)===1)&&(n=a,r=new Ws(n,t))}),n};var Zs=Ks;const Nt=ge,Qs=we(),sn=mt,ei=(i,e)=>{i=new Qs(i,e);let t=new Nt("0.0.0");if(i.test(t)||(t=new Nt("0.0.0-0"),i.test(t)))return t;t=null;for(let n=0;n<i.set.length;++n){const r=i.set[n];let s=null;r.forEach(a=>{const l=new Nt(a.semver.version);switch(a.operator){case">":l.prerelease.length===0?l.patch++:l.prerelease.push(0),l.raw=l.format();case"":case">=":(!s||sn(l,s))&&(s=l);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${a.operator}`)}}),s&&(!t||sn(t,s))&&(t=s)}return t&&i.test(t)?t:null};var ti=ei;const ni=we(),ri=(i,e)=>{try{return new ni(i,e).range||"*"}catch{return null}};var si=ri;const ii=ge,Zn=pt(),{ANY:ai}=Zn,li=we(),oi=Et,an=mt,ln=Ot,ci=Dt,fi=Lt,ui=(i,e,t,n)=>{i=new ii(i,n),e=new li(e,n);let r,s,a,l,o;switch(t){case">":r=an,s=ci,a=ln,l=">",o=">=";break;case"<":r=ln,s=fi,a=an,l="<",o="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(oi(i,e,n))return!1;for(let c=0;c<e.set.length;++c){const u=e.set[c];let f=null,d=null;if(u.forEach(h=>{h.semver===ai&&(h=new Zn(">=0.0.0")),f=f||h,d=d||h,r(h.semver,f.semver,n)?f=h:a(h.semver,d.semver,n)&&(d=h)}),f.operator===l||f.operator===o||(!d.operator||d.operator===l)&&s(i,d.semver))return!1;if(d.operator===o&&a(i,d.semver))return!1}return!0};var kt=ui;const hi=kt,di=(i,e,t)=>hi(i,e,">",t);var mi=di;const pi=kt,Ei=(i,e,t)=>pi(i,e,"<",t);var _i=Ei;const on=we(),gi=(i,e,t)=>(i=new on(i,t),e=new on(e,t),i.intersects(e,t));var bi=gi;const vi=Et,$i=Se;var Ni=(i,e,t)=>{const n=[];let r=null,s=null;const a=i.sort((u,f)=>$i(u,f,t));for(const u of a)vi(u,e,t)?(s=u,r||(r=u)):(s&&n.push([r,s]),s=null,r=null);r&&n.push([r,null]);const l=[];for(const[u,f]of n)u===f?l.push(u):!f&&u===a[0]?l.push("*"):f?u===a[0]?l.push(`<=${f}`):l.push(`${u} - ${f}`):l.push(`>=${u}`);const o=l.join(" || "),c=typeof e.raw=="string"?e.raw:String(e);return o.length<c.length?o:e};const cn=we(),Pt=pt(),{ANY:yt}=Pt,Xe=Et,Bt=Se,yi=(i,e,t={})=>{if(i===e)return!0;i=new cn(i,t),e=new cn(e,t);let n=!1;e:for(const r of i.set){for(const s of e.set){const a=wi(r,s,t);if(n=n||a!==null,a)continue e}if(n)return!1}return!0},Si=[new Pt(">=0.0.0-0")],fn=[new Pt(">=0.0.0")],wi=(i,e,t)=>{if(i===e)return!0;if(i.length===1&&i[0].semver===yt){if(e.length===1&&e[0].semver===yt)return!0;t.includePrerelease?i=Si:i=fn}if(e.length===1&&e[0].semver===yt){if(t.includePrerelease)return!0;e=fn}const n=new Set;let r,s;for(const h of i)h.operator===">"||h.operator===">="?r=un(r,h,t):h.operator==="<"||h.operator==="<="?s=hn(s,h,t):n.add(h.semver);if(n.size>1)return null;let a;if(r&&s){if(a=Bt(r.semver,s.semver,t),a>0)return null;if(a===0&&(r.operator!==">="||s.operator!=="<="))return null}for(const h of n){if(r&&!Xe(h,String(r),t)||s&&!Xe(h,String(s),t))return null;for(const O of e)if(!Xe(h,String(O),t))return!1;return!0}let l,o,c,u,f=s&&!t.includePrerelease&&s.semver.prerelease.length?s.semver:!1,d=r&&!t.includePrerelease&&r.semver.prerelease.length?r.semver:!1;f&&f.prerelease.length===1&&s.operator==="<"&&f.prerelease[0]===0&&(f=!1);for(const h of e){if(u=u||h.operator===">"||h.operator===">=",c=c||h.operator==="<"||h.operator==="<=",r){if(d&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===d.major&&h.semver.minor===d.minor&&h.semver.patch===d.patch&&(d=!1),h.operator===">"||h.operator===">="){if(l=un(r,h,t),l===h&&l!==r)return!1}else if(r.operator===">="&&!Xe(r.semver,String(h),t))return!1}if(s){if(f&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===f.major&&h.semver.minor===f.minor&&h.semver.patch===f.patch&&(f=!1),h.operator==="<"||h.operator==="<="){if(o=hn(s,h,t),o===h&&o!==s)return!1}else if(s.operator==="<="&&!Xe(s.semver,String(h),t))return!1}if(!h.operator&&(s||r)&&a!==0)return!1}return!(r&&c&&!s&&a!==0||s&&u&&!r&&a!==0||d||f)},un=(i,e,t)=>{if(!i)return e;const n=Bt(i.semver,e.semver,t);return n>0?i:n<0||e.operator===">"&&i.operator===">="?e:i},hn=(i,e,t)=>{if(!i)return e;const n=Bt(i.semver,e.semver,t);return n<0?i:n>0||e.operator==="<"&&i.operator==="<="?e:i};var Ii=yi;const St=Ce,dn=ht,Ri=ge,mn=Xn,Ai=Ye,Ci=Dr,Mi=Br,Ti=Gr,Oi=Vr,Li=jr,Di=zr,ki=Jr,Pi=Qr,Bi=Se,Ui=rs,Gi=as,Fi=Tt,Vi=fs,Hi=ds,xi=mt,ji=Ot,qi=Wn,Yi=Jn,zi=Lt,Xi=Dt,Wi=Kn,Ji=Ps,Ki=pt(),Zi=we(),Qi=Et,ea=js,ta=Xs,na=Zs,ra=ti,sa=si,ia=kt,aa=mi,la=_i,oa=bi,ca=Ni,fa=Ii;var Me={parse:Ai,valid:Ci,clean:Mi,inc:Ti,diff:Oi,major:Li,minor:Di,patch:ki,prerelease:Pi,compare:Bi,rcompare:Ui,compareLoose:Gi,compareBuild:Fi,sort:Vi,rsort:Hi,gt:xi,lt:ji,eq:qi,neq:Yi,gte:zi,lte:Xi,cmp:Wi,coerce:Ji,Comparator:Ki,Range:Zi,satisfies:Qi,toComparators:ea,maxSatisfying:ta,minSatisfying:na,minVersion:ra,validRange:sa,outside:ia,gtr:aa,ltr:la,intersects:oa,simplifyRange:ca,subset:fa,SemVer:Ri,re:St.re,src:St.src,tokens:St.t,SEMVER_SPEC_VERSION:dn.SEMVER_SPEC_VERSION,RELEASE_TYPES:dn.RELEASE_TYPES,compareIdentifiers:mn.compareIdentifiers,rcompareIdentifiers:mn.rcompareIdentifiers};class $e{constructor(e=!1){this.eventMap={},this.eventsSuspended=e==!0}addListener(e,t,n={}){if(typeof e=="string"&&e.length<1||e instanceof String&&e.length<1||typeof e!="string"&&!(e instanceof String)&&e!==$e.ANY_EVENT)throw new TypeError("The 'event' parameter must be a string or EventEmitter.ANY_EVENT.");if(typeof t!="function")throw new TypeError("The callback must be a function.");const r=new pn(e,this,t,n);return this.eventMap[e]||(this.eventMap[e]=[]),n.prepend?this.eventMap[e].unshift(r):this.eventMap[e].push(r),r}addOneTimeListener(e,t,n={}){n.remaining=1,this.addListener(e,t,n)}static get ANY_EVENT(){return Symbol.for("Any event")}hasListener(e,t){return e===void 0?this.eventMap[$e.ANY_EVENT]&&this.eventMap[$e.ANY_EVENT].length>0?!0:Object.entries(this.eventMap).some(([,n])=>n.length>0):this.eventMap[e]&&this.eventMap[e].length>0?t instanceof pn?this.eventMap[e].filter(r=>r===t).length>0:typeof t=="function"?this.eventMap[e].filter(r=>r.callback===t).length>0:t==null:!1}get eventNames(){return Object.keys(this.eventMap)}getListeners(e){return this.eventMap[e]||[]}suspendEvent(e){this.getListeners(e).forEach(t=>{t.suspended=!0})}unsuspendEvent(e){this.getListeners(e).forEach(t=>{t.suspended=!1})}getListenerCount(e){return this.getListeners(e).length}emit(e,...t){if(typeof e!="string"&&!(e instanceof String))throw new TypeError("The 'event' parameter must be a string.");if(this.eventsSuspended)return;let n=[],r=this.eventMap[$e.ANY_EVENT]||[];return this.eventMap[e]&&(r=r.concat(this.eventMap[e])),r.forEach(s=>{if(s.suspended)return;let a=[...t];Array.isArray(s.arguments)&&(a=a.concat(s.arguments)),s.remaining>0&&(n.push(s.callback.apply(s.context,a)),s.count++),--s.remaining<1&&s.remove()}),n}removeListener(e,t,n={}){if(e===void 0){this.eventMap={};return}else if(!this.eventMap[e])return;let r=this.eventMap[e].filter(s=>t&&s.callback!==t||n.remaining&&n.remaining!==s.remaining||n.context&&n.context!==s.context);r.length?this.eventMap[e]=r:delete this.eventMap[e]}async waitFor(e,t={}){return t.duration=parseInt(t.duration),(isNaN(t.duration)||t.duration<=0)&&(t.duration=1/0),new Promise((n,r)=>{let s,a=this.addListener(e,()=>{clearTimeout(s),n()},{remaining:1});t.duration!==1/0&&(s=setTimeout(()=>{a.remove(),r("The duration expired before the event was emitted.")},t.duration))})}get eventCount(){return Object.keys(this.eventMap).length}}class pn{constructor(e,t,n,r={}){if(typeof e!="string"&&!(e instanceof String)&&e!==$e.ANY_EVENT)throw new TypeError("The 'event' parameter must be a string or EventEmitter.ANY_EVENT.");if(!t)throw new ReferenceError("The 'target' parameter is mandatory.");if(typeof n!="function")throw new TypeError("The 'callback' must be a function.");r.arguments!==void 0&&!Array.isArray(r.arguments)&&(r.arguments=[r.arguments]),r=Object.assign({context:t,remaining:1/0,arguments:void 0,duration:1/0},r),r.duration!==1/0&&setTimeout(()=>this.remove(),r.duration),this.arguments=r.arguments,this.callback=n,this.context=r.context,this.count=0,this.event=e,this.remaining=parseInt(r.remaining)>=1?parseInt(r.remaining):1/0,this.suspended=!1,this.target=t}remove(){this.target.removeListener(this.event,this.callback,{context:this.context,remaining:this.remaining})}}/**
 * The `Enumerations` class contains enumerations and arrays of elements used throughout the
 * library. All its properties are static and should be referenced using the class name. For
 * example: `Enumerations.CHANNEL_MESSAGES`.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class _{static get MIDI_CHANNEL_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MESSAGES enum has been deprecated. Use the Enumerations.CHANNEL_MESSAGES enum instead."),_.CHANNEL_MESSAGES}static get CHANNEL_MESSAGES(){return{noteoff:8,noteon:9,keyaftertouch:10,controlchange:11,programchange:12,channelaftertouch:13,pitchbend:14}}static get CHANNEL_NUMBERS(){return[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]}static get MIDI_CHANNEL_NUMBERS(){return this.validation&&console.warn("The MIDI_CHANNEL_NUMBERS array has been deprecated. Use the Enumerations.CHANNEL_NUMBERS array instead."),[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]}static get CHANNEL_MODE_MESSAGES(){return{allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127}}static get MIDI_CHANNEL_MODE_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MODE_MESSAGES enum has been deprecated. Use the Enumerations.CHANNEL_MODE_MESSAGES enum instead."),_.CHANNEL_MODE_MESSAGES}static get MIDI_CONTROL_CHANGE_MESSAGES(){return this.validation&&console.warn("The MIDI_CONTROL_CHANGE_MESSAGES enum has been deprecated. Use the Enumerations.CONTROL_CHANGE_MESSAGES array instead."),{bankselectcoarse:0,modulationwheelcoarse:1,breathcontrollercoarse:2,controller3:3,footcontrollercoarse:4,portamentotimecoarse:5,dataentrycoarse:6,volumecoarse:7,balancecoarse:8,controller9:9,pancoarse:10,expressioncoarse:11,effectcontrol1coarse:12,effectcontrol2coarse:13,controller14:14,controller15:15,generalpurposeslider1:16,generalpurposeslider2:17,generalpurposeslider3:18,generalpurposeslider4:19,controller20:20,controller21:21,controller22:22,controller23:23,controller24:24,controller25:25,controller26:26,controller27:27,controller28:28,controller29:29,controller30:30,controller31:31,bankselectfine:32,modulationwheelfine:33,breathcontrollerfine:34,controller35:35,footcontrollerfine:36,portamentotimefine:37,dataentryfine:38,volumefine:39,balancefine:40,controller41:41,panfine:42,expressionfine:43,effectcontrol1fine:44,effectcontrol2fine:45,controller46:46,controller47:47,controller48:48,controller49:49,controller50:50,controller51:51,controller52:52,controller53:53,controller54:54,controller55:55,controller56:56,controller57:57,controller58:58,controller59:59,controller60:60,controller61:61,controller62:62,controller63:63,holdpedal:64,portamento:65,sustenutopedal:66,softpedal:67,legatopedal:68,hold2pedal:69,soundvariation:70,resonance:71,soundreleasetime:72,soundattacktime:73,brightness:74,soundcontrol6:75,soundcontrol7:76,soundcontrol8:77,soundcontrol9:78,soundcontrol10:79,generalpurposebutton1:80,generalpurposebutton2:81,generalpurposebutton3:82,generalpurposebutton4:83,controller84:84,controller85:85,controller86:86,controller87:87,controller88:88,controller89:89,controller90:90,reverblevel:91,tremololevel:92,choruslevel:93,celestelevel:94,phaserlevel:95,databuttonincrement:96,databuttondecrement:97,nonregisteredparametercoarse:98,nonregisteredparameterfine:99,registeredparametercoarse:100,registeredparameterfine:101,controller102:102,controller103:103,controller104:104,controller105:105,controller106:106,controller107:107,controller108:108,controller109:109,controller110:110,controller111:111,controller112:112,controller113:113,controller114:114,controller115:115,controller116:116,controller117:117,controller118:118,controller119:119,allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127}}static get CONTROL_CHANGE_MESSAGES(){return[{number:0,name:"bankselectcoarse",description:"Bank Select (Coarse)",position:"msb"},{number:1,name:"modulationwheelcoarse",description:"Modulation Wheel (Coarse)",position:"msb"},{number:2,name:"breathcontrollercoarse",description:"Breath Controller (Coarse)",position:"msb"},{number:3,name:"controller3",description:"Undefined",position:"msb"},{number:4,name:"footcontrollercoarse",description:"Foot Controller (Coarse)",position:"msb"},{number:5,name:"portamentotimecoarse",description:"Portamento Time (Coarse)",position:"msb"},{number:6,name:"dataentrycoarse",description:"Data Entry (Coarse)",position:"msb"},{number:7,name:"volumecoarse",description:"Channel Volume (Coarse)",position:"msb"},{number:8,name:"balancecoarse",description:"Balance (Coarse)",position:"msb"},{number:9,name:"controller9",description:"Controller 9 (Coarse)",position:"msb"},{number:10,name:"pancoarse",description:"Pan (Coarse)",position:"msb"},{number:11,name:"expressioncoarse",description:"Expression Controller (Coarse)",position:"msb"},{number:12,name:"effectcontrol1coarse",description:"Effect Control 1 (Coarse)",position:"msb"},{number:13,name:"effectcontrol2coarse",description:"Effect Control 2 (Coarse)",position:"msb"},{number:14,name:"controller14",description:"Undefined",position:"msb"},{number:15,name:"controller15",description:"Undefined",position:"msb"},{number:16,name:"generalpurposecontroller1",description:"General Purpose Controller 1 (Coarse)",position:"msb"},{number:17,name:"generalpurposecontroller2",description:"General Purpose Controller 2 (Coarse)",position:"msb"},{number:18,name:"generalpurposecontroller3",description:"General Purpose Controller 3 (Coarse)",position:"msb"},{number:19,name:"generalpurposecontroller4",description:"General Purpose Controller 4 (Coarse)",position:"msb"},{number:20,name:"controller20",description:"Undefined",position:"msb"},{number:21,name:"controller21",description:"Undefined",position:"msb"},{number:22,name:"controller22",description:"Undefined",position:"msb"},{number:23,name:"controller23",description:"Undefined",position:"msb"},{number:24,name:"controller24",description:"Undefined",position:"msb"},{number:25,name:"controller25",description:"Undefined",position:"msb"},{number:26,name:"controller26",description:"Undefined",position:"msb"},{number:27,name:"controller27",description:"Undefined",position:"msb"},{number:28,name:"controller28",description:"Undefined",position:"msb"},{number:29,name:"controller29",description:"Undefined",position:"msb"},{number:30,name:"controller30",description:"Undefined",position:"msb"},{number:31,name:"controller31",description:"Undefined",position:"msb"},{number:32,name:"bankselectfine",description:"Bank Select (Fine)",position:"lsb"},{number:33,name:"modulationwheelfine",description:"Modulation Wheel (Fine)",position:"lsb"},{number:34,name:"breathcontrollerfine",description:"Breath Controller (Fine)",position:"lsb"},{number:35,name:"controller35",description:"Undefined",position:"lsb"},{number:36,name:"footcontrollerfine",description:"Foot Controller (Fine)",position:"lsb"},{number:37,name:"portamentotimefine",description:"Portamento Time (Fine)",position:"lsb"},{number:38,name:"dataentryfine",description:"Data Entry (Fine)",position:"lsb"},{number:39,name:"channelvolumefine",description:"Channel Volume (Fine)",position:"lsb"},{number:40,name:"balancefine",description:"Balance (Fine)",position:"lsb"},{number:41,name:"controller41",description:"Undefined",position:"lsb"},{number:42,name:"panfine",description:"Pan (Fine)",position:"lsb"},{number:43,name:"expressionfine",description:"Expression Controller (Fine)",position:"lsb"},{number:44,name:"effectcontrol1fine",description:"Effect control 1 (Fine)",position:"lsb"},{number:45,name:"effectcontrol2fine",description:"Effect control 2 (Fine)",position:"lsb"},{number:46,name:"controller46",description:"Undefined",position:"lsb"},{number:47,name:"controller47",description:"Undefined",position:"lsb"},{number:48,name:"controller48",description:"General Purpose Controller 1 (Fine)",position:"lsb"},{number:49,name:"controller49",description:"General Purpose Controller 2 (Fine)",position:"lsb"},{number:50,name:"controller50",description:"General Purpose Controller 3 (Fine)",position:"lsb"},{number:51,name:"controller51",description:"General Purpose Controller 4 (Fine)",position:"lsb"},{number:52,name:"controller52",description:"Undefined",position:"lsb"},{number:53,name:"controller53",description:"Undefined",position:"lsb"},{number:54,name:"controller54",description:"Undefined",position:"lsb"},{number:55,name:"controller55",description:"Undefined",position:"lsb"},{number:56,name:"controller56",description:"Undefined",position:"lsb"},{number:57,name:"controller57",description:"Undefined",position:"lsb"},{number:58,name:"controller58",description:"Undefined",position:"lsb"},{number:59,name:"controller59",description:"Undefined",position:"lsb"},{number:60,name:"controller60",description:"Undefined",position:"lsb"},{number:61,name:"controller61",description:"Undefined",position:"lsb"},{number:62,name:"controller62",description:"Undefined",position:"lsb"},{number:63,name:"controller63",description:"Undefined",position:"lsb"},{number:64,name:"damperpedal",description:"Damper Pedal On/Off"},{number:65,name:"portamento",description:"Portamento On/Off"},{number:66,name:"sostenuto",description:"Sostenuto On/Off"},{number:67,name:"softpedal",description:"Soft Pedal On/Off"},{number:68,name:"legatopedal",description:"Legato Pedal On/Off"},{number:69,name:"hold2",description:"Hold 2 On/Off"},{number:70,name:"soundvariation",description:"Sound Variation",position:"lsb"},{number:71,name:"resonance",description:"Resonance",position:"lsb"},{number:72,name:"releasetime",description:"Release Time",position:"lsb"},{number:73,name:"attacktime",description:"Attack Time",position:"lsb"},{number:74,name:"brightness",description:"Brightness",position:"lsb"},{number:75,name:"decaytime",description:"Decay Time",position:"lsb"},{number:76,name:"vibratorate",description:"Vibrato Rate",position:"lsb"},{number:77,name:"vibratodepth",description:"Vibrato Depth",position:"lsb"},{number:78,name:"vibratodelay",description:"Vibrato Delay",position:"lsb"},{number:79,name:"controller79",description:"Undefined",position:"lsb"},{number:80,name:"generalpurposecontroller5",description:"General Purpose Controller 5",position:"lsb"},{number:81,name:"generalpurposecontroller6",description:"General Purpose Controller 6",position:"lsb"},{number:82,name:"generalpurposecontroller7",description:"General Purpose Controller 7",position:"lsb"},{number:83,name:"generalpurposecontroller8",description:"General Purpose Controller 8",position:"lsb"},{number:84,name:"portamentocontrol",description:"Portamento Control",position:"lsb"},{number:85,name:"controller85",description:"Undefined"},{number:86,name:"controller86",description:"Undefined"},{number:87,name:"controller87",description:"Undefined"},{number:88,name:"highresolutionvelocityprefix",description:"High Resolution Velocity Prefix",position:"lsb"},{number:89,name:"controller89",description:"Undefined"},{number:90,name:"controller90",description:"Undefined"},{number:91,name:"effect1depth",description:"Effects 1 Depth (Reverb Send Level)"},{number:92,name:"effect2depth",description:"Effects 2 Depth"},{number:93,name:"effect3depth",description:"Effects 3 Depth (Chorus Send Level)"},{number:94,name:"effect4depth",description:"Effects 4 Depth"},{number:95,name:"effect5depth",description:"Effects 5 Depth"},{number:96,name:"dataincrement",description:"Data Increment"},{number:97,name:"datadecrement",description:"Data Decrement"},{number:98,name:"nonregisteredparameterfine",description:"Non-Registered Parameter Number (Fine)",position:"lsb"},{number:99,name:"nonregisteredparametercoarse",description:"Non-Registered Parameter Number (Coarse)",position:"msb"},{number:100,name:"registeredparameterfine",description:"Registered Parameter Number (Fine)",position:"lsb"},{number:101,name:"registeredparametercoarse",description:"Registered Parameter Number (Coarse)",position:"msb"},{number:102,name:"controller102",description:"Undefined"},{number:103,name:"controller103",description:"Undefined"},{number:104,name:"controller104",description:"Undefined"},{number:105,name:"controller105",description:"Undefined"},{number:106,name:"controller106",description:"Undefined"},{number:107,name:"controller107",description:"Undefined"},{number:108,name:"controller108",description:"Undefined"},{number:109,name:"controller109",description:"Undefined"},{number:110,name:"controller110",description:"Undefined"},{number:111,name:"controller111",description:"Undefined"},{number:112,name:"controller112",description:"Undefined"},{number:113,name:"controller113",description:"Undefined"},{number:114,name:"controller114",description:"Undefined"},{number:115,name:"controller115",description:"Undefined"},{number:116,name:"controller116",description:"Undefined"},{number:117,name:"controller117",description:"Undefined"},{number:118,name:"controller118",description:"Undefined"},{number:119,name:"controller119",description:"Undefined"},{number:120,name:"allsoundoff",description:"All Sound Off"},{number:121,name:"resetallcontrollers",description:"Reset All Controllers"},{number:122,name:"localcontrol",description:"Local Control On/Off"},{number:123,name:"allnotesoff",description:"All Notes Off"},{number:124,name:"omnimodeoff",description:"Omni Mode Off"},{number:125,name:"omnimodeon",description:"Omni Mode On"},{number:126,name:"monomodeon",description:"Mono Mode On"},{number:127,name:"polymodeon",description:"Poly Mode On"}]}static get REGISTERED_PARAMETERS(){return{pitchbendrange:[0,0],channelfinetuning:[0,1],channelcoarsetuning:[0,2],tuningprogram:[0,3],tuningbank:[0,4],modulationrange:[0,5],azimuthangle:[61,0],elevationangle:[61,1],gain:[61,2],distanceratio:[61,3],maximumdistance:[61,4],maximumdistancegain:[61,5],referencedistanceratio:[61,6],panspreadangle:[61,7],rollangle:[61,8]}}static get MIDI_REGISTERED_PARAMETERS(){return this.validation&&console.warn("The MIDI_REGISTERED_PARAMETERS enum has been deprecated. Use the Enumerations.REGISTERED_PARAMETERS enum instead."),_.MIDI_REGISTERED_PARAMETERS}static get SYSTEM_MESSAGES(){return{sysex:240,timecode:241,songposition:242,songselect:243,tunerequest:246,tuningrequest:246,sysexend:247,clock:248,start:250,continue:251,stop:252,activesensing:254,reset:255,midimessage:0,unknownsystemmessage:-1}}static get MIDI_SYSTEM_MESSAGES(){return this.validation&&console.warn("The MIDI_SYSTEM_MESSAGES enum has been deprecated. Use the Enumerations.SYSTEM_MESSAGES enum instead."),_.SYSTEM_MESSAGES}static get CHANNEL_EVENTS(){return["noteoff","controlchange","noteon","keyaftertouch","programchange","channelaftertouch","pitchbend","allnotesoff","allsoundoff","localcontrol","monomode","omnimode","resetallcontrollers","nrpn","nrpn-dataentrycoarse","nrpn-dataentryfine","nrpn-dataincrement","nrpn-datadecrement","rpn","rpn-dataentrycoarse","rpn-dataentryfine","rpn-dataincrement","rpn-datadecrement","nrpn-databuttonincrement","nrpn-databuttondecrement","rpn-databuttonincrement","rpn-databuttondecrement"]}}/**
 * The `Note` class represents a single musical note such as `"D3"`, `"G#4"`, `"F-1"`, `"Gb7"`, etc.
 *
 * `Note` objects can be played back on a single channel by calling
 * [`OutputChannel.playNote()`]{@link OutputChannel#playNote} or, on multiple channels of the same
 * output, by calling [`Output.playNote()`]{@link Output#playNote}.
 *
 * The note has [`attack`](#attack) and [`release`](#release) velocities set at `0.5` by default.
 * These can be changed by passing in the appropriate option. It is also possible to set a
 * system-wide default for attack and release velocities by using the
 * [`WebMidi.defaults`](WebMidi#defaults) property.
 *
 * If you prefer to work with raw MIDI values (`0` to `127`), you can use [`rawAttack`](#rawAttack) and
 * [`rawRelease`](#rawRelease) to both get and set the values.
 *
 * The note may have a [`duration`](#duration). If it does, playback will be automatically stopped
 * when the duration has elapsed by sending a `"noteoff"` event. By default, the duration is set to
 * `Infinity`. In this case, it will never stop playing unless explicitly stopped by calling a
 * method such as [`OutputChannel.stopNote()`]{@link OutputChannel#stopNote},
 * [`Output.stopNote()`]{@link Output#stopNote} or similar.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class Pe{constructor(e,t={}){this.duration=w.defaults.note.duration,this.attack=w.defaults.note.attack,this.release=w.defaults.note.release,t.duration!=null&&(this.duration=t.duration),t.attack!=null&&(this.attack=t.attack),t.rawAttack!=null&&(this.attack=R.from7bitToFloat(t.rawAttack)),t.release!=null&&(this.release=t.release),t.rawRelease!=null&&(this.release=R.from7bitToFloat(t.rawRelease)),Number.isInteger(e)?this.identifier=R.toNoteIdentifier(e):this.identifier=e}get identifier(){return this._name+(this._accidental||"")+this._octave}set identifier(e){const t=R.getNoteDetails(e);if(w.validation&&!e)throw new Error("Invalid note identifier");this._name=t.name,this._accidental=t.accidental,this._octave=t.octave}get name(){return this._name}set name(e){if(w.validation&&(e=e.toUpperCase(),!["C","D","E","F","G","A","B"].includes(e)))throw new Error("Invalid name value");this._name=e}get accidental(){return this._accidental}set accidental(e){if(w.validation&&(e=e.toLowerCase(),!["#","##","b","bb"].includes(e)))throw new Error("Invalid accidental value");this._accidental=e}get octave(){return this._octave}set octave(e){if(w.validation&&(e=parseInt(e),isNaN(e)))throw new Error("Invalid octave value");this._octave=e}get duration(){return this._duration}set duration(e){if(w.validation&&(e=parseFloat(e),isNaN(e)||e===null||e<0))throw new RangeError("Invalid duration value.");this._duration=e}get attack(){return this._attack}set attack(e){if(w.validation&&(e=parseFloat(e),isNaN(e)||!(e>=0&&e<=1)))throw new RangeError("Invalid attack value.");this._attack=e}get release(){return this._release}set release(e){if(w.validation&&(e=parseFloat(e),isNaN(e)||!(e>=0&&e<=1)))throw new RangeError("Invalid release value.");this._release=e}get rawAttack(){return R.fromFloatTo7Bit(this._attack)}set rawAttack(e){this._attack=R.from7bitToFloat(e)}get rawRelease(){return R.fromFloatTo7Bit(this._release)}set rawRelease(e){this._release=R.from7bitToFloat(e)}get number(){return R.toNoteNumber(this.identifier)}getOffsetNumber(e=0,t=0){return w.validation&&(e=parseInt(e)||0,t=parseInt(t)||0),Math.min(Math.max(this.number+e*12+t,0),127)}}/**
 * The `Utilities` class contains general-purpose utility methods. All methods are static and
 * should be called using the class name. For example: `Utilities.getNoteDetails("C4")`.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class R{static toNoteNumber(e,t=0){if(t=t==null?0:parseInt(t),isNaN(t))throw new RangeError("Invalid 'octaveOffset' value");typeof e!="string"&&(e="");const n=this.getNoteDetails(e);if(!n)throw new TypeError("Invalid note identifier");const r={C:0,D:2,E:4,F:5,G:7,A:9,B:11};let s=(n.octave+1+t)*12;if(s+=r[n.name],n.accidental&&(n.accidental.startsWith("b")?s-=n.accidental.length:s+=n.accidental.length),s<0||s>127)throw new RangeError("Invalid octaveOffset value");return s}static getNoteDetails(e){Number.isInteger(e)&&(e=this.toNoteIdentifier(e));const t=e.match(/^([CDEFGAB])(#{0,2}|b{0,2})(-?\d+)$/i);if(!t)throw new TypeError("Invalid note identifier");const n=t[1].toUpperCase(),r=parseInt(t[3]);let s=t[2].toLowerCase();return s=s===""?void 0:s,{accidental:s,identifier:n+(s||"")+r,name:n,octave:r}}static sanitizeChannels(e){let t;if(w.validation){if(e==="all")t=["all"];else if(e==="none")return[]}return Array.isArray(e)?t=e:t=[e],t.indexOf("all")>-1&&(t=_.MIDI_CHANNEL_NUMBERS),t.map(function(n){return parseInt(n)}).filter(function(n){return n>=1&&n<=16})}static toTimestamp(e){let t=!1;const n=parseFloat(e);return isNaN(n)?!1:(typeof e=="string"&&e.substring(0,1)==="+"?n>=0&&(t=w.time+n):n>=0&&(t=n),t)}static guessNoteNumber(e,t){t=parseInt(t)||0;let n=!1;if(Number.isInteger(e)&&e>=0&&e<=127)n=parseInt(e);else if(parseInt(e)>=0&&parseInt(e)<=127)n=parseInt(e);else if(typeof e=="string"||e instanceof String)try{n=this.toNoteNumber(e.trim(),t)}catch{return!1}return n}static toNoteIdentifier(e,t){if(e=parseInt(e),isNaN(e)||e<0||e>127)throw new RangeError("Invalid note number");if(t=t==null?0:parseInt(t),isNaN(t))throw new RangeError("Invalid octaveOffset value");const n=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],r=Math.floor(e/12-1)+t;return n[e%12]+r.toString()}static buildNote(e,t={}){if(t.octaveOffset=parseInt(t.octaveOffset)||0,e instanceof Pe)return e;let n=this.guessNoteNumber(e,t.octaveOffset);if(n===!1)throw new TypeError(`The input could not be parsed as a note (${e})`);return t.octaveOffset=void 0,new Pe(n,t)}static buildNoteArray(e,t={}){let n=[];return Array.isArray(e)||(e=[e]),e.forEach(r=>{n.push(this.buildNote(r,t))}),n}static from7bitToFloat(e){return e===1/0&&(e=127),e=parseInt(e)||0,Math.min(Math.max(e/127,0),1)}static fromFloatTo7Bit(e){return e===1/0&&(e=1),e=parseFloat(e)||0,Math.min(Math.max(Math.round(e*127),0),127)}static fromMsbLsbToFloat(e,t=0){w.validation&&(e=Math.min(Math.max(parseInt(e)||0,0),127),t=Math.min(Math.max(parseInt(t)||0,0),127));const n=((e<<7)+t)/16383;return Math.min(Math.max(n,0),1)}static fromFloatToMsbLsb(e){w.validation&&(e=Math.min(Math.max(parseFloat(e)||0,0),1));const t=Math.round(e*16383);return{msb:t>>7,lsb:t&127}}static offsetNumber(e,t=0,n=0){if(w.validation){if(e=parseInt(e),isNaN(e))throw new Error("Invalid note number");t=parseInt(t)||0,n=parseInt(n)||0}return Math.min(Math.max(e+t*12+n,0),127)}static getPropertyByValue(e,t){return Object.keys(e).find(n=>e[n]===t)}static getCcNameByNumber(e){if(!(w.validation&&(e=parseInt(e),!(e>=0&&e<=127))))return _.CONTROL_CHANGE_MESSAGES[e].name}static getCcNumberByName(e){let t=_.CONTROL_CHANGE_MESSAGES.find(n=>n.name===e);return t?t.number:_.MIDI_CONTROL_CHANGE_MESSAGES[e]}static getChannelModeByNumber(e){if(!(e>=120&&e<=127))return!1;for(let t in _.CHANNEL_MODE_MESSAGES)if(_.CHANNEL_MODE_MESSAGES.hasOwnProperty(t)&&e===_.CHANNEL_MODE_MESSAGES[t])return t;return!1}static get isNode(){return typeof process<"u"&&process.versions!=null&&process.versions.node!=null}static get isBrowser(){return typeof window<"u"&&typeof window.document<"u"}}/**
 * The `OutputChannel` class represents a single output MIDI channel. `OutputChannel` objects are
 * provided by an [`Output`](Output) port which, itself, is made available by a device. The
 * `OutputChannel` object is derived from the host's MIDI subsystem and should not be instantiated
 * directly.
 *
 * All 16 `OutputChannel` objects can be found inside the parent output's
 * [`channels`]{@link Output#channels} property.
 *
 * @param {Output} output The [`Output`](Output) this channel belongs to.
 * @param {number} number The MIDI channel number (`1` - `16`).
 *
 * @extends EventEmitter
 * @license Apache-2.0
 * @since 3.0.0
 */class ua extends $e{constructor(e,t){super(),this._output=e,this._number=t,this._octaveOffset=0}destroy(){this._output=null,this._number=null,this._octaveOffset=0,this.removeListener()}send(e,t={time:0}){return this.output.send(e,t),this}sendKeyAftertouch(e,t,n={}){if(w.validation){if(n.useRawValue&&(n.rawValue=n.useRawValue),isNaN(parseFloat(t)))throw new RangeError("Invalid key aftertouch value.");if(n.rawValue){if(!(t>=0&&t<=127&&Number.isInteger(t)))throw new RangeError("Key aftertouch raw value must be an integer between 0 and 127.")}else if(!(t>=0&&t<=1))throw new RangeError("Key aftertouch value must be a float between 0 and 1.")}n.rawValue||(t=R.fromFloatTo7Bit(t));const r=w.octaveOffset+this.output.octaveOffset+this.octaveOffset;return Array.isArray(e)||(e=[e]),R.buildNoteArray(e).forEach(s=>{this.send([(_.CHANNEL_MESSAGES.keyaftertouch<<4)+(this.number-1),s.getOffsetNumber(r),t],{time:R.toTimestamp(n.time)})}),this}sendControlChange(e,t,n={}){if(typeof e=="string"&&(e=R.getCcNumberByName(e)),Array.isArray(t)||(t=[t]),w.validation){if(e===void 0)throw new TypeError("Control change must be identified with a valid name or an integer between 0 and 127.");if(!Number.isInteger(e)||!(e>=0&&e<=127))throw new TypeError("Control change number must be an integer between 0 and 127.");if(t=t.map(r=>{const s=Math.min(Math.max(parseInt(r),0),127);if(isNaN(s))throw new TypeError("Values must be integers between 0 and 127");return s}),t.length===2&&e>=32)throw new TypeError("To use a value array, the controller must be between 0 and 31")}return t.forEach((r,s)=>{this.send([(_.CHANNEL_MESSAGES.controlchange<<4)+(this.number-1),e+s*32,t[s]],{time:R.toTimestamp(n.time)})}),this}_selectNonRegisteredParameter(e,t={}){return this.sendControlChange(99,e[0],t),this.sendControlChange(98,e[1],t),this}_deselectRegisteredParameter(e={}){return this.sendControlChange(101,127,e),this.sendControlChange(100,127,e),this}_deselectNonRegisteredParameter(e={}){return this.sendControlChange(101,127,e),this.sendControlChange(100,127,e),this}_selectRegisteredParameter(e,t={}){return this.sendControlChange(101,e[0],t),this.sendControlChange(100,e[1],t),this}_setCurrentParameter(e,t={}){return e=[].concat(e),this.sendControlChange(6,e[0],t),e.length<2?this:(this.sendControlChange(38,e[1],t),this)}sendRpnDecrement(e,t={}){if(Array.isArray(e)||(e=_.REGISTERED_PARAMETERS[e]),w.validation){if(e===void 0)throw new TypeError("The specified registered parameter is invalid.");let n=!1;if(Object.getOwnPropertyNames(_.REGISTERED_PARAMETERS).forEach(r=>{_.REGISTERED_PARAMETERS[r][0]===e[0]&&_.REGISTERED_PARAMETERS[r][1]===e[1]&&(n=!0)}),!n)throw new TypeError("The specified registered parameter is invalid.")}return this._selectRegisteredParameter(e,t),this.sendControlChange(97,0,t),this._deselectRegisteredParameter(t),this}sendRpnIncrement(e,t={}){if(Array.isArray(e)||(e=_.REGISTERED_PARAMETERS[e]),w.validation){if(e===void 0)throw new TypeError("The specified registered parameter is invalid.");let n=!1;if(Object.getOwnPropertyNames(_.REGISTERED_PARAMETERS).forEach(r=>{_.REGISTERED_PARAMETERS[r][0]===e[0]&&_.REGISTERED_PARAMETERS[r][1]===e[1]&&(n=!0)}),!n)throw new TypeError("The specified registered parameter is invalid.")}return this._selectRegisteredParameter(e,t),this.sendControlChange(96,0,t),this._deselectRegisteredParameter(t),this}playNote(e,t={}){this.sendNoteOn(e,t);const n=Array.isArray(e)?e:[e];for(let r of n)if(parseInt(r.duration)>0){const s={time:(R.toTimestamp(t.time)||w.time)+parseInt(r.duration),release:r.release,rawRelease:r.rawRelease};this.sendNoteOff(r,s)}else if(parseInt(t.duration)>0){const s={time:(R.toTimestamp(t.time)||w.time)+parseInt(t.duration),release:t.release,rawRelease:t.rawRelease};this.sendNoteOff(r,s)}return this}sendNoteOff(e,t={}){if(w.validation){if(t.rawRelease!=null&&!(t.rawRelease>=0&&t.rawRelease<=127))throw new RangeError("The 'rawRelease' option must be an integer between 0 and 127");if(t.release!=null&&!(t.release>=0&&t.release<=1))throw new RangeError("The 'release' option must be an number between 0 and 1");t.rawVelocity&&(t.rawRelease=t.velocity,console.warn("The 'rawVelocity' option is deprecated. Use 'rawRelease' instead.")),t.velocity&&(t.release=t.velocity,console.warn("The 'velocity' option is deprecated. Use 'attack' instead."))}let n=64;t.rawRelease!=null?n=t.rawRelease:isNaN(t.release)||(n=Math.round(t.release*127));const r=w.octaveOffset+this.output.octaveOffset+this.octaveOffset;return R.buildNoteArray(e,{rawRelease:parseInt(n)}).forEach(s=>{this.send([(_.CHANNEL_MESSAGES.noteoff<<4)+(this.number-1),s.getOffsetNumber(r),s.rawRelease],{time:R.toTimestamp(t.time)})}),this}stopNote(e,t={}){return this.sendNoteOff(e,t)}sendNoteOn(e,t={}){if(w.validation){if(t.rawAttack!=null&&!(t.rawAttack>=0&&t.rawAttack<=127))throw new RangeError("The 'rawAttack' option must be an integer between 0 and 127");if(t.attack!=null&&!(t.attack>=0&&t.attack<=1))throw new RangeError("The 'attack' option must be an number between 0 and 1");t.rawVelocity&&(t.rawAttack=t.velocity,t.rawRelease=t.release,console.warn("The 'rawVelocity' option is deprecated. Use 'rawAttack' or 'rawRelease'.")),t.velocity&&(t.attack=t.velocity,console.warn("The 'velocity' option is deprecated. Use 'attack' instead."))}let n=64;t.rawAttack!=null?n=t.rawAttack:isNaN(t.attack)||(n=Math.round(t.attack*127));const r=w.octaveOffset+this.output.octaveOffset+this.octaveOffset;return R.buildNoteArray(e,{rawAttack:n}).forEach(s=>{this.send([(_.CHANNEL_MESSAGES.noteon<<4)+(this.number-1),s.getOffsetNumber(r),s.rawAttack],{time:R.toTimestamp(t.time)})}),this}sendChannelMode(e,t=0,n={}){if(typeof e=="string"&&(e=_.CHANNEL_MODE_MESSAGES[e]),w.validation){if(e===void 0)throw new TypeError("Invalid channel mode message name or number.");if(isNaN(e)||!(e>=120&&e<=127))throw new TypeError("Invalid channel mode message number.");if(isNaN(parseInt(t))||t<0||t>127)throw new RangeError("Value must be an integer between 0 and 127.")}return this.send([(_.CHANNEL_MESSAGES.controlchange<<4)+(this.number-1),e,t],{time:R.toTimestamp(n.time)}),this}sendOmniMode(e,t={}){return e===void 0||e?this.sendChannelMode("omnimodeon",0,t):this.sendChannelMode("omnimodeoff",0,t),this}sendChannelAftertouch(e,t={}){if(w.validation){if(isNaN(parseFloat(e)))throw new RangeError("Invalid channel aftertouch value.");if(t.rawValue){if(!(e>=0&&e<=127&&Number.isInteger(e)))throw new RangeError("Channel aftertouch raw value must be an integer between 0 and 127.")}else if(!(e>=0&&e<=1))throw new RangeError("Channel aftertouch value must be a float between 0 and 1.")}return this.send([(_.CHANNEL_MESSAGES.channelaftertouch<<4)+(this.number-1),Math.round(e*127)],{time:R.toTimestamp(t.time)}),this}sendMasterTuning(e,t={}){if(e=parseFloat(e)||0,w.validation&&!(e>-65&&e<64))throw new RangeError("The value must be a decimal number larger than -65 and smaller than 64.");let n=Math.floor(e)+64,r=e-Math.floor(e);r=Math.round((r+1)/2*16383);let s=r>>7&127,a=r&127;return this.sendRpnValue("channelcoarsetuning",n,t),this.sendRpnValue("channelfinetuning",[s,a],t),this}sendModulationRange(e,t,n={}){if(w.validation){if(!Number.isInteger(e)||!(e>=0&&e<=127))throw new RangeError("The semitones value must be an integer between 0 and 127.");if(t!=null&&(!Number.isInteger(t)||!(t>=0&&t<=127)))throw new RangeError("If specified, the cents value must be an integer between 0 and 127.")}return t>=0&&t<=127||(t=0),this.sendRpnValue("modulationrange",[e,t],n),this}sendNrpnValue(e,t,n={}){if(t=[].concat(t),w.validation){if(!Array.isArray(e)||!Number.isInteger(e[0])||!Number.isInteger(e[1]))throw new TypeError("The specified NRPN is invalid.");if(!(e[0]>=0&&e[0]<=127))throw new RangeError("The first byte of the NRPN must be between 0 and 127.");if(!(e[1]>=0&&e[1]<=127))throw new RangeError("The second byte of the NRPN must be between 0 and 127.");t.forEach(r=>{if(!(r>=0&&r<=127))throw new RangeError("The data bytes of the NRPN must be between 0 and 127.")})}return this._selectNonRegisteredParameter(e,n),this._setCurrentParameter(t,n),this._deselectNonRegisteredParameter(n),this}sendPitchBend(e,t={}){if(w.validation)if(t.rawValue&&Array.isArray(e)){if(!(e[0]>=0&&e[0]<=127))throw new RangeError("The pitch bend MSB must be an integer between 0 and 127.");if(!(e[1]>=0&&e[1]<=127))throw new RangeError("The pitch bend LSB must be an integer between 0 and 127.")}else if(t.rawValue&&!Array.isArray(e)){if(!(e>=0&&e<=127))throw new RangeError("The pitch bend MSB must be an integer between 0 and 127.")}else{if(isNaN(e)||e===null)throw new RangeError("Invalid pitch bend value.");if(!(e>=-1&&e<=1))throw new RangeError("The pitch bend value must be a float between -1 and 1.")}let n=0,r=0;if(t.rawValue&&Array.isArray(e))n=e[0],r=e[1];else if(t.rawValue&&!Array.isArray(e))n=e;else{const s=R.fromFloatToMsbLsb((e+1)/2);n=s.msb,r=s.lsb}return this.send([(_.CHANNEL_MESSAGES.pitchbend<<4)+(this.number-1),r,n],{time:R.toTimestamp(t.time)}),this}sendPitchBendRange(e,t,n={}){if(w.validation){if(!Number.isInteger(e)||!(e>=0&&e<=127))throw new RangeError("The semitones value must be an integer between 0 and 127.");if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new RangeError("The cents value must be an integer between 0 and 127.")}return this.sendRpnValue("pitchbendrange",[e,t],n),this}sendProgramChange(e,t={}){if(e=parseInt(e)||0,w.validation&&!(e>=0&&e<=127))throw new RangeError("The program number must be between 0 and 127.");return this.send([(_.CHANNEL_MESSAGES.programchange<<4)+(this.number-1),e],{time:R.toTimestamp(t.time)}),this}sendRpnValue(e,t,n={}){if(Array.isArray(e)||(e=_.REGISTERED_PARAMETERS[e]),w.validation){if(!Number.isInteger(e[0])||!Number.isInteger(e[1]))throw new TypeError("The specified NRPN is invalid.");if(!(e[0]>=0&&e[0]<=127))throw new RangeError("The first byte of the RPN must be between 0 and 127.");if(!(e[1]>=0&&e[1]<=127))throw new RangeError("The second byte of the RPN must be between 0 and 127.");[].concat(t).forEach(r=>{if(!(r>=0&&r<=127))throw new RangeError("The data bytes of the RPN must be between 0 and 127.")})}return this._selectRegisteredParameter(e,n),this._setCurrentParameter(t,n),this._deselectRegisteredParameter(n),this}sendTuningBank(e,t={}){if(w.validation&&(!Number.isInteger(e)||!(e>=0&&e<=127)))throw new RangeError("The tuning bank number must be between 0 and 127.");return this.sendRpnValue("tuningbank",e,t),this}sendTuningProgram(e,t={}){if(w.validation&&(!Number.isInteger(e)||!(e>=0&&e<=127)))throw new RangeError("The tuning program number must be between 0 and 127.");return this.sendRpnValue("tuningprogram",e,t),this}sendLocalControl(e,t={}){return e?this.sendChannelMode("localcontrol",127,t):this.sendChannelMode("localcontrol",0,t)}sendAllNotesOff(e={}){return this.sendChannelMode("allnotesoff",0,e)}sendAllSoundOff(e={}){return this.sendChannelMode("allsoundoff",0,e)}sendResetAllControllers(e={}){return this.sendChannelMode("resetallcontrollers",0,e)}sendPolyphonicMode(e,t={}){return e==="mono"?this.sendChannelMode("monomodeon",0,t):this.sendChannelMode("polymodeon",0,t)}get octaveOffset(){return this._octaveOffset}set octaveOffset(e){if(this.validation&&(e=parseInt(e),isNaN(e)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=e}get output(){return this._output}get number(){return this._number}}/**
 * The `Output` class represents a single MIDI output port (not to be confused with a MIDI channel).
 * A port is made available by a MIDI device. A MIDI device can advertise several input and output
 * ports. Each port has 16 MIDI channels which can be accessed via the [`channels`](#channels)
 * property.
 *
 * The `Output` object is automatically instantiated by the library according to the host's MIDI
 * subsystem and should not be directly instantiated.
 *
 * You can access all available `Output` objects by referring to the
 * [`WebMidi.outputs`](WebMidi#outputs) array or by using methods such as
 * [`WebMidi.getOutputByName()`](WebMidi#getOutputByName) or
 * [`WebMidi.getOutputById()`](WebMidi#getOutputById).
 *
 * @fires Output#opened
 * @fires Output#disconnected
 * @fires Output#closed
 *
 * @extends EventEmitter
 * @license Apache-2.0
 */class At extends $e{constructor(e){super(),this._midiOutput=e,this._octaveOffset=0,this.channels=[];for(let t=1;t<=16;t++)this.channels[t]=new ua(this,t);this._midiOutput.onstatechange=this._onStateChange.bind(this)}async destroy(){this.removeListener(),this.channels.forEach(e=>e.destroy()),this.channels=[],this._midiOutput.onstatechange=null,await this.close(),this._midiOutput=null}_onStateChange(e){let t={timestamp:w.time};e.port.connection==="open"?(t.type="opened",t.target=this,t.port=t.target,this.emit("opened",t)):e.port.connection==="closed"&&e.port.state==="connected"?(t.type="closed",t.target=this,t.port=t.target,this.emit("closed",t)):e.port.connection==="closed"&&e.port.state==="disconnected"?(t.type="disconnected",t.port={connection:e.port.connection,id:e.port.id,manufacturer:e.port.manufacturer,name:e.port.name,state:e.port.state,type:e.port.type},this.emit("disconnected",t)):e.port.connection==="pending"&&e.port.state==="disconnected"||console.warn("This statechange event was not caught:",e.port.connection,e.port.state)}async open(){try{return await this._midiOutput.open(),Promise.resolve(this)}catch(e){return Promise.reject(e)}}async close(){this._midiOutput?await this._midiOutput.close():await Promise.resolve()}send(e,t={time:0},n=0){if(e instanceof Qn&&(e=R.isNode?e.data:e.rawData),e instanceof Uint8Array&&R.isNode&&(e=Array.from(e)),w.validation){if(!Array.isArray(e)&&!(e instanceof Uint8Array)&&(e=[e],Array.isArray(t)&&(e=e.concat(t)),t=isNaN(n)?{time:0}:{time:n}),!(parseInt(e[0])>=128&&parseInt(e[0])<=255))throw new RangeError("The first byte (status) must be an integer between 128 and 255.");e.slice(1).forEach(r=>{if(r=parseInt(r),!(r>=0&&r<=255))throw new RangeError("Data bytes must be integers between 0 and 255.")}),t||(t={time:0})}return this._midiOutput.send(e,R.toTimestamp(t.time)),this}sendSysex(e,t=[],n={}){if(e=[].concat(e),t instanceof Uint8Array){const r=new Uint8Array(1+e.length+t.length+1);r[0]=_.SYSTEM_MESSAGES.sysex,r.set(Uint8Array.from(e),1),r.set(t,1+e.length),r[r.length-1]=_.SYSTEM_MESSAGES.sysexend,this.send(r,{time:n.time})}else{const r=e.concat(t,_.SYSTEM_MESSAGES.sysexend);this.send([_.SYSTEM_MESSAGES.sysex].concat(r),{time:n.time})}return this}clear(){return this._midiOutput.clear?this._midiOutput.clear():w.validation&&console.warn("The 'clear()' method has not yet been implemented in your environment."),this}sendTimecodeQuarterFrame(e,t={}){if(w.validation&&(e=parseInt(e),isNaN(e)||!(e>=0&&e<=127)))throw new RangeError("The value must be an integer between 0 and 127.");return this.send([_.SYSTEM_MESSAGES.timecode,e],{time:t.time}),this}sendSongPosition(e=0,t={}){e=Math.floor(e)||0;var n=e>>7&127,r=e&127;return this.send([_.SYSTEM_MESSAGES.songposition,n,r],{time:t.time}),this}sendSongSelect(e=0,t={}){if(w.validation&&(e=parseInt(e),isNaN(e)||!(e>=0&&e<=127)))throw new RangeError("The program value must be between 0 and 127");return this.send([_.SYSTEM_MESSAGES.songselect,e],{time:t.time}),this}sendTuneRequest(e={}){return this.send([_.SYSTEM_MESSAGES.tunerequest],{time:e.time}),this}sendClock(e={}){return this.send([_.SYSTEM_MESSAGES.clock],{time:e.time}),this}sendStart(e={}){return this.send([_.SYSTEM_MESSAGES.start],{time:e.time}),this}sendContinue(e={}){return this.send([_.SYSTEM_MESSAGES.continue],{time:e.time}),this}sendStop(e={}){return this.send([_.SYSTEM_MESSAGES.stop],{time:e.time}),this}sendActiveSensing(e={}){return this.send([_.SYSTEM_MESSAGES.activesensing],{time:e.time}),this}sendReset(e={}){return this.send([_.SYSTEM_MESSAGES.reset],{time:e.time}),this}sendTuningRequest(e={}){return w.validation&&console.warn("The sendTuningRequest() method has been deprecated. Use sendTuningRequest() instead."),this.sendTuneRequest(e)}sendKeyAftertouch(e,t,n={}){return n.channels==null&&(n.channels=_.MIDI_CHANNEL_NUMBERS),R.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].sendKeyAftertouch(e,t,n)}),this}sendControlChange(e,t,n={},r={}){if(w.validation&&(Array.isArray(n)||Number.isInteger(n)||n==="all")){const s=n;n=r,n.channels=s,n.channels==="all"&&(n.channels=_.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=_.MIDI_CHANNEL_NUMBERS),R.sanitizeChannels(n.channels).forEach(s=>{this.channels[s].sendControlChange(e,t,n)}),this}sendPitchBendRange(e=0,t=0,n={}){return n.channels==null&&(n.channels=_.MIDI_CHANNEL_NUMBERS),R.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].sendPitchBendRange(e,t,n)}),this}setPitchBendRange(e=0,t=0,n="all",r={}){return w.validation&&(console.warn("The setPitchBendRange() method is deprecated. Use sendPitchBendRange() instead."),r.channels=n,r.channels==="all"&&(r.channels=_.MIDI_CHANNEL_NUMBERS)),this.sendPitchBendRange(e,t,r)}sendRpnValue(e,t,n={}){return n.channels==null&&(n.channels=_.MIDI_CHANNEL_NUMBERS),R.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].sendRpnValue(e,t,n)}),this}setRegisteredParameter(e,t=[],n="all",r={}){return w.validation&&(console.warn("The setRegisteredParameter() method is deprecated. Use sendRpnValue() instead."),r.channels=n,r.channels==="all"&&(r.channels=_.MIDI_CHANNEL_NUMBERS)),this.sendRpnValue(e,t,r)}sendChannelAftertouch(e,t={},n={}){if(w.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=n,t.channels=r,t.channels==="all"&&(t.channels=_.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=_.MIDI_CHANNEL_NUMBERS),R.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendChannelAftertouch(e,t)}),this}sendPitchBend(e,t={},n={}){if(w.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=n,t.channels=r,t.channels==="all"&&(t.channels=_.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=_.MIDI_CHANNEL_NUMBERS),R.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendPitchBend(e,t)}),this}sendProgramChange(e=0,t={},n={}){if(w.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=n,t.channels=r,t.channels==="all"&&(t.channels=_.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=_.MIDI_CHANNEL_NUMBERS),R.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendProgramChange(e,t)}),this}sendModulationRange(e,t,n={}){return n.channels==null&&(n.channels=_.MIDI_CHANNEL_NUMBERS),R.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].sendModulationRange(e,t,n)}),this}setModulationRange(e=0,t=0,n="all",r={}){return w.validation&&(console.warn("The setModulationRange() method is deprecated. Use sendModulationRange() instead."),r.channels=n,r.channels==="all"&&(r.channels=_.MIDI_CHANNEL_NUMBERS)),this.sendModulationRange(e,t,r)}sendMasterTuning(e,t={}){return t.channels==null&&(t.channels=_.MIDI_CHANNEL_NUMBERS),R.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].sendMasterTuning(e,t)}),this}setMasterTuning(e,t={},n={}){return w.validation&&(console.warn("The setMasterTuning() method is deprecated. Use sendMasterTuning() instead."),n.channels=t,n.channels==="all"&&(n.channels=_.MIDI_CHANNEL_NUMBERS)),this.sendMasterTuning(e,n)}sendTuningProgram(e,t={}){return t.channels==null&&(t.channels=_.MIDI_CHANNEL_NUMBERS),R.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].sendTuningProgram(e,t)}),this}setTuningProgram(e,t="all",n={}){return w.validation&&(console.warn("The setTuningProgram() method is deprecated. Use sendTuningProgram() instead."),n.channels=t,n.channels==="all"&&(n.channels=_.MIDI_CHANNEL_NUMBERS)),this.sendTuningProgram(e,n)}sendTuningBank(e=0,t={}){return t.channels==null&&(t.channels=_.MIDI_CHANNEL_NUMBERS),R.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].sendTuningBank(e,t)}),this}setTuningBank(e,t="all",n={}){return w.validation&&(console.warn("The setTuningBank() method is deprecated. Use sendTuningBank() instead."),n.channels=t,n.channels==="all"&&(n.channels=_.MIDI_CHANNEL_NUMBERS)),this.sendTuningBank(e,n)}sendChannelMode(e,t=0,n={},r={}){if(w.validation&&(Array.isArray(n)||Number.isInteger(n)||n==="all")){const s=n;n=r,n.channels=s,n.channels==="all"&&(n.channels=_.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=_.MIDI_CHANNEL_NUMBERS),R.sanitizeChannels(n.channels).forEach(s=>{this.channels[s].sendChannelMode(e,t,n)}),this}sendAllSoundOff(e={}){return e.channels==null&&(e.channels=_.MIDI_CHANNEL_NUMBERS),R.sanitizeChannels(e.channels).forEach(t=>{this.channels[t].sendAllSoundOff(e)}),this}sendAllNotesOff(e={}){return e.channels==null&&(e.channels=_.MIDI_CHANNEL_NUMBERS),R.sanitizeChannels(e.channels).forEach(t=>{this.channels[t].sendAllNotesOff(e)}),this}sendResetAllControllers(e={},t={}){if(w.validation&&(Array.isArray(e)||Number.isInteger(e)||e==="all")){const n=e;e=t,e.channels=n,e.channels==="all"&&(e.channels=_.MIDI_CHANNEL_NUMBERS)}return e.channels==null&&(e.channels=_.MIDI_CHANNEL_NUMBERS),R.sanitizeChannels(e.channels).forEach(n=>{this.channels[n].sendResetAllControllers(e)}),this}sendPolyphonicMode(e,t={},n={}){if(w.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=n,t.channels=r,t.channels==="all"&&(t.channels=_.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=_.MIDI_CHANNEL_NUMBERS),R.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendPolyphonicMode(e,t)}),this}sendLocalControl(e,t={},n={}){if(w.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=n,t.channels=r,t.channels==="all"&&(t.channels=_.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=_.MIDI_CHANNEL_NUMBERS),R.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendLocalControl(e,t)}),this}sendOmniMode(e,t={},n={}){if(w.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=n,t.channels=r,t.channels==="all"&&(t.channels=_.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=_.MIDI_CHANNEL_NUMBERS),R.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendOmniMode(e,t)}),this}sendNrpnValue(e,t,n={}){return n.channels==null&&(n.channels=_.MIDI_CHANNEL_NUMBERS),R.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].sendNrpnValue(e,t,n)}),this}setNonRegisteredParameter(e,t=[],n="all",r={}){return w.validation&&(console.warn("The setNonRegisteredParameter() method is deprecated. Use sendNrpnValue() instead."),r.channels=n,r.channels==="all"&&(r.channels=_.MIDI_CHANNEL_NUMBERS)),this.sendNrpnValue(e,t,r)}sendRpnIncrement(e,t={}){return t.channels==null&&(t.channels=_.MIDI_CHANNEL_NUMBERS),R.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].sendRpnIncrement(e,t)}),this}incrementRegisteredParameter(e,t="all",n={}){return w.validation&&(console.warn("The incrementRegisteredParameter() method is deprecated. Use sendRpnIncrement() instead."),n.channels=t,n.channels==="all"&&(n.channels=_.MIDI_CHANNEL_NUMBERS)),this.sendRpnIncrement(e,n)}sendRpnDecrement(e,t={}){return t.channels==null&&(t.channels=_.MIDI_CHANNEL_NUMBERS),R.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].sendRpnDecrement(e,t)}),this}decrementRegisteredParameter(e,t="all",n={}){return w.validation&&(console.warn("The decrementRegisteredParameter() method is deprecated. Use sendRpnDecrement() instead."),n.channels=t,n.channels==="all"&&(n.channels=_.MIDI_CHANNEL_NUMBERS)),this.sendRpnDecrement(e,n)}sendNoteOff(e,t={},n={}){if(w.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=n,t.channels=r,t.channels==="all"&&(t.channels=_.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=_.MIDI_CHANNEL_NUMBERS),R.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendNoteOff(e,t)}),this}stopNote(e,t){return this.sendNoteOff(e,t)}playNote(e,t={},n={}){if(w.validation&&(t.rawVelocity&&console.warn("The 'rawVelocity' option is deprecated. Use 'rawAttack' instead."),t.velocity&&console.warn("The 'velocity' option is deprecated. Use 'velocity' instead."),Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=n,t.channels=r,t.channels==="all"&&(t.channels=_.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=_.MIDI_CHANNEL_NUMBERS),R.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].playNote(e,t)}),this}sendNoteOn(e,t={},n={}){if(w.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=n,t.channels=r,t.channels==="all"&&(t.channels=_.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=_.MIDI_CHANNEL_NUMBERS),R.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendNoteOn(e,t)}),this}get name(){return this._midiOutput.name}get id(){return this._midiOutput.id}get connection(){return this._midiOutput.connection}get manufacturer(){return this._midiOutput.manufacturer}get state(){return this._midiOutput.state}get type(){return this._midiOutput.type}get octaveOffset(){return this._octaveOffset}set octaveOffset(e){if(this.validation&&(e=parseInt(e),isNaN(e)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=e}}/**
 * The `Forwarder` class allows the forwarding of MIDI messages to predetermined outputs. When you
 * call its [`forward()`](#forward) method, it will send the specified [`Message`](Message) object
 * to all the outputs listed in its [`destinations`](#destinations) property.
 *
 * If specific channels or message types have been defined in the [`channels`](#channels) or
 * [`types`](#types) properties, only messages matching the channels/types will be forwarded.
 *
 * While it can be manually instantiated, you are more likely to come across a `Forwarder` object as
 * the return value of the [`Input.addForwarder()`](Input#addForwarder) method.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class En{constructor(e=[],t={}){this.destinations=[],this.types=[...Object.keys(_.SYSTEM_MESSAGES),...Object.keys(_.CHANNEL_MESSAGES)],this.channels=_.MIDI_CHANNEL_NUMBERS,this.suspended=!1,Array.isArray(e)||(e=[e]),t.types&&!Array.isArray(t.types)&&(t.types=[t.types]),t.channels&&!Array.isArray(t.channels)&&(t.channels=[t.channels]),w.validation&&(e.forEach(n=>{if(!(n instanceof At))throw new TypeError("Destinations must be of type 'Output'.")}),t.types!==void 0&&t.types.forEach(n=>{if(!_.SYSTEM_MESSAGES.hasOwnProperty(n)&&!_.CHANNEL_MESSAGES.hasOwnProperty(n))throw new TypeError("Type must be a valid message type.")}),t.channels!==void 0&&t.channels.forEach(n=>{if(!_.MIDI_CHANNEL_NUMBERS.includes(n))throw new TypeError("MIDI channel must be between 1 and 16.")})),this.destinations=e,t.types&&(this.types=t.types),t.channels&&(this.channels=t.channels)}forward(e){this.suspended||this.types.includes(e.type)&&(e.channel&&!this.channels.includes(e.channel)||this.destinations.forEach(t=>{w.validation&&!(t instanceof At)||t.send(e)}))}}/**
 * The `InputChannel` class represents a single MIDI input channel (1-16) from a single input
 * device. This object is derived from the host's MIDI subsystem and should not be instantiated
 * directly.
 *
 * All 16 `InputChannel` objects can be found inside the input's [`channels`](Input#channels)
 * property.
 *
 * @fires InputChannel#midimessage
 * @fires InputChannel#unknownmessage
 *
 * @fires InputChannel#noteoff
 * @fires InputChannel#noteon
 * @fires InputChannel#keyaftertouch
 * @fires InputChannel#programchange
 * @fires InputChannel#channelaftertouch
 * @fires InputChannel#pitchbend
 *
 * @fires InputChannel#allnotesoff
 * @fires InputChannel#allsoundoff
 * @fires InputChannel#localcontrol
 * @fires InputChannel#monomode
 * @fires InputChannel#omnimode
 * @fires InputChannel#resetallcontrollers
 *
 * @fires InputChannel#event:nrpn
 * @fires InputChannel#event:nrpn-dataentrycoarse
 * @fires InputChannel#event:nrpn-dataentryfine
 * @fires InputChannel#event:nrpn-dataincrement
 * @fires InputChannel#event:nrpn-datadecrement
 * @fires InputChannel#event:rpn
 * @fires InputChannel#event:rpn-dataentrycoarse
 * @fires InputChannel#event:rpn-dataentryfine
 * @fires InputChannel#event:rpn-dataincrement
 * @fires InputChannel#event:rpn-datadecrement
 *
 * @fires InputChannel#controlchange
 * @fires InputChannel#event:controlchange-controllerxxx
 * @fires InputChannel#event:controlchange-bankselectcoarse
 * @fires InputChannel#event:controlchange-modulationwheelcoarse
 * @fires InputChannel#event:controlchange-breathcontrollercoarse
 * @fires InputChannel#event:controlchange-footcontrollercoarse
 * @fires InputChannel#event:controlchange-portamentotimecoarse
 * @fires InputChannel#event:controlchange-dataentrycoarse
 * @fires InputChannel#event:controlchange-volumecoarse
 * @fires InputChannel#event:controlchange-balancecoarse
 * @fires InputChannel#event:controlchange-pancoarse
 * @fires InputChannel#event:controlchange-expressioncoarse
 * @fires InputChannel#event:controlchange-effectcontrol1coarse
 * @fires InputChannel#event:controlchange-effectcontrol2coarse
 * @fires InputChannel#event:controlchange-generalpurposecontroller1
 * @fires InputChannel#event:controlchange-generalpurposecontroller2
 * @fires InputChannel#event:controlchange-generalpurposecontroller3
 * @fires InputChannel#event:controlchange-generalpurposecontroller4
 * @fires InputChannel#event:controlchange-bankselectfine
 * @fires InputChannel#event:controlchange-modulationwheelfine
 * @fires InputChannel#event:controlchange-breathcontrollerfine
 * @fires InputChannel#event:controlchange-footcontrollerfine
 * @fires InputChannel#event:controlchange-portamentotimefine
 * @fires InputChannel#event:controlchange-dataentryfine
 * @fires InputChannel#event:controlchange-channelvolumefine
 * @fires InputChannel#event:controlchange-balancefine
 * @fires InputChannel#event:controlchange-panfine
 * @fires InputChannel#event:controlchange-expressionfine
 * @fires InputChannel#event:controlchange-effectcontrol1fine
 * @fires InputChannel#event:controlchange-effectcontrol2fine
 * @fires InputChannel#event:controlchange-damperpedal
 * @fires InputChannel#event:controlchange-portamento
 * @fires InputChannel#event:controlchange-sostenuto
 * @fires InputChannel#event:controlchange-softpedal
 * @fires InputChannel#event:controlchange-legatopedal
 * @fires InputChannel#event:controlchange-hold2
 * @fires InputChannel#event:controlchange-soundvariation
 * @fires InputChannel#event:controlchange-resonance
 * @fires InputChannel#event:controlchange-releasetime
 * @fires InputChannel#event:controlchange-attacktime
 * @fires InputChannel#event:controlchange-brightness
 * @fires InputChannel#event:controlchange-decaytime
 * @fires InputChannel#event:controlchange-vibratorate
 * @fires InputChannel#event:controlchange-vibratodepth
 * @fires InputChannel#event:controlchange-vibratodelay
 * @fires InputChannel#event:controlchange-generalpurposecontroller5
 * @fires InputChannel#event:controlchange-generalpurposecontroller6
 * @fires InputChannel#event:controlchange-generalpurposecontroller7
 * @fires InputChannel#event:controlchange-generalpurposecontroller8
 * @fires InputChannel#event:controlchange-portamentocontrol
 * @fires InputChannel#event:controlchange-highresolutionvelocityprefix
 * @fires InputChannel#event:controlchange-effect1depth
 * @fires InputChannel#event:controlchange-effect2depth
 * @fires InputChannel#event:controlchange-effect3depth
 * @fires InputChannel#event:controlchange-effect4depth
 * @fires InputChannel#event:controlchange-effect5depth
 * @fires InputChannel#event:controlchange-dataincrement
 * @fires InputChannel#event:controlchange-datadecrement
 * @fires InputChannel#event:controlchange-nonregisteredparameterfine
 * @fires InputChannel#event:controlchange-nonregisteredparametercoarse
 * @fires InputChannel#event:controlchange-registeredparameterfine
 * @fires InputChannel#event:controlchange-registeredparametercoarse
 * @fires InputChannel#event:controlchange-allsoundoff
 * @fires InputChannel#event:controlchange-resetallcontrollers
 * @fires InputChannel#event:controlchange-localcontrol
 * @fires InputChannel#event:controlchange-allnotesoff
 * @fires InputChannel#event:controlchange-omnimodeoff
 * @fires InputChannel#event:controlchange-omnimodeon
 * @fires InputChannel#event:controlchange-monomodeon
 * @fires InputChannel#event:controlchange-polymodeon
 * @fires InputChannel#event:
 *
 * @extends EventEmitter
 * @license Apache-2.0
 * @since 3.0.0
 */class ha extends $e{constructor(e,t){super(),this._input=e,this._number=t,this._octaveOffset=0,this._nrpnBuffer=[],this._rpnBuffer=[],this.parameterNumberEventsEnabled=!0,this.notesState=new Array(128).fill(!1)}destroy(){this._input=null,this._number=null,this._octaveOffset=0,this._nrpnBuffer=[],this.notesState=new Array(128).fill(!1),this.parameterNumberEventsEnabled=!1,this.removeListener()}_processMidiMessageEvent(e){const t=Object.assign({},e);t.port=this.input,t.target=this,t.type="midimessage",this.emit(t.type,t),this._parseEventForStandardMessages(t)}_parseEventForStandardMessages(e){const t=Object.assign({},e);t.type=t.message.type||"unknownmessage";const n=e.message.dataBytes[0],r=e.message.dataBytes[1];if(t.type==="noteoff"||t.type==="noteon"&&r===0)this.notesState[n]=!1,t.type="noteoff",t.note=new Pe(R.offsetNumber(n,this.octaveOffset+this.input.octaveOffset+w.octaveOffset),{rawAttack:0,rawRelease:r}),t.value=R.from7bitToFloat(r),t.rawValue=r,t.velocity=t.note.release,t.rawVelocity=t.note.rawRelease;else if(t.type==="noteon")this.notesState[n]=!0,t.note=new Pe(R.offsetNumber(n,this.octaveOffset+this.input.octaveOffset+w.octaveOffset),{rawAttack:r}),t.value=R.from7bitToFloat(r),t.rawValue=r,t.velocity=t.note.attack,t.rawVelocity=t.note.rawAttack;else if(t.type==="keyaftertouch")t.note=new Pe(R.offsetNumber(n,this.octaveOffset+this.input.octaveOffset+w.octaveOffset)),t.value=R.from7bitToFloat(r),t.rawValue=r,t.identifier=t.note.identifier,t.key=t.note.number,t.rawKey=n;else if(t.type==="controlchange"){t.controller={number:n,name:_.CONTROL_CHANGE_MESSAGES[n].name,description:_.CONTROL_CHANGE_MESSAGES[n].description,position:_.CONTROL_CHANGE_MESSAGES[n].position},t.subtype=t.controller.name||"controller"+n,t.value=R.from7bitToFloat(r),t.rawValue=r;const s=Object.assign({},t);s.type=`${t.type}-controller${n}`,delete s.subtype,this.emit(s.type,s);const a=Object.assign({},t);a.type=`${t.type}-`+_.CONTROL_CHANGE_MESSAGES[n].name,delete a.subtype,a.type.indexOf("controller")!==0&&this.emit(a.type,a),t.message.dataBytes[0]>=120&&this._parseChannelModeMessage(t),this.parameterNumberEventsEnabled&&this._isRpnOrNrpnController(t.message.dataBytes[0])&&this._parseEventForParameterNumber(t)}else t.type==="programchange"?(t.value=n,t.rawValue=t.value):t.type==="channelaftertouch"?(t.value=R.from7bitToFloat(n),t.rawValue=n):t.type==="pitchbend"?(t.value=((r<<7)+n-8192)/8192,t.rawValue=(r<<7)+n):t.type="unknownmessage";this.emit(t.type,t)}_parseChannelModeMessage(e){const t=Object.assign({},e);t.type=t.controller.name,t.type==="localcontrol"&&(t.value=t.message.data[2]===127,t.rawValue=t.message.data[2]),t.type==="omnimodeon"?(t.type="omnimode",t.value=!0,t.rawValue=t.message.data[2]):t.type==="omnimodeoff"&&(t.type="omnimode",t.value=!1,t.rawValue=t.message.data[2]),t.type==="monomodeon"?(t.type="monomode",t.value=!0,t.rawValue=t.message.data[2]):t.type==="polymodeon"&&(t.type="monomode",t.value=!1,t.rawValue=t.message.data[2]),this.emit(t.type,t)}_parseEventForParameterNumber(e){const t=e.message.dataBytes[0],n=e.message.dataBytes[1];t===99||t===101?(this._nrpnBuffer=[],this._rpnBuffer=[],t===99?this._nrpnBuffer=[e.message]:n!==127&&(this._rpnBuffer=[e.message])):t===98||t===100?t===98?(this._rpnBuffer=[],this._nrpnBuffer.length===1?this._nrpnBuffer.push(e.message):this._nrpnBuffer=[]):(this._nrpnBuffer=[],this._rpnBuffer.length===1&&n!==127?this._rpnBuffer.push(e.message):this._rpnBuffer=[]):(t===6||t===38||t===96||t===97)&&(this._rpnBuffer.length===2?this._dispatchParameterNumberEvent("rpn",this._rpnBuffer[0].dataBytes[1],this._rpnBuffer[1].dataBytes[1],e):this._nrpnBuffer.length===2?this._dispatchParameterNumberEvent("nrpn",this._nrpnBuffer[0].dataBytes[1],this._nrpnBuffer[1].dataBytes[1],e):(this._nrpnBuffer=[],this._rpnBuffer=[]))}_isRpnOrNrpnController(e){return e===6||e===38||e===96||e===97||e===98||e===99||e===100||e===101}_dispatchParameterNumberEvent(e,t,n,r){e=e==="nrpn"?"nrpn":"rpn";const s={target:r.target,timestamp:r.timestamp,message:r.message,parameterMsb:t,parameterLsb:n,value:R.from7bitToFloat(r.message.dataBytes[1]),rawValue:r.message.dataBytes[1]};e==="rpn"?s.parameter=Object.keys(_.REGISTERED_PARAMETERS).find(o=>_.REGISTERED_PARAMETERS[o][0]===t&&_.REGISTERED_PARAMETERS[o][1]===n):s.parameter=(t<<7)+n;const a=_.CONTROL_CHANGE_MESSAGES[r.message.dataBytes[0]].name;s.type=`${e}-${a}`,this.emit(s.type,s);const l=Object.assign({},s);l.type==="nrpn-dataincrement"?l.type="nrpn-databuttonincrement":l.type==="nrpn-datadecrement"?l.type="nrpn-databuttondecrement":l.type==="rpn-dataincrement"?l.type="rpn-databuttonincrement":l.type==="rpn-datadecrement"&&(l.type="rpn-databuttondecrement"),this.emit(l.type,l),s.type=e,s.subtype=a,this.emit(s.type,s)}getChannelModeByNumber(e){return w.validation&&(console.warn("The 'getChannelModeByNumber()' method has been moved to the 'Utilities' class."),e=Math.floor(e)),R.getChannelModeByNumber(e)}getCcNameByNumber(e){if(w.validation&&(console.warn("The 'getCcNameByNumber()' method has been moved to the 'Utilities' class."),e=parseInt(e),!(e>=0&&e<=127)))throw new RangeError("Invalid control change number.");return R.getCcNameByNumber(e)}getNoteState(e){e instanceof Pe&&(e=e.identifier);const t=R.guessNoteNumber(e,w.octaveOffset+this.input.octaveOffset+this.octaveOffset);return this.notesState[t]}get octaveOffset(){return this._octaveOffset}set octaveOffset(e){if(this.validation&&(e=parseInt(e),isNaN(e)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=e}get input(){return this._input}get number(){return this._number}get nrpnEventsEnabled(){return this.parameterNumberEventsEnabled}set nrpnEventsEnabled(e){this.validation&&(e=!!e),this.parameterNumberEventsEnabled=e}}/**
 * The `Message` class represents a single MIDI message. It has several properties that make it
 * easy to make sense of the binary data it contains.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class Qn{constructor(e){this.rawData=e,this.data=Array.from(this.rawData),this.statusByte=this.rawData[0],this.rawDataBytes=this.rawData.slice(1),this.dataBytes=this.data.slice(1),this.isChannelMessage=!1,this.isSystemMessage=!1,this.command=void 0,this.channel=void 0,this.manufacturerId=void 0,this.type=void 0,this.statusByte<240?(this.isChannelMessage=!0,this.command=this.statusByte>>4,this.channel=(this.statusByte&15)+1):(this.isSystemMessage=!0,this.command=this.statusByte),this.isChannelMessage?this.type=R.getPropertyByValue(_.CHANNEL_MESSAGES,this.command):this.isSystemMessage&&(this.type=R.getPropertyByValue(_.SYSTEM_MESSAGES,this.command)),this.statusByte===_.SYSTEM_MESSAGES.sysex&&(this.dataBytes[0]===0?(this.manufacturerId=this.dataBytes.slice(0,3),this.dataBytes=this.dataBytes.slice(3,this.rawDataBytes.length-1),this.rawDataBytes=this.rawDataBytes.slice(3,this.rawDataBytes.length-1)):(this.manufacturerId=[this.dataBytes[0]],this.dataBytes=this.dataBytes.slice(1,this.dataBytes.length-1),this.rawDataBytes=this.rawDataBytes.slice(1,this.rawDataBytes.length-1)))}}/**
 * The `Input` class represents a single MIDI input port. This object is automatically instantiated
 * by the library according to the host's MIDI subsystem and does not need to be directly
 * instantiated. Instead, you can access all `Input` objects by referring to the
 * [`WebMidi.inputs`](WebMidi#inputs) array. You can also retrieve inputs by using methods such as
 * [`WebMidi.getInputByName()`](WebMidi#getInputByName) and
 * [`WebMidi.getInputById()`](WebMidi#getInputById).
 *
 * Note that a single MIDI device may expose several inputs and/or outputs.
 *
 * **Important**: the `Input` class does not directly fire channel-specific MIDI messages
 * (such as [`noteon`](InputChannel#event:noteon) or
 * [`controlchange`](InputChannel#event:controlchange), etc.). The [`InputChannel`](InputChannel)
 * object does that. However, you can still use the
 * [`Input.addListener()`](#addListener) method to listen to channel-specific events on multiple
 * [`InputChannel`](InputChannel) objects at once.
 *
 * @fires Input#opened
 * @fires Input#disconnected
 * @fires Input#closed
 * @fires Input#midimessage
 *
 * @fires Input#sysex
 * @fires Input#timecode
 * @fires Input#songposition
 * @fires Input#songselect
 * @fires Input#tunerequest
 * @fires Input#clock
 * @fires Input#start
 * @fires Input#continue
 * @fires Input#stop
 * @fires Input#activesensing
 * @fires Input#reset
 *
 * @fires Input#unknownmidimessage
 *
 * @extends EventEmitter
 * @license Apache-2.0
 */class da extends $e{constructor(e){super(),this._midiInput=e,this._octaveOffset=0,this.channels=[];for(let t=1;t<=16;t++)this.channels[t]=new ha(this,t);this._forwarders=[],this._midiInput.onstatechange=this._onStateChange.bind(this),this._midiInput.onmidimessage=this._onMidiMessage.bind(this)}async destroy(){this.removeListener(),this.channels.forEach(e=>e.destroy()),this.channels=[],this._forwarders=[],this._midiInput&&(this._midiInput.onstatechange=null,this._midiInput.onmidimessage=null),await this.close(),this._midiInput=null}_onStateChange(e){let t={timestamp:w.time,target:this,port:this};e.port.connection==="open"?(t.type="opened",this.emit("opened",t)):e.port.connection==="closed"&&e.port.state==="connected"?(t.type="closed",this.emit("closed",t)):e.port.connection==="closed"&&e.port.state==="disconnected"?(t.type="disconnected",t.port={connection:e.port.connection,id:e.port.id,manufacturer:e.port.manufacturer,name:e.port.name,state:e.port.state,type:e.port.type},this.emit("disconnected",t)):e.port.connection==="pending"&&e.port.state==="disconnected"||console.warn("This statechange event was not caught: ",e.port.connection,e.port.state)}_onMidiMessage(e){const t=new Qn(e.data),n={port:this,target:this,message:t,timestamp:e.timeStamp,type:"midimessage",data:t.data,rawData:t.data,statusByte:t.data[0],dataBytes:t.dataBytes};this.emit("midimessage",n),t.isSystemMessage?this._parseEvent(n):t.isChannelMessage&&this.channels[t.channel]._processMidiMessageEvent(n),this._forwarders.forEach(r=>r.forward(t))}_parseEvent(e){const t=Object.assign({},e);t.type=t.message.type||"unknownmidimessage",t.type==="songselect"&&(t.song=e.data[1]+1,t.value=e.data[1],t.rawValue=t.value),this.emit(t.type,t)}async open(){try{await this._midiInput.open()}catch(e){return Promise.reject(e)}return Promise.resolve(this)}async close(){if(!this._midiInput)return Promise.resolve(this);try{await this._midiInput.close()}catch(e){return Promise.reject(e)}return Promise.resolve(this)}getChannelModeByNumber(){w.validation&&console.warn("The 'getChannelModeByNumber()' method has been moved to the 'Utilities' class.")}addListener(e,t,n={}){if(w.validation&&typeof n=="function"){let r=t!=null?[].concat(t):void 0;t=n,n={channels:r}}if(_.CHANNEL_EVENTS.includes(e)){n.channels===void 0&&(n.channels=_.MIDI_CHANNEL_NUMBERS);let r=[];return R.sanitizeChannels(n.channels).forEach(s=>{r.push(this.channels[s].addListener(e,t,n))}),r}else return super.addListener(e,t,n)}addOneTimeListener(e,t,n={}){return n.remaining=1,this.addListener(e,t,n)}on(e,t,n,r){return this.addListener(e,t,n,r)}hasListener(e,t,n={}){if(w.validation&&typeof n=="function"){let r=[].concat(t);t=n,n={channels:r}}return _.CHANNEL_EVENTS.includes(e)?(n.channels===void 0&&(n.channels=_.MIDI_CHANNEL_NUMBERS),R.sanitizeChannels(n.channels).every(r=>this.channels[r].hasListener(e,t))):super.hasListener(e,t)}removeListener(e,t,n={}){if(w.validation&&typeof n=="function"){let r=[].concat(t);t=n,n={channels:r}}if(n.channels===void 0&&(n.channels=_.MIDI_CHANNEL_NUMBERS),e==null)return R.sanitizeChannels(n.channels).forEach(r=>{this.channels[r]&&this.channels[r].removeListener()}),super.removeListener();_.CHANNEL_EVENTS.includes(e)?R.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].removeListener(e,t,n)}):super.removeListener(e,t,n)}addForwarder(e,t={}){let n;return e instanceof En?n=e:n=new En(e,t),this._forwarders.push(n),n}removeForwarder(e){this._forwarders=this._forwarders.filter(t=>t!==e)}hasForwarder(e){return this._forwarders.includes(e)}get name(){return this._midiInput.name}get id(){return this._midiInput.id}get connection(){return this._midiInput.connection}get manufacturer(){return this._midiInput.manufacturer}get octaveOffset(){return this._octaveOffset}set octaveOffset(e){if(this.validation&&(e=parseInt(e),isNaN(e)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=e}get state(){return this._midiInput.state}get type(){return this._midiInput.type}get nrpnEventsEnabled(){return w.validation&&console.warn("The 'nrpnEventsEnabled' property has been moved to the 'InputChannel' class."),!1}}/**
 * The `WebMidi` object makes it easier to work with the low-level Web MIDI API. Basically, it
 * simplifies sending outgoing MIDI messages and reacting to incoming MIDI messages.
 *
 * When using the WebMidi.js library, you should know that the `WebMidi` class has already been
 * instantiated. You cannot instantiate it yourself. If you use the **IIFE** version, you should
 * simply use the global object called `WebMidi`. If you use the **CJS** (CommonJS) or **ESM** (ES6
 * module) version, you get an already-instantiated object when you import the module.
 *
 * @fires WebMidi#connected
 * @fires WebMidi#disabled
 * @fires WebMidi#disconnected
 * @fires WebMidi#enabled
 * @fires WebMidi#error
 * @fires WebMidi#midiaccessgranted
 * @fires WebMidi#portschanged
 *
 * @extends EventEmitter
 * @license Apache-2.0
 */class ma extends $e{constructor(){super(),this.defaults={note:{attack:R.from7bitToFloat(64),release:R.from7bitToFloat(64),duration:1/0}},this.interface=null,this.validation=!0,this._inputs=[],this._disconnectedInputs=[],this._outputs=[],this._disconnectedOutputs=[],this._stateChangeQueue=[],this._octaveOffset=0}async enable(e={},t=!1){if(R.isNode){try{window.navigator}catch{global.navigator=await Object.getPrototypeOf(async function(){}).constructor(`
        let jzz = await import("jzz");
        return jzz.default;
        `)()}try{}catch{global.performance=await Object.getPrototypeOf(async function(){}).constructor(`
        let perf_hooks = await import("perf_hooks");
        return perf_hooks.performance;
        `)()}}if(this.validation=e.validation!==!1,this.validation&&(typeof e=="function"&&(e={callback:e,sysex:t}),t&&(e.sysex=!0)),this.enabled)return typeof e.callback=="function"&&e.callback(),Promise.resolve();const n={timestamp:this.time,target:this,type:"error",error:void 0},r={timestamp:this.time,target:this,type:"midiaccessgranted"},s={timestamp:this.time,target:this,type:"enabled"};try{typeof e.requestMIDIAccessFunction=="function"?this.interface=await e.requestMIDIAccessFunction({sysex:e.sysex,software:e.software}):this.interface=await navigator.requestMIDIAccess({sysex:e.sysex,software:e.software})}catch(a){return n.error=a,this.emit("error",n),typeof e.callback=="function"&&e.callback(a),Promise.reject(a)}this.emit("midiaccessgranted",r),this.interface.onstatechange=this._onInterfaceStateChange.bind(this);try{await this._updateInputsAndOutputs()}catch(a){return n.error=a,this.emit("error",n),typeof e.callback=="function"&&e.callback(a),Promise.reject(a)}return this.emit("enabled",s),typeof e.callback=="function"&&e.callback(),Promise.resolve(this)}async disable(){return this._destroyInputsAndOutputs().then(()=>{navigator&&typeof navigator.close=="function"&&navigator.close(),this.interface&&(this.interface.onstatechange=void 0),this.interface=null;let e={timestamp:this.time,target:this,type:"disabled"};this.emit("disabled",e),this.removeListener()})}getInputById(e,t={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!e)return}if(t.disconnected){for(let n=0;n<this._disconnectedInputs.length;n++)if(this._disconnectedInputs[n].id===e.toString())return this._disconnectedInputs[n]}else for(let n=0;n<this.inputs.length;n++)if(this.inputs[n].id===e.toString())return this.inputs[n]}getInputByName(e,t={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!e)return;e=e.toString()}if(t.disconnected){for(let n=0;n<this._disconnectedInputs.length;n++)if(~this._disconnectedInputs[n].name.indexOf(e))return this._disconnectedInputs[n]}else for(let n=0;n<this.inputs.length;n++)if(~this.inputs[n].name.indexOf(e))return this.inputs[n]}getOutputByName(e,t={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!e)return;e=e.toString()}if(t.disconnected){for(let n=0;n<this._disconnectedOutputs.length;n++)if(~this._disconnectedOutputs[n].name.indexOf(e))return this._disconnectedOutputs[n]}else for(let n=0;n<this.outputs.length;n++)if(~this.outputs[n].name.indexOf(e))return this.outputs[n]}getOutputById(e,t={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!e)return}if(t.disconnected){for(let n=0;n<this._disconnectedOutputs.length;n++)if(this._disconnectedOutputs[n].id===e.toString())return this._disconnectedOutputs[n]}else for(let n=0;n<this.outputs.length;n++)if(this.outputs[n].id===e.toString())return this.outputs[n]}noteNameToNumber(e){return this.validation&&console.warn("The noteNameToNumber() method is deprecated. Use Utilities.toNoteNumber() instead."),R.toNoteNumber(e,this.octaveOffset)}getOctave(e){return this.validation&&(console.warn("The getOctave()is deprecated. Use Utilities.getNoteDetails() instead"),e=parseInt(e)),!isNaN(e)&&e>=0&&e<=127?R.getNoteDetails(R.offsetNumber(e,this.octaveOffset)).octave:!1}sanitizeChannels(e){return this.validation&&console.warn("The sanitizeChannels() method has been moved to the utilities class."),R.sanitizeChannels(e)}toMIDIChannels(e){return this.validation&&console.warn("The toMIDIChannels() method has been deprecated. Use Utilities.sanitizeChannels() instead."),R.sanitizeChannels(e)}guessNoteNumber(e){return this.validation&&console.warn("The guessNoteNumber() method has been deprecated. Use Utilities.guessNoteNumber() instead."),R.guessNoteNumber(e,this.octaveOffset)}getValidNoteArray(e,t={}){return this.validation&&console.warn("The getValidNoteArray() method has been moved to the Utilities.buildNoteArray()"),R.buildNoteArray(e,t)}convertToTimestamp(e){return this.validation&&console.warn("The convertToTimestamp() method has been moved to Utilities.toTimestamp()."),R.toTimestamp(e)}async _destroyInputsAndOutputs(){let e=[];return this.inputs.forEach(t=>e.push(t.destroy())),this.outputs.forEach(t=>e.push(t.destroy())),Promise.all(e).then(()=>{this._inputs=[],this._outputs=[]})}_onInterfaceStateChange(e){this._updateInputsAndOutputs();let t={timestamp:e.timeStamp,type:e.port.state,target:this};if(e.port.state==="connected"&&e.port.connection==="open"){e.port.type==="output"?t.port=this.getOutputById(e.port.id):e.port.type==="input"&&(t.port=this.getInputById(e.port.id)),this.emit(e.port.state,t);const n=Object.assign({},t);n.type="portschanged",this.emit(n.type,n)}else if(e.port.state==="disconnected"&&e.port.connection==="pending"){e.port.type==="input"?t.port=this.getInputById(e.port.id,{disconnected:!0}):e.port.type==="output"&&(t.port=this.getOutputById(e.port.id,{disconnected:!0})),this.emit(e.port.state,t);const n=Object.assign({},t);n.type="portschanged",this.emit(n.type,n)}}async _updateInputsAndOutputs(){return Promise.all([this._updateInputs(),this._updateOutputs()])}async _updateInputs(){if(!this.interface)return;for(let t=this._inputs.length-1;t>=0;t--){const n=this._inputs[t];Array.from(this.interface.inputs.values()).find(s=>s===n._midiInput)||(this._disconnectedInputs.push(n),this._inputs.splice(t,1))}let e=[];return this.interface.inputs.forEach(t=>{if(!this._inputs.find(n=>n._midiInput===t)){let n=this._disconnectedInputs.find(r=>r._midiInput===t);n||(n=new da(t)),this._inputs.push(n),e.push(n.open())}}),Promise.all(e)}async _updateOutputs(){if(!this.interface)return;for(let t=this._outputs.length-1;t>=0;t--){const n=this._outputs[t];Array.from(this.interface.outputs.values()).find(s=>s===n._midiOutput)||(this._disconnectedOutputs.push(n),this._outputs.splice(t,1))}let e=[];return this.interface.outputs.forEach(t=>{if(!this._outputs.find(n=>n._midiOutput===t)){let n=this._disconnectedOutputs.find(r=>r._midiOutput===t);n||(n=new At(t)),this._outputs.push(n),e.push(n.open())}}),Promise.all(e)}get enabled(){return this.interface!==null}get inputs(){return this._inputs}get isNode(){return this.validation&&console.warn("WebMidi.isNode has been deprecated. Use Utilities.isNode instead."),R.isNode}get isBrowser(){return this.validation&&console.warn("WebMidi.isBrowser has been deprecated. Use Utilities.isBrowser instead."),R.isBrowser}get octaveOffset(){return this._octaveOffset}set octaveOffset(e){if(this.validation&&(e=parseInt(e),isNaN(e)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=e}get outputs(){return this._outputs}get supported(){return typeof navigator<"u"&&navigator.requestMIDIAccess}get sysexEnabled(){return!!(this.interface&&this.interface.sysexEnabled)}get time(){return performance.now()}get version(){return"3.1.5"}get flavour(){return"esm"}get CHANNEL_EVENTS(){return this.validation&&console.warn("The CHANNEL_EVENTS enum has been moved to Enumerations.CHANNEL_EVENTS."),_.CHANNEL_EVENTS}get MIDI_SYSTEM_MESSAGES(){return this.validation&&console.warn("The MIDI_SYSTEM_MESSAGES enum has been moved to Enumerations.SYSTEM_MESSAGES."),_.SYSTEM_MESSAGES}get MIDI_CHANNEL_MODE_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MODE_MESSAGES enum has been moved to Enumerations.CHANNEL_MODE_MESSAGES."),_.CHANNEL_MODE_MESSAGES}get MIDI_CONTROL_CHANGE_MESSAGES(){return this.validation&&console.warn("The MIDI_CONTROL_CHANGE_MESSAGES enum has been replaced by the Enumerations.CONTROL_CHANGE_MESSAGES array."),_.MIDI_CONTROL_CHANGE_MESSAGES}get MIDI_REGISTERED_PARAMETER(){return this.validation&&console.warn("The MIDI_REGISTERED_PARAMETER enum has been moved to Enumerations.REGISTERED_PARAMETERS."),_.REGISTERED_PARAMETERS}get NOTES(){return this.validation&&console.warn("The NOTES enum has been deprecated."),["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"]}}const w=new ma;w.constructor=null;const ct=(...i)=>{},er=(i,e)=>{let t=i.ledOn==e.ledOn&&i.ledFlash==e.ledFlash&&i.controllerFlip==e.controllerFlip&&i.midiThru==e.midiThru;("i2cLeader"in i||"i2cLeader"in e)&&(t=t&&i.i2cLeader==e.i2cLeader),("faderMax"in i||"faderMax"in e)&&(t=t&&i.faderMax==e.faderMax&&i.faderMin==e.faderMin);let n=!0,r=!0;return i.usbControls.forEach((s,a)=>{const l=e.usbControls[a];(s.channel!=l.channel||s.cc!=l.cc)&&(n=!1)}),i.trsControls.forEach((s,a)=>{const l=e.trsControls[a];(s.channel!=l.channel||s.cc!=l.cc)&&(r=!1)}),t&&n&&r},Ze=i=>{const e=Array.from({length:84},()=>0),t=i.firmwareVersion.trim().split(".").map(f=>parseInt(f));e[0]=i.deviceId,e[1]=t[0],e[2]=t[1],e[3]=t[2],e[4]=i.ledOn?1:0,e[5]=i.ledFlash?1:0,e[6]=i.controllerFlip?1:0,e[7]=i.i2cLeader?1:0;const n=i.faderMin>>7,r=i.faderMin-(n<<7);e[8]=r,e[9]=n;const s=i.faderMax>>7,a=i.faderMax-(s<<7);e[10]=a,e[11]=s,e[12]=i.midiThru?1:0;const l=20,o=36,c=52,u=68;return i.usbControls.forEach((f,d)=>{e[d+l]=f.channel,e[d+c]=f.cc}),i.trsControls.forEach((f,d)=>{e[d+o]=f.channel,e[d+u]=f.cc}),e},pa=i=>Ze(i).slice(4,20),Ea=i=>{const e=Ze(i),t=e.slice(20,36),n=e.slice(52,68);return t.concat(n)},_a=i=>{const e=Ze(i),t=e.slice(36,52),n=e.slice(68,84);return t.concat(n)},ga=i=>{const e={...i},t=Re(i.deviceId).controlCount;return e.usbControls=e.usbControls.splice(0,t),e.usbControls.forEach(n=>delete n.val),e.trsControls=e.trsControls.splice(0,t),JSON.stringify(e,null,2)},ba=(i,e)=>e.deviceId!=i.deviceId?`Cannot update - this data file is for a ${Re(e.deviceId).name}, but you are trying to install it on a ${Re(i.deviceId).name} `:!1,va=(i,e)=>(Object.keys(e).forEach(t=>{i[t]=e[t]}),i),$a=i=>{const t=i[5],n=i[6]+"."+i[7]+"."+i[8],r=i[1+8]==1,s=i[2+8]==1,a=i[3+8]==1,l=i[4+8]==1,o=i[5+8],u=(i[6+8]<<7)+o,f=i[7+8],h=(i[8+8]<<7)+f,O=i[9+8]==1,B=[],I=[];return i.slice(17+8,33+8).forEach((S,b)=>{S!=127&&(B[b]={channel:S})}),i.slice(33+8,49+8).forEach((S,b)=>{S!=127&&(I[b]={channel:S})}),i.slice(49+8,65+8).forEach((S,b)=>{S!=127&&(B[b].cc=S)}),i.slice(65+8,81+8).forEach((S,b)=>{S!=127&&(I[b].cc=S)}),B.forEach(S=>S.val=0),{ledOn:r,ledFlash:s,controllerFlip:a,midiThru:O,usbControls:B,trsControls:I,deviceId:t,firmwareVersion:n,i2cLeader:l,faderMin:u,faderMax:h}},Re=i=>Na[i],De=(i,e)=>!!Re(i.deviceId).capabilities[e],Na=[{name:"unknown",controlCount:0,capabilities:{}},{name:"Oxion development board",controlCount:4,capabilities:{led:!0}},{name:"16n",controlCount:16,capabilities:{i2c:!0,led:!0,faderCalibration:!0}},{name:"16n (LC)",controlCount:16,capabilities:{i2c:!0,led:!0,faderCalibration:!0},sendShortMessages:!0},{name:"16next",controlCount:16,capabilities:{i2c:!0,led:!0}}],Ee={sysexMfgId:[125,0,0],requestInfoMsg:31,updateConfigMsg:14,updateDeviceOptionsMsg:13,updateUSBOptionsMessage:12,updateTRSOptionsMessage:11,factoryResetMsg:26},ya=i=>i[1]==Ee.sysexMfgId[0]&&i[2]==Ee.sysexMfgId[1]&&i[3]==Ee.sysexMfgId[2],Sa=(i,e)=>{Re(i.deviceId).sendShortMessages?Ia(i,e):wa(i,e)},wa=(i,e)=>{e.sendSysex(Ee.sysexMfgId,[Ee.updateConfigMsg,...Ze(i)])},Ia=(i,e)=>{e.sendSysex(Ee.sysexMfgId,[Ee.updateDeviceOptionsMsg,...pa(i)]),e.sendSysex(Ee.sysexMfgId,[Ee.updateUSBOptionsMessage,...Ea(i)]),e.sendSysex(Ee.sysexMfgId,[Ee.updateTRSOptionsMessage,..._a(i)])},tr=i=>{i.sendSysex(Ee.sysexMfgId,[Ee.requestInfoMsg])},nr=i=>{i.sendSysex(Ee.sysexMfgId,[Ee.factoryResetMsg])},_e=ye(null),ft=ye(!1),fe=ye(null),Ae=ye(!1),Ue=ye([]),We=ye([]),Je=ye(null),Te=ye(null),Ut=ye(!1);let st=-1;Je.subscribe(i=>{i&&(ve(Ue).forEach(e=>{e.removeListener()}),sr(i),ir(i),_e.set(null),Gt())});Te.subscribe(i=>{i&&(_e.set(null),Gt())});const wt=()=>w.inputs.sort(rr),It=()=>w.outputs.sort(rr),rr=(i,e)=>{const t=`${i.manufacturer} ${i.name}`,n=`${e.manufacturer} ${e.name}`;return t<n?-1:t>n?1:0},Ra=()=>{Ut.set(!0),Aa()},Aa=()=>{Ue.set(wt()),We.set(It()),rt(),w.addListener("connected",()=>{Ue.set(wt()),We.set(It()),rt()}),w.addListener("disconnected",()=>{Ue.set(wt()),We.set(It()),Je.set(null),Te.set(null),_e.set(null),rt()}),setInterval(()=>{rt()},5e3)},rt=()=>{const i=ve(Je),e=ve(Te);if(!i&&ve(Ue).length>0){const t=ve(Ue).find(n=>n.name.match(/.*16n.*/));t&&Je.set(t)}if(!e&&ve(We).length>0){const t=ve(We).find(n=>n.name.match(/.*16n.*/));t&&Te.set(t)}!ve(_e)&&i&&e&&(sr(i),ir(i),Gt())},Ca=i=>{const e=ve(_e);e&&(e.usbControls.forEach(t=>{t.channel==i.message.channel&&t.cc==i.controller.number&&(t.val=i.rawValue)}),_e.set(e))},sr=i=>{i.addListener("controlchange",Ca)},ir=i=>{i.addListener("sysex",e=>{const t=e.message.data;ya(t)&&t[4]==15&&(_e.set($a(t)),ct("Received config",ve(_e)),st=-1,ft.set(!1))}),ct("Attached sysex listener to ",i.name)},Gt=()=>{st<0&&(st=Date.now()),Date.now()-st>8e3&&(ve(ft)||ft.set(!0));const i=ve(Je),e=ve(Te);i&&e&&(ct("Requesting config over "+e.name),ct("Hoping to receive on "+i.name),tr(e))};function Ma(i){let e,t;return{c(){e=A("span"),this.h()},l(n){e=C(n,"SPAN",{class:!0}),D(e).forEach(p),this.h()},h(){L(e,"class",t="fas fa-"+i[0]+" "+i[1]+" svelte-pvbvkq")},m(n,r){N(n,e,r)},p(n,[r]){r&3&&t!==(t="fas fa-"+n[0]+" "+n[1]+" svelte-pvbvkq")&&L(e,"class",t)},i:le,o:le,d(n){n&&p(e)}}}function Ta(i,e,t){let{i:n}=e,{classList:r=""}=e;return i.$$set=s=>{"i"in s&&t(0,n=s.i),"classList"in s&&t(1,r=s.classList)},[n,r]}class Oa extends he{constructor(e){super(),de(this,e,Ta,Ma,me,{i:0,classList:1})}}function _n(i){let e,t;return e=new Oa({props:{i:i[1]}}),{c(){W(e.$$.fragment)},l(n){J(e.$$.fragment,n)},m(n,r){K(e,n,r),t=!0},p(n,r){const s={};r&2&&(s.i=n[1]),e.$set(s)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){M(e.$$.fragment,n),t=!1},d(n){Z(e,n)}}}function La(i){let e,t,n=i[1]&&i[1].trim()!=="",r,s,a,l,o,c=n&&_n(i);return{c(){e=A("div"),t=A("button"),c&&c.c(),r=x(),s=G(i[0]),this.h()},l(u){e=C(u,"DIV",{class:!0});var f=D(e);t=C(f,"BUTTON",{class:!0});var d=D(t);c&&c.l(d),r=j(d),s=F(d,i[0]),d.forEach(p),f.forEach(p),this.h()},h(){t.disabled=i[2],L(t,"class","svelte-1qu28ag"),L(e,"class","button-wrapper svelte-1qu28ag")},m(u,f){N(u,e,f),$(e,t),c&&c.m(t,null),$(t,r),$(t,s),a=!0,l||(o=be(t,"click",function(){ur(i[3])&&i[3].apply(this,arguments)}),l=!0)},p(u,[f]){i=u,f&2&&(n=i[1]&&i[1].trim()!==""),n?c?(c.p(i,f),f&2&&y(c,1)):(c=_n(i),c.c(),y(c,1),c.m(t,r)):c&&(oe(),M(c,1,1,()=>{c=null}),ce()),(!a||f&1)&&Ne(s,i[0]),(!a||f&4)&&(t.disabled=i[2])},i(u){a||(y(c),a=!0)},o(u){M(c),a=!1},d(u){u&&p(e),c&&c.d(),l=!1,o()}}}function Da(i,e,t){let{label:n}=e,{icon:r=""}=e,{disabled:s=!1}=e,{click:a}=e;return i.$$set=l=>{"label"in l&&t(0,n=l.label),"icon"in l&&t(1,r=l.icon),"disabled"in l&&t(2,s=l.disabled),"click"in l&&t(3,a=l.click)},[n,r,s,a]}class Oe extends he{constructor(e){super(),de(this,e,Da,La,me,{label:0,icon:1,disabled:2,click:3})}}function gn(i){let e;function t(s,a){return s[2]?Pa:ka}let n=t(i),r=n(i);return{c(){e=A("div"),r.c(),this.h()},l(s){e=C(s,"DIV",{class:!0});var a=D(e);r.l(a),a.forEach(p),this.h()},h(){L(e,"class","details svelte-ykry5x")},m(s,a){N(s,e,a),r.m(e,null)},p(s,a){n===(n=t(s))&&r?r.p(s,a):(r.d(1),r=n(s),r&&(r.c(),r.m(e,null)))},d(s){s&&p(e),r.d()}}}function ka(i){let e,t;return{c(){e=A("p"),t=G("No device connected."),this.h()},l(n){e=C(n,"P",{class:!0});var r=D(e);t=F(r,"No device connected."),r.forEach(p),this.h()},h(){L(e,"class","device svelte-ykry5x")},m(n,r){N(n,e,r),$(e,t)},p:le,d(n){n&&p(e)}}}function Pa(i){let e,t,n,r=Re(i[2].deviceId).name+"",s,a,l,o=i[2].firmwareVersion+"",c,u,f=i[0].trim()!="",d=f&&bn(i);return{c(){e=A("p"),t=G("Connected: "),n=A("strong"),s=G(r),a=G(`
        running firmware
        `),l=A("strong"),c=G(o),u=x(),d&&d.c(),this.h()},l(h){e=C(h,"P",{class:!0});var O=D(e);t=F(O,"Connected: "),n=C(O,"STRONG",{});var B=D(n);s=F(B,r),B.forEach(p),a=F(O,`
        running firmware
        `),l=C(O,"STRONG",{});var I=D(l);c=F(I,o),I.forEach(p),u=j(O),d&&d.l(O),O.forEach(p),this.h()},h(){L(e,"class","device svelte-ykry5x")},m(h,O){N(h,e,O),$(e,t),$(e,n),$(n,s),$(e,a),$(e,l),$(l,c),$(e,u),d&&d.m(e,null)},p(h,O){O&4&&r!==(r=Re(h[2].deviceId).name+"")&&Ne(s,r),O&4&&o!==(o=h[2].firmwareVersion+"")&&Ne(c,o),O&1&&(f=h[0].trim()!=""),f?d?d.p(h,O):(d=bn(h),d.c(),d.m(e,null)):d&&(d.d(1),d=null)},d(h){h&&p(e),d&&d.d()}}}function bn(i){let e,t,n,r,s;return{c(){e=A("span"),t=G(i[0]),n=x(),r=A("a"),s=G("Download"),this.h()},l(a){e=C(a,"SPAN",{class:!0});var l=D(e);t=F(l,i[0]),n=j(l),r=C(l,"A",{href:!0});var o=D(r);s=F(o,"Download"),o.forEach(p),l.forEach(p),this.h()},h(){L(r,"href","https://github.com/16n-faderbank/16n/releases/latest"),L(e,"class","upgrade svelte-ykry5x")},m(a,l){N(a,e,l),$(e,t),$(e,n),$(e,r),$(r,s)},p(a,l){l&1&&Ne(t,a[0])},d(a){a&&p(e)}}}function Ba(i){let e,t=i[1]&&gn(i);return{c(){t&&t.c(),e=re()},l(n){t&&t.l(n),e=re()},m(n,r){t&&t.m(n,r),N(n,e,r)},p(n,[r]){n[1]?t?t.p(n,r):(t=gn(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:le,o:le,d(n){t&&t.d(n),n&&p(e)}}}function Ua(i,e,t){let n,r;se(i,Ut,c=>t(1,n=c)),se(i,_e,c=>t(2,r=c));let s="",a="2.1.1",l=!1;const o=_e.subscribe(c=>{c&&c.firmwareVersion&&a.trim()!==""&&!l&&(l=!0,Me.gt(a,c.firmwareVersion)?t(0,s=`A new version of the 16n firmware (${a}) is available.`):t(0,s=""))});return Rt(()=>{o()}),[s,n,r]}class Ga extends he{constructor(e){super(),de(this,e,Ua,Ba,me,{})}}function Fa(i){let e,t,n,r,s,a,l;const o=i[2].default,c=He(o,i,i[1],null);return{c(){e=A("p"),t=A("label"),n=A("input"),r=x(),c&&c.c(),this.h()},l(u){e=C(u,"P",{});var f=D(e);t=C(f,"LABEL",{});var d=D(t);n=C(d,"INPUT",{type:!0}),r=j(d),c&&c.l(d),d.forEach(p),f.forEach(p),this.h()},h(){L(n,"type","checkbox")},m(u,f){N(u,e,f),$(e,t),$(t,n),n.checked=i[0],$(t,r),c&&c.m(t,null),s=!0,a||(l=be(n,"change",i[3]),a=!0)},p(u,[f]){f&1&&(n.checked=u[0]),c&&c.p&&(!s||f&2)&&xe(c,o,u,u[1],s?qe(o,u[1],f,null):je(u[1]),null)},i(u){s||(y(c,u),s=!0)},o(u){M(c,u),s=!1},d(u){u&&p(e),c&&c.d(u),a=!1,l()}}}function Va(i,e,t){let{$$slots:n={},$$scope:r}=e,{checked:s}=e;function a(){s=this.checked,t(0,s)}return i.$$set=l=>{"checked"in l&&t(0,s=l.checked),"$$scope"in l&&t(1,r=l.$$scope)},[s,r,n,a]}class ut extends he{constructor(e){super(),de(this,e,Va,Fa,me,{checked:0})}}function vn(i){let e,t,n,r,s,a;function l(f){i[3](f)}let o={$$slots:{default:[Ha]},$$scope:{ctx:i}};i[0].ledOn!==void 0&&(o.checked=i[0].ledOn),e=new ut({props:o}),it.push(()=>at(e,"checked",l));function c(f){i[4](f)}let u={$$slots:{default:[xa]},$$scope:{ctx:i}};return i[0].ledFlash!==void 0&&(u.checked=i[0].ledFlash),r=new ut({props:u}),it.push(()=>at(r,"checked",c)),{c(){W(e.$$.fragment),n=x(),W(r.$$.fragment)},l(f){J(e.$$.fragment,f),n=j(f),J(r.$$.fragment,f)},m(f,d){K(e,f,d),N(f,n,d),K(r,f,d),a=!0},p(f,d){const h={};d&1024&&(h.$$scope={dirty:d,ctx:f}),!t&&d&1&&(t=!0,h.checked=f[0].ledOn,lt(()=>t=!1)),e.$set(h);const O={};d&1024&&(O.$$scope={dirty:d,ctx:f}),!s&&d&1&&(s=!0,O.checked=f[0].ledFlash,lt(()=>s=!1)),r.$set(O)},i(f){a||(y(e.$$.fragment,f),y(r.$$.fragment,f),a=!0)},o(f){M(e.$$.fragment,f),M(r.$$.fragment,f),a=!1},d(f){Z(e,f),f&&p(n),Z(r,f)}}}function Ha(i){let e;return{c(){e=G("LED permanently on when powered")},l(t){e=F(t,"LED permanently on when powered")},m(t,n){N(t,e,n)},d(t){t&&p(e)}}}function xa(i){let e;return{c(){e=G("LED flash on MIDI activity")},l(t){e=F(t,"LED flash on MIDI activity")},m(t,n){N(t,e,n)},d(t){t&&p(e)}}}function ja(i){let e;return{c(){e=G("Rotate controller 180")},l(t){e=F(t,"Rotate controller 180")},m(t,n){N(t,e,n)},d(t){t&&p(e)}}}function $n(i){let e,t,n;function r(a){i[6](a)}let s={$$slots:{default:[qa]},$$scope:{ctx:i}};return i[0].midiThru!==void 0&&(s.checked=i[0].midiThru),e=new ut({props:s}),it.push(()=>at(e,"checked",r)),{c(){W(e.$$.fragment)},l(a){J(e.$$.fragment,a)},m(a,l){K(e,a,l),n=!0},p(a,l){const o={};l&1024&&(o.$$scope={dirty:l,ctx:a}),!t&&l&1&&(t=!0,o.checked=a[0].midiThru,lt(()=>t=!1)),e.$set(o)},i(a){n||(y(e.$$.fragment,a),n=!0)},o(a){M(e.$$.fragment,a),n=!1},d(a){Z(e,a)}}}function qa(i){let e;return{c(){e=G("Soft MIDI thru (echo MIDI clock/note data sent to USB out of the minijack)")},l(t){e=F(t,"Soft MIDI thru (echo MIDI clock/note data sent to USB out of the minijack)")},m(t,n){N(t,e,n)},d(t){t&&p(e)}}}function Nn(i){let e,t,n,r,s,a,l,o,c,u,f,d,h,O,B,I,S,b,g,m,T,P,Y,ee,te,ae,pe;return{c(){e=A("hr"),t=x(),n=A("h3"),r=G("Fader Minimum/Maximum calibration"),s=x(),a=A("div"),l=A("label"),o=G("Fader Minimum raw value"),c=x(),u=A("input"),f=x(),d=A("div"),h=A("label"),O=G("Fader Maximum raw value"),B=x(),I=A("input"),S=x(),b=A("p"),g=G(`You shouldn't touch this unless you are having issues with your faders
    either reaching `),m=A("code"),T=G("127"),P=G(`
    before the end of their travel, or not at all.`),Y=A("br"),ee=A("br"),te=G(`
    "Raw" analog values are read from the faders between 0 and 8192. Bring the fader
    maximum down until all faders smoothly travel from 0 to 127 on the debug view
    (bearing in mind there is a small dead zone at either end of a fader).`),this.h()},l(z){e=C(z,"HR",{}),t=j(z),n=C(z,"H3",{});var E=D(n);r=F(E,"Fader Minimum/Maximum calibration"),E.forEach(p),s=j(z),a=C(z,"DIV",{});var v=D(a);l=C(v,"LABEL",{for:!0,class:!0});var H=D(l);o=F(H,"Fader Minimum raw value"),H.forEach(p),c=j(v),u=C(v,"INPUT",{name:!0,type:!0,min:!0,max:!0}),v.forEach(p),f=j(z),d=C(z,"DIV",{});var U=D(d);h=C(U,"LABEL",{for:!0,class:!0});var V=D(h);O=F(V,"Fader Maximum raw value"),V.forEach(p),B=j(U),I=C(U,"INPUT",{name:!0,type:!0,min:!0,max:!0}),U.forEach(p),S=j(z),b=C(z,"P",{class:!0});var k=D(b);g=F(k,`You shouldn't touch this unless you are having issues with your faders
    either reaching `),m=C(k,"CODE",{});var q=D(m);T=F(q,"127"),q.forEach(p),P=F(k,`
    before the end of their travel, or not at all.`),Y=C(k,"BR",{}),ee=C(k,"BR",{}),te=F(k,`
    "Raw" analog values are read from the faders between 0 and 8192. Bring the fader
    maximum down until all faders smoothly travel from 0 to 127 on the debug view
    (bearing in mind there is a small dead zone at either end of a fader).`),k.forEach(p),this.h()},h(){L(l,"for","faderMin"),L(l,"class","svelte-idpdcv"),L(u,"name","faderMin"),L(u,"type","number"),L(u,"min","0"),L(u,"max",(1<<13)-1),L(h,"for","faderMax"),L(h,"class","svelte-idpdcv"),L(I,"name","faderMax"),L(I,"type","number"),L(I,"min","0"),L(I,"max",(1<<13)-1),L(b,"class","note svelte-idpdcv")},m(z,E){N(z,e,E),N(z,t,E),N(z,n,E),$(n,r),N(z,s,E),N(z,a,E),$(a,l),$(l,o),$(a,c),$(a,u),ke(u,i[0].faderMin),N(z,f,E),N(z,d,E),$(d,h),$(h,O),$(d,B),$(d,I),ke(I,i[0].faderMax),N(z,S,E),N(z,b,E),$(b,g),$(b,m),$(m,T),$(b,P),$(b,Y),$(b,ee),$(b,te),ae||(pe=[be(u,"input",i[7]),be(u,"blur",i[2]),be(I,"input",i[8]),be(I,"blur",i[2])],ae=!0)},p(z,E){E&1&&Ve(u.value)!==z[0].faderMin&&ke(u,z[0].faderMin),E&1&&Ve(I.value)!==z[0].faderMax&&ke(I,z[0].faderMax)},d(z){z&&p(e),z&&p(t),z&&p(n),z&&p(s),z&&p(a),z&&p(f),z&&p(d),z&&p(S),z&&p(b),ae=!1,Ct(pe)}}}function yn(i){let e,t,n,r,s,a,l,o,c,u,f,d,h,O,B,I,S,b,g,m,T,P,Y,ee,te,ae,pe,z;return{c(){e=A("hr"),t=x(),n=A("h3"),r=G("I2C Leader/Follower"),s=x(),a=A("select"),l=A("option"),o=G("Follower"),c=A("option"),u=G("Leader"),f=x(),d=A("p"),h=A("strong"),O=G("Follower"),B=G(" mode is for use with Teletype."),I=x(),S=A("p"),b=A("strong"),g=G("Leader"),m=G(` mode is for use with Ansible, TXo, ER-301. 16n will not
    respond to Teletype when in leader mode.`),T=x(),P=A("p"),Y=G("This will not take effect until you restart (disconnect/reconnect) your 16n."),ee=x(),te=A("p"),ae=G(`("Leader" is sometimes also referred to as 'master' mode)`),this.h()},l(E){e=C(E,"HR",{}),t=j(E),n=C(E,"H3",{});var v=D(n);r=F(v,"I2C Leader/Follower"),v.forEach(p),s=j(E),a=C(E,"SELECT",{});var H=D(a);l=C(H,"OPTION",{});var U=D(l);o=F(U,"Follower"),U.forEach(p),c=C(H,"OPTION",{});var V=D(c);u=F(V,"Leader"),V.forEach(p),H.forEach(p),f=j(E),d=C(E,"P",{class:!0});var k=D(d);h=C(k,"STRONG",{});var q=D(h);O=F(q,"Follower"),q.forEach(p),B=F(k," mode is for use with Teletype."),k.forEach(p),I=j(E),S=C(E,"P",{class:!0});var Q=D(S);b=C(Q,"STRONG",{});var X=D(b);g=F(X,"Leader"),X.forEach(p),m=F(Q,` mode is for use with Ansible, TXo, ER-301. 16n will not
    respond to Teletype when in leader mode.`),Q.forEach(p),T=j(E),P=C(E,"P",{class:!0});var ne=D(P);Y=F(ne,"This will not take effect until you restart (disconnect/reconnect) your 16n."),ne.forEach(p),ee=j(E),te=C(E,"P",{class:!0});var ue=D(te);ae=F(ue,`("Leader" is sometimes also referred to as 'master' mode)`),ue.forEach(p),this.h()},h(){l.__value=!1,l.value=l.__value,c.__value=!0,c.value=c.__value,i[0].i2cLeader===void 0&&xn(()=>i[9].call(a)),L(d,"class","note svelte-idpdcv"),L(S,"class","note svelte-idpdcv"),L(P,"class","note svelte-idpdcv"),L(te,"class","note small svelte-idpdcv")},m(E,v){N(E,e,v),N(E,t,v),N(E,n,v),$(n,r),N(E,s,v),N(E,a,v),$(a,l),$(l,o),$(a,c),$(c,u),ot(a,i[0].i2cLeader,!0),N(E,f,v),N(E,d,v),$(d,h),$(h,O),$(d,B),N(E,I,v),N(E,S,v),$(S,b),$(b,g),$(S,m),N(E,T,v),N(E,P,v),$(P,Y),N(E,ee,v),N(E,te,v),$(te,ae),pe||(z=[be(a,"change",i[9]),be(a,"change",i[2])],pe=!0)},p(E,v){v&1&&ot(a,E[0].i2cLeader)},d(E){E&&p(e),E&&p(t),E&&p(n),E&&p(s),E&&p(a),E&&p(f),E&&p(d),E&&p(I),E&&p(S),E&&p(T),E&&p(P),E&&p(ee),E&&p(te),pe=!1,Ct(z)}}}function Ya(i){let e=De(i[1],"led"),t,n,r,s,a=Me.gte(i[1].firmwareVersion,"2.1.0"),l,o=De(i[1],"faderCalibration"),c,u=De(i[1],"i2c"),f,d,h=e&&vn(i);function O(g){i[5](g)}let B={$$slots:{default:[ja]},$$scope:{ctx:i}};i[0].controllerFlip!==void 0&&(B.checked=i[0].controllerFlip),n=new ut({props:B}),it.push(()=>at(n,"checked",O));let I=a&&$n(i),S=o&&Nn(i),b=u&&yn(i);return{c(){h&&h.c(),t=x(),W(n.$$.fragment),s=x(),I&&I.c(),l=x(),S&&S.c(),c=x(),b&&b.c(),f=re()},l(g){h&&h.l(g),t=j(g),J(n.$$.fragment,g),s=j(g),I&&I.l(g),l=j(g),S&&S.l(g),c=j(g),b&&b.l(g),f=re()},m(g,m){h&&h.m(g,m),N(g,t,m),K(n,g,m),N(g,s,m),I&&I.m(g,m),N(g,l,m),S&&S.m(g,m),N(g,c,m),b&&b.m(g,m),N(g,f,m),d=!0},p(g,[m]){m&2&&(e=De(g[1],"led")),e?h?(h.p(g,m),m&2&&y(h,1)):(h=vn(g),h.c(),y(h,1),h.m(t.parentNode,t)):h&&(oe(),M(h,1,1,()=>{h=null}),ce());const T={};m&1024&&(T.$$scope={dirty:m,ctx:g}),!r&&m&1&&(r=!0,T.checked=g[0].controllerFlip,lt(()=>r=!1)),n.$set(T),m&2&&(a=Me.gte(g[1].firmwareVersion,"2.1.0")),a?I?(I.p(g,m),m&2&&y(I,1)):(I=$n(g),I.c(),y(I,1),I.m(l.parentNode,l)):I&&(oe(),M(I,1,1,()=>{I=null}),ce()),m&2&&(o=De(g[1],"faderCalibration")),o?S?S.p(g,m):(S=Nn(g),S.c(),S.m(c.parentNode,c)):S&&(S.d(1),S=null),m&2&&(u=De(g[1],"i2c")),u?b?b.p(g,m):(b=yn(g),b.c(),b.m(f.parentNode,f)):b&&(b.d(1),b=null)},i(g){d||(y(h),y(n.$$.fragment,g),y(I),d=!0)},o(g){M(h),M(n.$$.fragment,g),M(I),d=!1},d(g){h&&h.d(g),g&&p(t),Z(n,g),g&&p(s),I&&I.d(g),g&&p(l),S&&S.d(g),g&&p(c),b&&b.d(g),g&&p(f)}}}function za(i,e,t){let n,r;se(i,fe,h=>t(0,n=h)),se(i,_e,h=>t(1,r=h));const s=()=>{fe.set(n)};function a(h){i.$$.not_equal(n.ledOn,h)&&(n.ledOn=h,fe.set(n))}function l(h){i.$$.not_equal(n.ledFlash,h)&&(n.ledFlash=h,fe.set(n))}function o(h){i.$$.not_equal(n.controllerFlip,h)&&(n.controllerFlip=h,fe.set(n))}function c(h){i.$$.not_equal(n.midiThru,h)&&(n.midiThru=h,fe.set(n))}function u(){n.faderMin=Ve(this.value),fe.set(n)}function f(){n.faderMax=Ve(this.value),fe.set(n)}function d(){n.i2cLeader=jn(this),fe.set(n)}return[n,r,s,a,l,o,c,u,f,d]}class Xa extends he{constructor(e){super(),de(this,e,za,Ya,me,{})}}function Sn(i,e,t){const n=i.slice();return n[8]=e[t],n}function wn(i){let e,t=i[8]+"",n,r;return{c(){e=A("option"),n=G(t),this.h()},l(s){e=C(s,"OPTION",{});var a=D(e);n=F(a,t),a.forEach(p),this.h()},h(){e.__value=r=i[8],e.value=e.__value},m(s,a){N(s,e,a),$(e,n)},p(s,a){a&4&&t!==(t=s[8]+"")&&Ne(n,t),a&4&&r!==(r=s[8])&&(e.__value=r,e.value=e.__value)},d(s){s&&p(e)}}}function Wa(i){let e,t,n=i[1]+1+"",r,s,a,l,o,c,u,f,d,h,O,B,I=i[2],S=[];for(let b=0;b<I.length;b+=1)S[b]=wn(Sn(i,I,b));return{c(){e=A("dl"),t=A("dt"),r=G(n),s=A("dt"),a=G("Channel"),l=A("dd"),o=A("select");for(let b=0;b<S.length;b+=1)S[b].c();c=x(),u=A("dt"),f=G("CC"),d=A("dd"),h=A("input"),this.h()},l(b){e=C(b,"DL",{class:!0});var g=D(e);t=C(g,"DT",{class:!0});var m=D(t);r=F(m,n),m.forEach(p),s=C(g,"DT",{class:!0});var T=D(s);a=F(T,"Channel"),T.forEach(p),l=C(g,"DD",{class:!0});var P=D(l);o=C(P,"SELECT",{});var Y=D(o);for(let ae=0;ae<S.length;ae+=1)S[ae].l(Y);Y.forEach(p),c=j(P),P.forEach(p),u=C(g,"DT",{class:!0});var ee=D(u);f=F(ee,"CC"),ee.forEach(p),d=C(g,"DD",{class:!0});var te=D(d);h=C(te,"INPUT",{type:!0,min:!0,max:!0,class:!0}),te.forEach(p),g.forEach(p),this.h()},h(){L(t,"class","index svelte-gqdu21"),L(s,"class","svelte-gqdu21"),i[0].channel===void 0&&xn(()=>i[5].call(o)),L(l,"class","svelte-gqdu21"),L(u,"class","svelte-gqdu21"),L(h,"type","number"),L(h,"min","0"),L(h,"max","127"),L(h,"class","svelte-gqdu21"),L(d,"class","svelte-gqdu21"),L(e,"class","config-column svelte-gqdu21")},m(b,g){N(b,e,g),$(e,t),$(t,r),$(e,s),$(s,a),$(e,l),$(l,o);for(let m=0;m<S.length;m+=1)S[m]&&S[m].m(o,null);ot(o,i[0].channel,!0),$(l,c),$(e,u),$(u,f),$(e,d),$(d,h),ke(h,i[0].cc),O||(B=[be(o,"change",i[5]),be(o,"change",i[3]),be(h,"input",i[6]),be(h,"change",i[4]),be(h,"blur",i[4])],O=!0)},p(b,[g]){if(g&2&&n!==(n=b[1]+1+"")&&Ne(r,n),g&4){I=b[2];let m;for(m=0;m<I.length;m+=1){const T=Sn(b,I,m);S[m]?S[m].p(T,g):(S[m]=wn(T),S[m].c(),S[m].m(o,null))}for(;m<S.length;m+=1)S[m].d(1);S.length=I.length}g&5&&ot(o,b[0].channel),g&5&&Ve(h.value)!==b[0].cc&&ke(h,b[0].cc)},i:le,o:le,d(b){b&&p(e),Ke(S,b),O=!1,Ct(B)}}}function Ja(i,e,t){let n;se(i,fe,f=>t(7,n=f));let{index:r}=e,{editControl:s}=e;const a=Array.from(Array(16).keys());a.forEach((f,d)=>t(2,a[d]=f+1,a));const l=()=>{fe.set(n)},o=f=>{const d=f.target;parseInt(d.value)<0&&t(0,s.cc=0,s),parseInt(d.value)>127&&t(0,s.cc=127,s),fe.set(n)};function c(){s.channel=jn(this),t(0,s),t(2,a)}function u(){s.cc=Ve(this.value),t(0,s),t(2,a)}return i.$$set=f=>{"index"in f&&t(1,r=f.index),"editControl"in f&&t(0,s=f.editControl)},[s,r,a,l,o,c,u]}class ar extends he{constructor(e){super(),de(this,e,Ja,Wa,me,{index:1,editControl:0})}}function Ka(i){let e,t,n,r,s,a,l,o;return l=new Oe({props:{label:"Reset controller configuration to defaults",icon:"history",click:i[0]}}),l.$on("message",i[1]),{c(){e=A("p"),t=G(`"Factory Reset" will reset the configuration of your 16n back to 'default'
  values; primarily, MIDI CCs 32-48, Channel 1, for both TRS and USB MIDI.`),n=x(),r=A("p"),s=G(`Note that this will also reset any calibration data or other options you may
  have adjusted on the "Device Options" tab. You will need to repeat this
  configuration after performing a reset.`),a=x(),W(l.$$.fragment)},l(c){e=C(c,"P",{});var u=D(e);t=F(u,`"Factory Reset" will reset the configuration of your 16n back to 'default'
  values; primarily, MIDI CCs 32-48, Channel 1, for both TRS and USB MIDI.`),u.forEach(p),n=j(c),r=C(c,"P",{});var f=D(r);s=F(f,`Note that this will also reset any calibration data or other options you may
  have adjusted on the "Device Options" tab. You will need to repeat this
  configuration after performing a reset.`),f.forEach(p),a=j(c),J(l.$$.fragment,c)},m(c,u){N(c,e,u),$(e,t),N(c,n,u),N(c,r,u),$(r,s),N(c,a,u),K(l,c,u),o=!0},p:le,i(c){o||(y(l.$$.fragment,c),o=!0)},o(c){M(l.$$.fragment,c),o=!1},d(c){c&&p(e),c&&p(n),c&&p(r),c&&p(a),Z(l,c)}}}const Za="Confirm that you wish to reset your controller configuration to the default values. You will lose any configuration stored on the controller.";function Qa(i,e,t){let n,r;se(i,Te,l=>t(2,n=l)),se(i,Ae,l=>t(3,r=l));const s=()=>{confirm(Za)&&(Be(Ae,r=!1,r),nr(n),setTimeout(()=>{tr(n)},50))};function a(l){qn.call(this,i,l)}return[s,a]}class el extends he{constructor(e){super(),de(this,e,Qa,Ka,me,{})}}function tl(i){let e,t,n,r,s,a;const l=i[2].default,o=He(l,i,i[1],null);return{c(){e=A("div"),t=A("h2"),n=G(i[0]),r=x(),s=A("div"),o&&o.c(),this.h()},l(c){e=C(c,"DIV",{class:!0});var u=D(e);t=C(u,"H2",{class:!0});var f=D(t);n=F(f,i[0]),f.forEach(p),r=j(u),s=C(u,"DIV",{class:!0});var d=D(s);o&&o.l(d),d.forEach(p),u.forEach(p),this.h()},h(){L(t,"class","svelte-1o2kpty"),L(s,"class","details svelte-1o2kpty"),L(e,"class","subhead svelte-1o2kpty")},m(c,u){N(c,e,u),$(e,t),$(t,n),$(e,r),$(e,s),o&&o.m(s,null),a=!0},p(c,[u]){(!a||u&1)&&Ne(n,c[0]),o&&o.p&&(!a||u&2)&&xe(o,l,c,c[1],a?qe(l,c[1],u,null):je(c[1]),null)},i(c){a||(y(o,c),a=!0)},o(c){M(o,c),a=!1},d(c){c&&p(e),o&&o.d(c)}}}function nl(i,e,t){let{$$slots:n={},$$scope:r}=e,{title:s}=e;return i.$$set=a=>{"title"in a&&t(0,s=a.title),"$$scope"in a&&t(1,r=a.$$scope)},[s,r,n]}class lr extends he{constructor(e){super(),de(this,e,nl,tl,me,{title:0})}}function rl(i){let e,t;const n=i[1].default,r=He(n,i,i[0],null);return{c(){e=A("div"),r&&r.c(),this.h()},l(s){e=C(s,"DIV",{class:!0});var a=D(e);r&&r.l(a),a.forEach(p),this.h()},h(){L(e,"class","tabs")},m(s,a){N(s,e,a),r&&r.m(e,null),t=!0},p(s,[a]){r&&r.p&&(!t||a&1)&&xe(r,n,s,s[0],t?qe(n,s[0],a,null):je(s[0]),null)},i(s){t||(y(r,s),t=!0)},o(s){M(r,s),t=!1},d(s){s&&p(e),r&&r.d(s)}}}const Ft={};function sl(i,e,t){let{$$slots:n={},$$scope:r}=e;const s=[],a=[],l=ye(null),o=ye(null);return hr(Ft,{registerTab:c=>{s.push(c),l.update(u=>u||c),Rt(()=>{const u=s.indexOf(c);s.splice(u,1),l.update(f=>f===c?s[u]||s[s.length-1]:f)})},registerPanel:c=>{a.push(c),o.update(u=>u||c),Rt(()=>{const u=a.indexOf(c);a.splice(u,1),o.update(f=>f===c?a[u]||a[a.length-1]:f)})},selectTab:c=>{const u=s.indexOf(c);l.set(c),o.set(a[u])},selectedTab:l,selectedPanel:o}),i.$$set=c=>{"$$scope"in c&&t(0,r=c.$$scope)},[r,n]}class or extends he{constructor(e){super(),de(this,e,sl,rl,me,{})}}function il(i){let e,t;const n=i[1].default,r=He(n,i,i[0],null);return{c(){e=A("div"),r&&r.c(),this.h()},l(s){e=C(s,"DIV",{class:!0});var a=D(e);r&&r.l(a),a.forEach(p),this.h()},h(){L(e,"class","tab-list svelte-1c799zm")},m(s,a){N(s,e,a),r&&r.m(e,null),t=!0},p(s,[a]){r&&r.p&&(!t||a&1)&&xe(r,n,s,s[0],t?qe(n,s[0],a,null):je(s[0]),null)},i(s){t||(y(r,s),t=!0)},o(s){M(r,s),t=!1},d(s){s&&p(e),r&&r.d(s)}}}function al(i,e,t){let{$$slots:n={},$$scope:r}=e;return i.$$set=s=>{"$$scope"in s&&t(0,r=s.$$scope)},[r,n]}class cr extends he{constructor(e){super(),de(this,e,al,il,me,{})}}function In(i){let e;const t=i[4].default,n=He(t,i,i[3],null);return{c(){n&&n.c()},l(r){n&&n.l(r)},m(r,s){n&&n.m(r,s),e=!0},p(r,s){n&&n.p&&(!e||s&8)&&xe(n,t,r,r[3],e?qe(t,r[3],s,null):je(r[3]),null)},i(r){e||(y(n,r),e=!0)},o(r){M(n,r),e=!1},d(r){n&&n.d(r)}}}function ll(i){let e,t,n=i[0]===i[1]&&In(i);return{c(){n&&n.c(),e=re()},l(r){n&&n.l(r),e=re()},m(r,s){n&&n.m(r,s),N(r,e,s),t=!0},p(r,[s]){r[0]===r[1]?n?(n.p(r,s),s&1&&y(n,1)):(n=In(r),n.c(),y(n,1),n.m(e.parentNode,e)):n&&(oe(),M(n,1,1,()=>{n=null}),ce())},i(r){t||(y(n),t=!0)},o(r){M(n),t=!1},d(r){n&&n.d(r),r&&p(e)}}}function ol(i,e,t){let n,{$$slots:r={},$$scope:s}=e;const a={},{registerPanel:l,selectedPanel:o}=Yn(Ft);return se(i,o,c=>t(0,n=c)),l(a),i.$$set=c=>{"$$scope"in c&&t(3,s=c.$$scope)},[n,a,o,s,r]}class Ge extends he{constructor(e){super(),de(this,e,ol,ll,me,{})}}function cl(i){let e,t,n,r;const s=i[5].default,a=He(s,i,i[4],null);return{c(){e=A("button"),a&&a.c(),this.h()},l(l){e=C(l,"BUTTON",{class:!0});var o=D(e);a&&a.l(o),o.forEach(p),this.h()},h(){L(e,"class","svelte-1rryekj"),Vt(e,"selected",i[0]===i[1])},m(l,o){N(l,e,o),a&&a.m(e,null),t=!0,n||(r=be(e,"click",i[6]),n=!0)},p(l,[o]){a&&a.p&&(!t||o&16)&&xe(a,s,l,l[4],t?qe(s,l[4],o,null):je(l[4]),null),(!t||o&3)&&Vt(e,"selected",l[0]===l[1])},i(l){t||(y(a,l),t=!0)},o(l){M(a,l),t=!1},d(l){l&&p(e),a&&a.d(l),n=!1,r()}}}function fl(i,e,t){let n,{$$slots:r={},$$scope:s}=e;const a={},{registerTab:l,selectTab:o,selectedTab:c}=Yn(Ft);se(i,c,f=>t(0,n=f)),l(a);const u=()=>o(a);return i.$$set=f=>{"$$scope"in f&&t(4,s=f.$$scope)},[n,a,o,c,s,r,u]}class Fe extends he{constructor(e){super(),de(this,e,fl,cl,me,{})}}const ul=(i,e)=>{const t=document.createElement("input");t.type="file",t.id="uploadedConfig",t.addEventListener("change",n=>{const r=n.target.files;if(r&&r.length>0){const s=r[0],a=new FileReader;a.addEventListener("load",()=>{const l=JSON.parse(a.result),o=ba(i,l);if(o){alert(o);return}else fe.update(()=>va(i,l)),er(i,e)?alert("Imported configuration is identical to currently loaded configuration; no changes to upload."):alert("New configuration imported. Choose 'update controller' to import, or 'Cancel' to abort")}),a.readAsText(s)}}),t.click(),t.remove()},hl=i=>{const e="data:text/json;charset=utf-8,"+encodeURIComponent(ga(i)),t=document.createElement("a");t.href=e,t.download=`${Re(i.deviceId).name}_controller_config.json`,document.body.appendChild(t),t.click(),t.remove()};function Rn(i,e,t){const n=i.slice();return n[10]=e[t],n[12]=t,n}function An(i,e,t){const n=i.slice();return n[10]=e[t],n[12]=t,n}function dl(i){let e,t,n,r,s,a;return e=new Oe({props:{label:"Cancel",icon:"times",click:i[4]}}),n=new Oe({props:{label:"Import config",icon:"file-import",click:i[5]}}),s=new Oe({props:{label:"Update controller",icon:"download",click:i[6],disabled:!i[1]}}),{c(){W(e.$$.fragment),t=x(),W(n.$$.fragment),r=x(),W(s.$$.fragment)},l(l){J(e.$$.fragment,l),t=j(l),J(n.$$.fragment,l),r=j(l),J(s.$$.fragment,l)},m(l,o){K(e,l,o),N(l,t,o),K(n,l,o),N(l,r,o),K(s,l,o),a=!0},p(l,o){const c={};o&2&&(c.disabled=!l[1]),s.$set(c)},i(l){a||(y(e.$$.fragment,l),y(n.$$.fragment,l),y(s.$$.fragment,l),a=!0)},o(l){M(e.$$.fragment,l),M(n.$$.fragment,l),M(s.$$.fragment,l),a=!1},d(l){Z(e,l),l&&p(t),Z(n,l),l&&p(r),Z(s,l)}}}function ml(i){let e;return{c(){e=G("USB")},l(t){e=F(t,"USB")},m(t,n){N(t,e,n)},d(t){t&&p(e)}}}function pl(i){let e;return{c(){e=G("TRS Jack")},l(t){e=F(t,"TRS Jack")},m(t,n){N(t,e,n)},d(t){t&&p(e)}}}function El(i){let e;return{c(){e=G("Device Options")},l(t){e=F(t,"Device Options")},m(t,n){N(t,e,n)},d(t){t&&p(e)}}}function Cn(i){let e,t;return e=new Fe({props:{$$slots:{default:[_l]},$$scope:{ctx:i}}}),{c(){W(e.$$.fragment)},l(n){J(e.$$.fragment,n)},m(n,r){K(e,n,r),t=!0},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){M(e.$$.fragment,n),t=!1},d(n){Z(e,n)}}}function _l(i){let e;return{c(){e=G("Factory Reset")},l(t){e=F(t,"Factory Reset")},m(t,n){N(t,e,n)},d(t){t&&p(e)}}}function gl(i){let e,t,n,r,s,a,l=Me.gte(i[0].firmwareVersion,"2.1.0"),o,c;e=new Fe({props:{$$slots:{default:[ml]},$$scope:{ctx:i}}}),n=new Fe({props:{$$slots:{default:[pl]},$$scope:{ctx:i}}}),s=new Fe({props:{$$slots:{default:[El]},$$scope:{ctx:i}}});let u=l&&Cn(i);return{c(){W(e.$$.fragment),t=x(),W(n.$$.fragment),r=x(),W(s.$$.fragment),a=x(),u&&u.c(),o=re()},l(f){J(e.$$.fragment,f),t=j(f),J(n.$$.fragment,f),r=j(f),J(s.$$.fragment,f),a=j(f),u&&u.l(f),o=re()},m(f,d){K(e,f,d),N(f,t,d),K(n,f,d),N(f,r,d),K(s,f,d),N(f,a,d),u&&u.m(f,d),N(f,o,d),c=!0},p(f,d){const h={};d&16384&&(h.$$scope={dirty:d,ctx:f}),e.$set(h);const O={};d&16384&&(O.$$scope={dirty:d,ctx:f}),n.$set(O);const B={};d&16384&&(B.$$scope={dirty:d,ctx:f}),s.$set(B),d&1&&(l=Me.gte(f[0].firmwareVersion,"2.1.0")),l?u?d&1&&y(u,1):(u=Cn(f),u.c(),y(u,1),u.m(o.parentNode,o)):u&&(oe(),M(u,1,1,()=>{u=null}),ce())},i(f){c||(y(e.$$.fragment,f),y(n.$$.fragment,f),y(s.$$.fragment,f),y(u),c=!0)},o(f){M(e.$$.fragment,f),M(n.$$.fragment,f),M(s.$$.fragment,f),M(u),c=!1},d(f){Z(e,f),f&&p(t),Z(n,f),f&&p(r),Z(s,f),f&&p(a),u&&u.d(f),f&&p(o)}}}function Mn(i){let e,t;return e=new ar({props:{editControl:i[10],index:i[12]}}),{c(){W(e.$$.fragment)},l(n){J(e.$$.fragment,n)},m(n,r){K(e,n,r),t=!0},p(n,r){const s={};r&8&&(s.editControl=n[10]),e.$set(s)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){M(e.$$.fragment,n),t=!1},d(n){Z(e,n)}}}function Tn(i){let e,t,n=i[2]&&i[12]<i[2].controlCount&&Mn(i);return{c(){n&&n.c(),e=re()},l(r){n&&n.l(r),e=re()},m(r,s){n&&n.m(r,s),N(r,e,s),t=!0},p(r,s){r[2]&&r[12]<r[2].controlCount?n?(n.p(r,s),s&4&&y(n,1)):(n=Mn(r),n.c(),y(n,1),n.m(e.parentNode,e)):n&&(oe(),M(n,1,1,()=>{n=null}),ce())},i(r){t||(y(n),t=!0)},o(r){M(n),t=!1},d(r){n&&n.d(r),r&&p(e)}}}function bl(i){let e,t,n=i[3].usbControls,r=[];for(let a=0;a<n.length;a+=1)r[a]=Tn(An(i,n,a));const s=a=>M(r[a],1,1,()=>{r[a]=null});return{c(){e=A("div");for(let a=0;a<r.length;a+=1)r[a].c();this.h()},l(a){e=C(a,"DIV",{id:!0,class:!0});var l=D(e);for(let o=0;o<r.length;o+=1)r[o].l(l);l.forEach(p),this.h()},h(){L(e,"id","controls"),L(e,"class","svelte-13ul1lp")},m(a,l){N(a,e,l);for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(e,null);t=!0},p(a,l){if(l&12){n=a[3].usbControls;let o;for(o=0;o<n.length;o+=1){const c=An(a,n,o);r[o]?(r[o].p(c,l),y(r[o],1)):(r[o]=Tn(c),r[o].c(),y(r[o],1),r[o].m(e,null))}for(oe(),o=n.length;o<r.length;o+=1)s(o);ce()}},i(a){if(!t){for(let l=0;l<n.length;l+=1)y(r[l]);t=!0}},o(a){r=r.filter(Boolean);for(let l=0;l<r.length;l+=1)M(r[l]);t=!1},d(a){a&&p(e),Ke(r,a)}}}function On(i){let e,t;return e=new ar({props:{editControl:i[10],index:i[12]}}),{c(){W(e.$$.fragment)},l(n){J(e.$$.fragment,n)},m(n,r){K(e,n,r),t=!0},p(n,r){const s={};r&8&&(s.editControl=n[10]),e.$set(s)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){M(e.$$.fragment,n),t=!1},d(n){Z(e,n)}}}function Ln(i){let e,t,n=i[2]&&i[12]<i[2].controlCount&&On(i);return{c(){n&&n.c(),e=re()},l(r){n&&n.l(r),e=re()},m(r,s){n&&n.m(r,s),N(r,e,s),t=!0},p(r,s){r[2]&&r[12]<r[2].controlCount?n?(n.p(r,s),s&4&&y(n,1)):(n=On(r),n.c(),y(n,1),n.m(e.parentNode,e)):n&&(oe(),M(n,1,1,()=>{n=null}),ce())},i(r){t||(y(n),t=!0)},o(r){M(n),t=!1},d(r){n&&n.d(r),r&&p(e)}}}function vl(i){let e,t,n=i[3].trsControls,r=[];for(let a=0;a<n.length;a+=1)r[a]=Ln(Rn(i,n,a));const s=a=>M(r[a],1,1,()=>{r[a]=null});return{c(){e=A("div");for(let a=0;a<r.length;a+=1)r[a].c();this.h()},l(a){e=C(a,"DIV",{id:!0,class:!0});var l=D(e);for(let o=0;o<r.length;o+=1)r[o].l(l);l.forEach(p),this.h()},h(){L(e,"id","controls"),L(e,"class","svelte-13ul1lp")},m(a,l){N(a,e,l);for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(e,null);t=!0},p(a,l){if(l&12){n=a[3].trsControls;let o;for(o=0;o<n.length;o+=1){const c=Rn(a,n,o);r[o]?(r[o].p(c,l),y(r[o],1)):(r[o]=Ln(c),r[o].c(),y(r[o],1),r[o].m(e,null))}for(oe(),o=n.length;o<r.length;o+=1)s(o);ce()}},i(a){if(!t){for(let l=0;l<n.length;l+=1)y(r[l]);t=!0}},o(a){r=r.filter(Boolean);for(let l=0;l<r.length;l+=1)M(r[l]);t=!1},d(a){a&&p(e),Ke(r,a)}}}function $l(i){let e,t;return e=new Xa({}),{c(){W(e.$$.fragment)},l(n){J(e.$$.fragment,n)},m(n,r){K(e,n,r),t=!0},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){M(e.$$.fragment,n),t=!1},d(n){Z(e,n)}}}function Dn(i){let e,t;return e=new Ge({props:{$$slots:{default:[Nl]},$$scope:{ctx:i}}}),{c(){W(e.$$.fragment)},l(n){J(e.$$.fragment,n)},m(n,r){K(e,n,r),t=!0},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){M(e.$$.fragment,n),t=!1},d(n){Z(e,n)}}}function Nl(i){let e,t;return e=new el({}),e.$on("message",i[7]),{c(){W(e.$$.fragment)},l(n){J(e.$$.fragment,n)},m(n,r){K(e,n,r),t=!0},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){M(e.$$.fragment,n),t=!1},d(n){Z(e,n)}}}function yl(i){let e,t,n,r,s,a,l,o,c=Me.gte(i[0].firmwareVersion,"2.1.0"),u,f;e=new cr({props:{$$slots:{default:[gl]},$$scope:{ctx:i}}}),n=new Ge({props:{$$slots:{default:[bl]},$$scope:{ctx:i}}}),s=new Ge({props:{$$slots:{default:[vl]},$$scope:{ctx:i}}}),l=new Ge({props:{$$slots:{default:[$l]},$$scope:{ctx:i}}});let d=c&&Dn(i);return{c(){W(e.$$.fragment),t=x(),W(n.$$.fragment),r=x(),W(s.$$.fragment),a=x(),W(l.$$.fragment),o=x(),d&&d.c(),u=re()},l(h){J(e.$$.fragment,h),t=j(h),J(n.$$.fragment,h),r=j(h),J(s.$$.fragment,h),a=j(h),J(l.$$.fragment,h),o=j(h),d&&d.l(h),u=re()},m(h,O){K(e,h,O),N(h,t,O),K(n,h,O),N(h,r,O),K(s,h,O),N(h,a,O),K(l,h,O),N(h,o,O),d&&d.m(h,O),N(h,u,O),f=!0},p(h,O){const B={};O&16385&&(B.$$scope={dirty:O,ctx:h}),e.$set(B);const I={};O&16396&&(I.$$scope={dirty:O,ctx:h}),n.$set(I);const S={};O&16396&&(S.$$scope={dirty:O,ctx:h}),s.$set(S);const b={};O&16384&&(b.$$scope={dirty:O,ctx:h}),l.$set(b),O&1&&(c=Me.gte(h[0].firmwareVersion,"2.1.0")),c?d?O&1&&y(d,1):(d=Dn(h),d.c(),y(d,1),d.m(u.parentNode,u)):d&&(oe(),M(d,1,1,()=>{d=null}),ce())},i(h){f||(y(e.$$.fragment,h),y(n.$$.fragment,h),y(s.$$.fragment,h),y(l.$$.fragment,h),y(d),f=!0)},o(h){M(e.$$.fragment,h),M(n.$$.fragment,h),M(s.$$.fragment,h),M(l.$$.fragment,h),M(d),f=!1},d(h){Z(e,h),h&&p(t),Z(n,h),h&&p(r),Z(s,h),h&&p(a),Z(l,h),h&&p(o),d&&d.d(h),h&&p(u)}}}function Sl(i){let e,t,n,r;return e=new lr({props:{title:"Edit Configuration",$$slots:{default:[dl]},$$scope:{ctx:i}}}),n=new or({props:{$$slots:{default:[yl]},$$scope:{ctx:i}}}),{c(){W(e.$$.fragment),t=x(),W(n.$$.fragment)},l(s){J(e.$$.fragment,s),t=j(s),J(n.$$.fragment,s)},m(s,a){K(e,s,a),N(s,t,a),K(n,s,a),r=!0},p(s,[a]){const l={};a&16386&&(l.$$scope={dirty:a,ctx:s}),e.$set(l);const o={};a&16397&&(o.$$scope={dirty:a,ctx:s}),n.$set(o)},i(s){r||(y(e.$$.fragment,s),y(n.$$.fragment,s),r=!0)},o(s){M(e.$$.fragment,s),M(n.$$.fragment,s),r=!1},d(s){Z(e,s),s&&p(t),Z(n,s)}}}function wl(i,e,t){let n,r,s,a,l;se(i,_e,h=>t(0,r=h)),se(i,Ae,h=>t(8,s=h)),se(i,fe,h=>t(3,a=h)),se(i,Te,h=>t(9,l=h));let o=!1;fe.subscribe(h=>{h&&r&&t(1,o=!er(h,r))});const c=()=>{Be(Ae,s=!1,s)},u=()=>{a&&r&&ul(a,r)},f=()=>{Ze(a),Sa(a,l),Be(_e,r=a,r),Be(Ae,s=!1,s)};function d(h){qn.call(this,i,h)}return i.$$.update=()=>{i.$$.dirty&1&&t(2,n=r?Re(r.deviceId):null)},[r,o,n,a,c,u,f,d]}class Il extends he{constructor(e){super(),de(this,e,wl,Sl,me,{})}}function kn(i){let e,t,n,r,s,a,l=i[0].val!==void 0&&Pn(i);return{c(){e=A("dt"),t=G("Value"),n=A("dd"),r=A("div"),l&&l.c(),s=x(),a=A("div"),this.h()},l(o){e=C(o,"DT",{class:!0});var c=D(e);t=F(c,"Value"),c.forEach(p),n=C(o,"DD",{class:!0});var u=D(n);r=C(u,"DIV",{class:!0});var f=D(r);l&&l.l(f),s=j(f),a=C(f,"DIV",{class:!0,style:!0}),D(a).forEach(p),f.forEach(p),u.forEach(p),this.h()},h(){L(e,"class","svelte-5fijw0"),L(a,"class","bar svelte-5fijw0"),Ht(a,"height",i[0].val+"px"),L(r,"class","inner svelte-5fijw0"),L(n,"class","display svelte-5fijw0")},m(o,c){N(o,e,c),$(e,t),N(o,n,c),$(n,r),l&&l.m(r,null),$(r,s),$(r,a)},p(o,c){o[0].val!==void 0?l?l.p(o,c):(l=Pn(o),l.c(),l.m(r,s)):l&&(l.d(1),l=null),c&1&&Ht(a,"height",o[0].val+"px")},d(o){o&&p(e),o&&p(n),l&&l.d()}}}function Pn(i){let e,t=i[0].val+"",n,r;return{c(){e=A("span"),n=G(t),this.h()},l(s){e=C(s,"SPAN",{class:!0});var a=D(e);n=F(a,t),a.forEach(p),this.h()},h(){L(e,"class",r=xt(i[0].val<27?"lowvalue":"")+" svelte-5fijw0")},m(s,a){N(s,e,a),$(e,n)},p(s,a){a&1&&t!==(t=s[0].val+"")&&Ne(n,t),a&1&&r!==(r=xt(s[0].val<27?"lowvalue":"")+" svelte-5fijw0")&&L(e,"class",r)},d(s){s&&p(e)}}}function Rl(i){let e,t,n=i[1]+1+"",r,s,a,l,o=i[0].channel+"",c,u,f,d,h=i[0].cc+"",O,B=!i[2]&&kn(i);return{c(){e=A("dl"),t=A("dt"),r=G(n),s=A("dt"),a=G("Channel"),l=A("dd"),c=G(o),u=A("dt"),f=G("CC"),d=A("dd"),O=G(h),B&&B.c(),this.h()},l(I){e=C(I,"DL",{class:!0});var S=D(e);t=C(S,"DT",{class:!0});var b=D(t);r=F(b,n),b.forEach(p),s=C(S,"DT",{class:!0});var g=D(s);a=F(g,"Channel"),g.forEach(p),l=C(S,"DD",{class:!0});var m=D(l);c=F(m,o),m.forEach(p),u=C(S,"DT",{class:!0});var T=D(u);f=F(T,"CC"),T.forEach(p),d=C(S,"DD",{class:!0});var P=D(d);O=F(P,h),P.forEach(p),B&&B.l(S),S.forEach(p),this.h()},h(){L(t,"class","index svelte-5fijw0"),L(s,"class","svelte-5fijw0"),L(l,"class","svelte-5fijw0"),L(u,"class","svelte-5fijw0"),L(d,"class","svelte-5fijw0"),L(e,"class","config-column svelte-5fijw0")},m(I,S){N(I,e,S),$(e,t),$(t,r),$(e,s),$(s,a),$(e,l),$(l,c),$(e,u),$(u,f),$(e,d),$(d,O),B&&B.m(e,null)},p(I,[S]){S&2&&n!==(n=I[1]+1+"")&&Ne(r,n),S&1&&o!==(o=I[0].channel+"")&&Ne(c,o),S&1&&h!==(h=I[0].cc+"")&&Ne(O,h),I[2]?B&&(B.d(1),B=null):B?B.p(I,S):(B=kn(I),B.c(),B.m(e,null))},i:le,o:le,d(I){I&&p(e),B&&B.d()}}}function Al(i,e,t){let{control:n}=e,{index:r}=e,{disableValue:s=!1}=e;return i.$$set=a=>{"control"in a&&t(0,n=a.control),"index"in a&&t(1,r=a.index),"disableValue"in a&&t(2,s=a.disableValue)},[n,r,s]}class fr extends he{constructor(e){super(),de(this,e,Al,Rl,me,{control:0,index:1,disableValue:2})}}function Bn(i,e,t){const n=i.slice();return n[6]=e[t],n[8]=t,n}function Un(i,e,t){const n=i.slice();return n[6]=e[t],n[8]=t,n}function Cl(i){let e,t,n,r;return e=new Oe({props:{label:"Export current config",icon:"file-export",click:i[2]}}),n=new Oe({props:{label:"Edit Config",icon:"pencil-alt",click:i[3]}}),{c(){W(e.$$.fragment),t=x(),W(n.$$.fragment)},l(s){J(e.$$.fragment,s),t=j(s),J(n.$$.fragment,s)},m(s,a){K(e,s,a),N(s,t,a),K(n,s,a),r=!0},p:le,i(s){r||(y(e.$$.fragment,s),y(n.$$.fragment,s),r=!0)},o(s){M(e.$$.fragment,s),M(n.$$.fragment,s),r=!1},d(s){Z(e,s),s&&p(t),Z(n,s)}}}function Ml(i){let e;return{c(){e=G("USB")},l(t){e=F(t,"USB")},m(t,n){N(t,e,n)},d(t){t&&p(e)}}}function Tl(i){let e;return{c(){e=G("TRS Jack")},l(t){e=F(t,"TRS Jack")},m(t,n){N(t,e,n)},d(t){t&&p(e)}}}function Ol(i){let e,t,n,r;return e=new Fe({props:{$$slots:{default:[Ml]},$$scope:{ctx:i}}}),n=new Fe({props:{$$slots:{default:[Tl]},$$scope:{ctx:i}}}),{c(){W(e.$$.fragment),t=x(),W(n.$$.fragment)},l(s){J(e.$$.fragment,s),t=j(s),J(n.$$.fragment,s)},m(s,a){K(e,s,a),N(s,t,a),K(n,s,a),r=!0},p(s,a){const l={};a&1024&&(l.$$scope={dirty:a,ctx:s}),e.$set(l);const o={};a&1024&&(o.$$scope={dirty:a,ctx:s}),n.$set(o)},i(s){r||(y(e.$$.fragment,s),y(n.$$.fragment,s),r=!0)},o(s){M(e.$$.fragment,s),M(n.$$.fragment,s),r=!1},d(s){Z(e,s),s&&p(t),Z(n,s)}}}function Gn(i){let e,t;return e=new fr({props:{control:i[6],index:i[8]}}),{c(){W(e.$$.fragment)},l(n){J(e.$$.fragment,n)},m(n,r){K(e,n,r),t=!0},p(n,r){const s={};r&1&&(s.control=n[6]),e.$set(s)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){M(e.$$.fragment,n),t=!1},d(n){Z(e,n)}}}function Fn(i){let e,t,n=i[1]&&i[8]<i[1].controlCount&&Gn(i);return{c(){n&&n.c(),e=re()},l(r){n&&n.l(r),e=re()},m(r,s){n&&n.m(r,s),N(r,e,s),t=!0},p(r,s){r[1]&&r[8]<r[1].controlCount?n?(n.p(r,s),s&2&&y(n,1)):(n=Gn(r),n.c(),y(n,1),n.m(e.parentNode,e)):n&&(oe(),M(n,1,1,()=>{n=null}),ce())},i(r){t||(y(n),t=!0)},o(r){M(n),t=!1},d(r){n&&n.d(r),r&&p(e)}}}function Ll(i){let e,t,n=i[0].usbControls,r=[];for(let a=0;a<n.length;a+=1)r[a]=Fn(Un(i,n,a));const s=a=>M(r[a],1,1,()=>{r[a]=null});return{c(){e=A("div");for(let a=0;a<r.length;a+=1)r[a].c();this.h()},l(a){e=C(a,"DIV",{id:!0,class:!0});var l=D(e);for(let o=0;o<r.length;o+=1)r[o].l(l);l.forEach(p),this.h()},h(){L(e,"id","controls"),L(e,"class","svelte-13ul1lp")},m(a,l){N(a,e,l);for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(e,null);t=!0},p(a,l){if(l&3){n=a[0].usbControls;let o;for(o=0;o<n.length;o+=1){const c=Un(a,n,o);r[o]?(r[o].p(c,l),y(r[o],1)):(r[o]=Fn(c),r[o].c(),y(r[o],1),r[o].m(e,null))}for(oe(),o=n.length;o<r.length;o+=1)s(o);ce()}},i(a){if(!t){for(let l=0;l<n.length;l+=1)y(r[l]);t=!0}},o(a){r=r.filter(Boolean);for(let l=0;l<r.length;l+=1)M(r[l]);t=!1},d(a){a&&p(e),Ke(r,a)}}}function Vn(i){let e,t;return e=new fr({props:{control:i[6],index:i[8],disableValue:!0}}),{c(){W(e.$$.fragment)},l(n){J(e.$$.fragment,n)},m(n,r){K(e,n,r),t=!0},p(n,r){const s={};r&1&&(s.control=n[6]),e.$set(s)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){M(e.$$.fragment,n),t=!1},d(n){Z(e,n)}}}function Hn(i){let e,t,n=i[1]&&i[8]<i[1].controlCount&&Vn(i);return{c(){n&&n.c(),e=re()},l(r){n&&n.l(r),e=re()},m(r,s){n&&n.m(r,s),N(r,e,s),t=!0},p(r,s){r[1]&&r[8]<r[1].controlCount?n?(n.p(r,s),s&2&&y(n,1)):(n=Vn(r),n.c(),y(n,1),n.m(e.parentNode,e)):n&&(oe(),M(n,1,1,()=>{n=null}),ce())},i(r){t||(y(n),t=!0)},o(r){M(n),t=!1},d(r){n&&n.d(r),r&&p(e)}}}function Dl(i){let e,t,n,r,s,a=i[0].trsControls,l=[];for(let c=0;c<a.length;c+=1)l[c]=Hn(Bn(i,a,c));const o=c=>M(l[c],1,1,()=>{l[c]=null});return{c(){e=A("div");for(let c=0;c<l.length;c+=1)l[c].c();t=x(),n=A("p"),r=G("There is no realtime preview of the TRS outputs."),this.h()},l(c){e=C(c,"DIV",{id:!0,class:!0});var u=D(e);for(let d=0;d<l.length;d+=1)l[d].l(u);u.forEach(p),t=j(c),n=C(c,"P",{});var f=D(n);r=F(f,"There is no realtime preview of the TRS outputs."),f.forEach(p),this.h()},h(){L(e,"id","controls"),L(e,"class","svelte-13ul1lp")},m(c,u){N(c,e,u);for(let f=0;f<l.length;f+=1)l[f]&&l[f].m(e,null);N(c,t,u),N(c,n,u),$(n,r),s=!0},p(c,u){if(u&3){a=c[0].trsControls;let f;for(f=0;f<a.length;f+=1){const d=Bn(c,a,f);l[f]?(l[f].p(d,u),y(l[f],1)):(l[f]=Hn(d),l[f].c(),y(l[f],1),l[f].m(e,null))}for(oe(),f=a.length;f<l.length;f+=1)o(f);ce()}},i(c){if(!s){for(let u=0;u<a.length;u+=1)y(l[u]);s=!0}},o(c){l=l.filter(Boolean);for(let u=0;u<l.length;u+=1)M(l[u]);s=!1},d(c){c&&p(e),Ke(l,c),c&&p(t),c&&p(n)}}}function kl(i){let e,t,n,r,s,a;return e=new cr({props:{$$slots:{default:[Ol]},$$scope:{ctx:i}}}),n=new Ge({props:{$$slots:{default:[Ll]},$$scope:{ctx:i}}}),s=new Ge({props:{$$slots:{default:[Dl]},$$scope:{ctx:i}}}),{c(){W(e.$$.fragment),t=x(),W(n.$$.fragment),r=x(),W(s.$$.fragment)},l(l){J(e.$$.fragment,l),t=j(l),J(n.$$.fragment,l),r=j(l),J(s.$$.fragment,l)},m(l,o){K(e,l,o),N(l,t,o),K(n,l,o),N(l,r,o),K(s,l,o),a=!0},p(l,o){const c={};o&1024&&(c.$$scope={dirty:o,ctx:l}),e.$set(c);const u={};o&1027&&(u.$$scope={dirty:o,ctx:l}),n.$set(u);const f={};o&1027&&(f.$$scope={dirty:o,ctx:l}),s.$set(f)},i(l){a||(y(e.$$.fragment,l),y(n.$$.fragment,l),y(s.$$.fragment,l),a=!0)},o(l){M(e.$$.fragment,l),M(n.$$.fragment,l),M(s.$$.fragment,l),a=!1},d(l){Z(e,l),l&&p(t),Z(n,l),l&&p(r),Z(s,l)}}}function Pl(i){let e,t,n,r;return e=new lr({props:{title:"Current Configuration",$$slots:{default:[Cl]},$$scope:{ctx:i}}}),n=new or({props:{$$slots:{default:[kl]},$$scope:{ctx:i}}}),{c(){W(e.$$.fragment),t=x(),W(n.$$.fragment)},l(s){J(e.$$.fragment,s),t=j(s),J(n.$$.fragment,s)},m(s,a){K(e,s,a),N(s,t,a),K(n,s,a),r=!0},p(s,[a]){const l={};a&1024&&(l.$$scope={dirty:a,ctx:s}),e.$set(l);const o={};a&1027&&(o.$$scope={dirty:a,ctx:s}),n.$set(o)},i(s){r||(y(e.$$.fragment,s),y(n.$$.fragment,s),r=!0)},o(s){M(e.$$.fragment,s),M(n.$$.fragment,s),r=!1},d(s){Z(e,s),s&&p(t),Z(n,s)}}}function Bl(i,e,t){let n,r,s,a;se(i,_e,c=>t(0,r=c)),se(i,fe,c=>t(4,s=c)),se(i,Ae,c=>t(5,a=c));const l=()=>{r&&hl(r)},o=()=>{Be(Ae,a=!0,a),r&&Be(fe,s=structuredClone(r),s)};return i.$$.update=()=>{i.$$.dirty&1&&t(1,n=r?Re(r.deviceId):null)},[r,n,l,o]}class Ul extends he{constructor(e){super(),de(this,e,Bl,Pl,me,{})}}function Gl(i){let e,t;return{c(){e=A("p"),t=G(`WebMIDI could not be enabled. Please use a web browser that supports
        WebMIDI, such as Google Chrome.`),this.h()},l(n){e=C(n,"P",{class:!0});var r=D(e);t=F(r,`WebMIDI could not be enabled. Please use a web browser that supports
        WebMIDI, such as Google Chrome.`),r.forEach(p),this.h()},h(){L(e,"class","notice svelte-kpoxps")},m(n,r){N(n,e,r),$(e,t)},p:le,i:le,o:le,d(n){n&&p(e)}}}function Fl(i){let e,t,n,r;const s=[Hl,Vl],a=[];function l(o,c){return o[1]?0:1}return e=l(i),t=a[e]=s[e](i),{c(){t.c(),n=re()},l(o){t.l(o),n=re()},m(o,c){a[e].m(o,c),N(o,n,c),r=!0},p(o,c){let u=e;e=l(o),e===u?a[e].p(o,c):(oe(),M(a[u],1,1,()=>{a[u]=null}),ce(),t=a[e],t?t.p(o,c):(t=a[e]=s[e](o),t.c()),y(t,1),t.m(n.parentNode,n))},i(o){r||(y(t),r=!0)},o(o){M(t),r=!1},d(o){a[e].d(o),o&&p(n)}}}function Vl(i){let e,t;return{c(){e=A("p"),t=G("Connect a controller via USB."),this.h()},l(n){e=C(n,"P",{class:!0});var r=D(e);t=F(r,"Connect a controller via USB."),r.forEach(p),this.h()},h(){L(e,"class","notice svelte-kpoxps")},m(n,r){N(n,e,r),$(e,t)},p:le,i:le,o:le,d(n){n&&p(e)}}}function Hl(i){let e,t,n,r,s;const a=[jl,xl],l=[];function o(c,u){return u&6&&(e=null),e==null&&(e=!!(c[2]&&Me.gte(c[1].firmwareVersion,"2.1.0"))),e?0:1}return t=o(i,-1),n=l[t]=a[t](i),{c(){n.c(),r=re()},l(c){n.l(c),r=re()},m(c,u){l[t].m(c,u),N(c,r,u),s=!0},p(c,u){let f=t;t=o(c,u),t===f?l[t].p(c,u):(oe(),M(l[f],1,1,()=>{l[f]=null}),ce(),n=l[t],n?n.p(c,u):(n=l[t]=a[t](c),n.c()),y(n,1),n.m(r.parentNode,r))},i(c){s||(y(n),s=!0)},o(c){M(n),s=!1},d(c){l[t].d(c),c&&p(r)}}}function xl(i){let e,t,n,r,s;const a=[Yl,ql],l=[];function o(c,u){return c[3]?0:1}return e=o(i),t=l[e]=a[e](i),{c(){t.c(),n=x(),r=A("p")},l(c){t.l(c),n=j(c),r=C(c,"P",{}),D(r).forEach(p)},m(c,u){l[e].m(c,u),N(c,n,u),N(c,r,u),s=!0},p(c,u){let f=e;e=o(c),e!==f&&(oe(),M(l[f],1,1,()=>{l[f]=null}),ce(),t=l[e],t||(t=l[e]=a[e](c),t.c()),y(t,1),t.m(n.parentNode,n))},i(c){s||(y(t),s=!0)},o(c){M(t),s=!1},d(c){l[e].d(c),c&&p(n),c&&p(r)}}}function jl(i){let e,t,n,r,s,a,l;return a=new Oe({props:{label:"Click to reset your 16n's EEPROM to factory defaults",click:i[5]}}),{c(){e=A("div"),t=A("p"),n=G(`It looks like a 16n is trying to connect, but may have a corrupt
              memory.`),r=x(),s=A("p"),W(a.$$.fragment),this.h()},l(o){e=C(o,"DIV",{class:!0});var c=D(e);t=C(c,"P",{});var u=D(t);n=F(u,`It looks like a 16n is trying to connect, but may have a corrupt
              memory.`),u.forEach(p),r=j(c),s=C(c,"P",{});var f=D(s);J(a.$$.fragment,f),f.forEach(p),c.forEach(p),this.h()},h(){L(e,"class","notice svelte-kpoxps")},m(o,c){N(o,e,c),$(e,t),$(t,n),$(e,r),$(e,s),K(a,s,null),l=!0},p:le,i(o){l||(y(a.$$.fragment,o),l=!0)},o(o){M(a.$$.fragment,o),l=!1},d(o){o&&p(e),Z(a)}}}function ql(i){let e,t;return e=new Ul({}),{c(){W(e.$$.fragment)},l(n){J(e.$$.fragment,n)},m(n,r){K(e,n,r),t=!0},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){M(e.$$.fragment,n),t=!1},d(n){Z(e,n)}}}function Yl(i){let e,t;return e=new Il({}),{c(){W(e.$$.fragment)},l(n){J(e.$$.fragment,n)},m(n,r){K(e,n,r),t=!0},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){M(e.$$.fragment,n),t=!1},d(n){Z(e,n)}}}function zl(i){let e,t,n,r,s,a,l,o,c,u,f,d,h,O,B,I;a=new Ga({});const S=[Fl,Gl],b=[];function g(m,T){return m[0]?0:1}return c=g(i),u=b[c]=S[c](i),{c(){e=A("main"),t=A("div"),n=A("h1"),r=G("16n configuration tool"),s=x(),W(a.$$.fragment),l=x(),o=A("div"),u.c(),f=x(),d=A("div"),h=A("div"),O=G("16n Editor v"),B=G(i[4]),this.h()},l(m){e=C(m,"MAIN",{class:!0});var T=D(e);t=C(T,"DIV",{id:!0,class:!0});var P=D(t);n=C(P,"H1",{class:!0});var Y=D(n);r=F(Y,"16n configuration tool"),Y.forEach(p),s=j(P),J(a.$$.fragment,P),P.forEach(p),l=j(T),o=C(T,"DIV",{id:!0,class:!0});var ee=D(o);u.l(ee),ee.forEach(p),f=j(T),d=C(T,"DIV",{id:!0,class:!0});var te=D(d);h=C(te,"DIV",{class:!0});var ae=D(h);O=F(ae,"16n Editor v"),B=F(ae,i[4]),ae.forEach(p),te.forEach(p),T.forEach(p),this.h()},h(){L(n,"class","svelte-kpoxps"),L(t,"id","head"),L(t,"class","svelte-kpoxps"),L(o,"id","inner"),L(o,"class","svelte-kpoxps"),L(h,"class","foot-left svelte-kpoxps"),L(d,"id","foot"),L(d,"class","svelte-kpoxps"),L(e,"class","svelte-kpoxps")},m(m,T){N(m,e,T),$(e,t),$(t,n),$(n,r),$(t,s),K(a,t,null),$(e,l),$(e,o),b[c].m(o,null),$(e,f),$(e,d),$(d,h),$(h,O),$(h,B),I=!0},p(m,[T]){let P=c;c=g(m),c===P?b[c].p(m,T):(oe(),M(b[P],1,1,()=>{b[P]=null}),ce(),u=b[c],u?u.p(m,T):(u=b[c]=S[c](m),u.c()),y(u,1),u.m(o,null))},i(m){I||(y(a.$$.fragment,m),y(u),I=!0)},o(m){M(a.$$.fragment,m),M(u),I=!1},d(m){m&&p(e),Z(a),b[c].d()}}}function Xl(i,e,t){let n,r,s,a,l;se(i,Te,f=>t(6,n=f)),se(i,Ut,f=>t(0,r=f)),se(i,_e,f=>t(1,s=f)),se(i,ft,f=>t(2,a=f)),se(i,Ae,f=>t(3,l=f));const o="2.0.5",c=!!navigator.requestMIDIAccess;return dr(()=>{c&&w.enable({sysex:!0}).then(Ra).catch(f=>alert(f))}),[r,s,a,l,o,()=>{n&&nr(n)}]}class Zl extends he{constructor(e){super(),de(this,e,Xl,zl,me,{})}}export{Zl as default};
