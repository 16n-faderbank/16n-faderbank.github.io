import{K as ve,S as he,i as de,s as me,k as C,l as M,m as D,h as p,n as L,b as N,I as le,a as x,q as G,c as j,r as F,H as $,L as be,g as y,v as oe,d as T,f as ce,u as Ne,y as W,z as J,A as K,B as Q,M as dr,e as re,J as se,N as Rt,C as Ve,E as He,F as xe,G as je,w as it,O as at,P as lt,Q as De,R as Fe,T as Mt,U as jn,V as ot,W as qn,X as Je,Y as Pe,Z as Yn,_ as mr,$ as zn,a0 as Ht,p as xt,a1 as jt,o as pr}from"../chunks/index.7915f913.js";import{w as Se}from"../chunks/index.f54aeccc.js";var At={exports:{}};const Er="2.0.0",Xn=256,_r=Number.MAX_SAFE_INTEGER||9007199254740991,gr=16,br=Xn-6,vr=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var ht={MAX_LENGTH:Xn,MAX_SAFE_COMPONENT_LENGTH:gr,MAX_SAFE_BUILD_LENGTH:br,MAX_SAFE_INTEGER:_r,RELEASE_TYPES:vr,SEMVER_SPEC_VERSION:Er,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2};const $r=typeof process=="object"&&process.env&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?(...i)=>console.error("SEMVER",...i):()=>{};var dt=$r;(function(i,e){const{MAX_SAFE_COMPONENT_LENGTH:t,MAX_SAFE_BUILD_LENGTH:n,MAX_LENGTH:r}=ht,s=dt;e=i.exports={};const a=e.re=[],l=e.safeRe=[],o=e.src=[],c=e.t={};let u=0;const f="[a-zA-Z0-9-]",m=[["\\s",1],["\\d",r],[f,n]],h=P=>{for(const[w,I]of m)P=P.split(`${w}*`).join(`${w}{0,${I}}`).split(`${w}+`).join(`${w}{1,${I}}`);return P},g=(P,w,I)=>{const v=h(w),_=u++;s(P,_,w),c[P]=_,o[_]=w,a[_]=new RegExp(w,I?"g":void 0),l[_]=new RegExp(v,I?"g":void 0)};g("NUMERICIDENTIFIER","0|[1-9]\\d*"),g("NUMERICIDENTIFIERLOOSE","\\d+"),g("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${f}*`),g("MAINVERSION",`(${o[c.NUMERICIDENTIFIER]})\\.(${o[c.NUMERICIDENTIFIER]})\\.(${o[c.NUMERICIDENTIFIER]})`),g("MAINVERSIONLOOSE",`(${o[c.NUMERICIDENTIFIERLOOSE]})\\.(${o[c.NUMERICIDENTIFIERLOOSE]})\\.(${o[c.NUMERICIDENTIFIERLOOSE]})`),g("PRERELEASEIDENTIFIER",`(?:${o[c.NUMERICIDENTIFIER]}|${o[c.NONNUMERICIDENTIFIER]})`),g("PRERELEASEIDENTIFIERLOOSE",`(?:${o[c.NUMERICIDENTIFIERLOOSE]}|${o[c.NONNUMERICIDENTIFIER]})`),g("PRERELEASE",`(?:-(${o[c.PRERELEASEIDENTIFIER]}(?:\\.${o[c.PRERELEASEIDENTIFIER]})*))`),g("PRERELEASELOOSE",`(?:-?(${o[c.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${o[c.PRERELEASEIDENTIFIERLOOSE]})*))`),g("BUILDIDENTIFIER",`${f}+`),g("BUILD",`(?:\\+(${o[c.BUILDIDENTIFIER]}(?:\\.${o[c.BUILDIDENTIFIER]})*))`),g("FULLPLAIN",`v?${o[c.MAINVERSION]}${o[c.PRERELEASE]}?${o[c.BUILD]}?`),g("FULL",`^${o[c.FULLPLAIN]}$`),g("LOOSEPLAIN",`[v=\\s]*${o[c.MAINVERSIONLOOSE]}${o[c.PRERELEASELOOSE]}?${o[c.BUILD]}?`),g("LOOSE",`^${o[c.LOOSEPLAIN]}$`),g("GTLT","((?:<|>)?=?)"),g("XRANGEIDENTIFIERLOOSE",`${o[c.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),g("XRANGEIDENTIFIER",`${o[c.NUMERICIDENTIFIER]}|x|X|\\*`),g("XRANGEPLAIN",`[v=\\s]*(${o[c.XRANGEIDENTIFIER]})(?:\\.(${o[c.XRANGEIDENTIFIER]})(?:\\.(${o[c.XRANGEIDENTIFIER]})(?:${o[c.PRERELEASE]})?${o[c.BUILD]}?)?)?`),g("XRANGEPLAINLOOSE",`[v=\\s]*(${o[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[c.XRANGEIDENTIFIERLOOSE]})(?:${o[c.PRERELEASELOOSE]})?${o[c.BUILD]}?)?)?`),g("XRANGE",`^${o[c.GTLT]}\\s*${o[c.XRANGEPLAIN]}$`),g("XRANGELOOSE",`^${o[c.GTLT]}\\s*${o[c.XRANGEPLAINLOOSE]}$`),g("COERCE",`(^|[^\\d])(\\d{1,${t}})(?:\\.(\\d{1,${t}}))?(?:\\.(\\d{1,${t}}))?(?:$|[^\\d])`),g("COERCERTL",o[c.COERCE],!0),g("LONETILDE","(?:~>?)"),g("TILDETRIM",`(\\s*)${o[c.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",g("TILDE",`^${o[c.LONETILDE]}${o[c.XRANGEPLAIN]}$`),g("TILDELOOSE",`^${o[c.LONETILDE]}${o[c.XRANGEPLAINLOOSE]}$`),g("LONECARET","(?:\\^)"),g("CARETTRIM",`(\\s*)${o[c.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",g("CARET",`^${o[c.LONECARET]}${o[c.XRANGEPLAIN]}$`),g("CARETLOOSE",`^${o[c.LONECARET]}${o[c.XRANGEPLAINLOOSE]}$`),g("COMPARATORLOOSE",`^${o[c.GTLT]}\\s*(${o[c.LOOSEPLAIN]})$|^$`),g("COMPARATOR",`^${o[c.GTLT]}\\s*(${o[c.FULLPLAIN]})$|^$`),g("COMPARATORTRIM",`(\\s*)${o[c.GTLT]}\\s*(${o[c.LOOSEPLAIN]}|${o[c.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",g("HYPHENRANGE",`^\\s*(${o[c.XRANGEPLAIN]})\\s+-\\s+(${o[c.XRANGEPLAIN]})\\s*$`),g("HYPHENRANGELOOSE",`^\\s*(${o[c.XRANGEPLAINLOOSE]})\\s+-\\s+(${o[c.XRANGEPLAINLOOSE]})\\s*$`),g("STAR","(<|>)?=?\\s*\\*"),g("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),g("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(At,At.exports);var Ke=At.exports;const Nr=Object.freeze({loose:!0}),Sr=Object.freeze({}),yr=i=>i?typeof i!="object"?Nr:i:Sr;var Tt=yr;const qt=/^[0-9]+$/,Wn=(i,e)=>{const t=qt.test(i),n=qt.test(e);return t&&n&&(i=+i,e=+e),i===e?0:t&&!n?-1:n&&!t?1:i<e?-1:1},wr=(i,e)=>Wn(e,i);var Jn={compareIdentifiers:Wn,rcompareIdentifiers:wr};const Ze=dt,{MAX_LENGTH:Yt,MAX_SAFE_INTEGER:et}=ht,{safeRe:zt,t:Xt}=Ke,Ir=Tt,{compareIdentifiers:Oe}=Jn;let Rr=class Ie{constructor(e,t){if(t=Ir(t),e instanceof Ie){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>Yt)throw new TypeError(`version is longer than ${Yt} characters`);Ze("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?zt[Xt.LOOSE]:zt[Xt.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>et||this.major<0)throw new TypeError("Invalid major version");if(this.minor>et||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>et||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(r=>{if(/^[0-9]+$/.test(r)){const s=+r;if(s>=0&&s<et)return s}return r}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(Ze("SemVer.compare",this.version,this.options,e),!(e instanceof Ie)){if(typeof e=="string"&&e===this.version)return 0;e=new Ie(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof Ie||(e=new Ie(e,this.options)),Oe(this.major,e.major)||Oe(this.minor,e.minor)||Oe(this.patch,e.patch)}comparePre(e){if(e instanceof Ie||(e=new Ie(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],r=e.prerelease[t];if(Ze("prerelease compare",t,n,r),n===void 0&&r===void 0)return 0;if(r===void 0)return 1;if(n===void 0)return-1;if(n===r)continue;return Oe(n,r)}while(++t)}compareBuild(e){e instanceof Ie||(e=new Ie(e,this.options));let t=0;do{const n=this.build[t],r=e.build[t];if(Ze("prerelease compare",t,n,r),n===void 0&&r===void 0)return 0;if(r===void 0)return 1;if(n===void 0)return-1;if(n===r)continue;return Oe(n,r)}while(++t)}inc(e,t,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const r=Number(n)?1:0;if(!t&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[r];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);if(s===-1){if(t===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(r)}}if(t){let s=[t,r];n===!1&&(s=[t]),Oe(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var ge=Rr;const Wt=ge,Ar=(i,e,t=!1)=>{if(i instanceof Wt)return i;try{return new Wt(i,e)}catch(n){if(!t)return null;throw n}};var qe=Ar;const Cr=qe,Mr=(i,e)=>{const t=Cr(i,e);return t?t.version:null};var Tr=Mr;const Or=qe,Lr=(i,e)=>{const t=Or(i.trim().replace(/^[=v]+/,""),e);return t?t.version:null};var Dr=Lr;const Jt=ge,kr=(i,e,t,n,r)=>{typeof t=="string"&&(r=n,n=t,t=void 0);try{return new Jt(i instanceof Jt?i.version:i,t).inc(e,n,r).version}catch{return null}};var Pr=kr;const Kt=qe,Br=(i,e)=>{const t=Kt(i,null,!0),n=Kt(e,null,!0),r=t.compare(n);if(r===0)return null;const s=r>0,a=s?t:n,l=s?n:t,o=!!a.prerelease.length;if(!!l.prerelease.length&&!o)return!l.patch&&!l.minor?"major":a.patch?"patch":a.minor?"minor":"major";const u=o?"pre":"";return t.major!==n.major?u+"major":t.minor!==n.minor?u+"minor":t.patch!==n.patch?u+"patch":"prerelease"};var Ur=Br;const Gr=ge,Fr=(i,e)=>new Gr(i,e).major;var Vr=Fr;const Hr=ge,xr=(i,e)=>new Hr(i,e).minor;var jr=xr;const qr=ge,Yr=(i,e)=>new qr(i,e).patch;var zr=Yr;const Xr=qe,Wr=(i,e)=>{const t=Xr(i,e);return t&&t.prerelease.length?t.prerelease:null};var Jr=Wr;const Qt=ge,Kr=(i,e,t)=>new Qt(i,t).compare(new Qt(e,t));var ye=Kr;const Qr=ye,Zr=(i,e,t)=>Qr(e,i,t);var es=Zr;const ts=ye,ns=(i,e)=>ts(i,e,!0);var rs=ns;const Zt=ge,ss=(i,e,t)=>{const n=new Zt(i,t),r=new Zt(e,t);return n.compare(r)||n.compareBuild(r)};var Ot=ss;const is=Ot,as=(i,e)=>i.sort((t,n)=>is(t,n,e));var ls=as;const os=Ot,cs=(i,e)=>i.sort((t,n)=>os(n,t,e));var fs=cs;const us=ye,hs=(i,e,t)=>us(i,e,t)>0;var mt=hs;const ds=ye,ms=(i,e,t)=>ds(i,e,t)<0;var Lt=ms;const ps=ye,Es=(i,e,t)=>ps(i,e,t)===0;var Kn=Es;const _s=ye,gs=(i,e,t)=>_s(i,e,t)!==0;var Qn=gs;const bs=ye,vs=(i,e,t)=>bs(i,e,t)>=0;var Dt=vs;const $s=ye,Ns=(i,e,t)=>$s(i,e,t)<=0;var kt=Ns;const Ss=Kn,ys=Qn,ws=mt,Is=Dt,Rs=Lt,As=kt,Cs=(i,e,t,n)=>{switch(e){case"===":return typeof i=="object"&&(i=i.version),typeof t=="object"&&(t=t.version),i===t;case"!==":return typeof i=="object"&&(i=i.version),typeof t=="object"&&(t=t.version),i!==t;case"":case"=":case"==":return Ss(i,t,n);case"!=":return ys(i,t,n);case">":return ws(i,t,n);case">=":return Is(i,t,n);case"<":return Rs(i,t,n);case"<=":return As(i,t,n);default:throw new TypeError(`Invalid operator: ${e}`)}};var Zn=Cs;const Ms=ge,Ts=qe,{safeRe:tt,t:nt}=Ke,Os=(i,e)=>{if(i instanceof Ms)return i;if(typeof i=="number"&&(i=String(i)),typeof i!="string")return null;e=e||{};let t=null;if(!e.rtl)t=i.match(tt[nt.COERCE]);else{let n;for(;(n=tt[nt.COERCERTL].exec(i))&&(!t||t.index+t[0].length!==i.length);)(!t||n.index+n[0].length!==t.index+t[0].length)&&(t=n),tt[nt.COERCERTL].lastIndex=n.index+n[1].length+n[2].length;tt[nt.COERCERTL].lastIndex=-1}return t===null?null:Ts(`${t[2]}.${t[3]||"0"}.${t[4]||"0"}`,e)};var Ls=Os,_t,en;function Ds(){return en||(en=1,_t=function(i){i.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}),_t}var gt,tn;function ks(){if(tn)return gt;tn=1,gt=i,i.Node=r,i.create=i;function i(s){var a=this;if(a instanceof i||(a=new i),a.tail=null,a.head=null,a.length=0,s&&typeof s.forEach=="function")s.forEach(function(c){a.push(c)});else if(arguments.length>0)for(var l=0,o=arguments.length;l<o;l++)a.push(arguments[l]);return a}i.prototype.removeNode=function(s){if(s.list!==this)throw new Error("removing node which does not belong to this list");var a=s.next,l=s.prev;return a&&(a.prev=l),l&&(l.next=a),s===this.head&&(this.head=a),s===this.tail&&(this.tail=l),s.list.length--,s.next=null,s.prev=null,s.list=null,a},i.prototype.unshiftNode=function(s){if(s!==this.head){s.list&&s.list.removeNode(s);var a=this.head;s.list=this,s.next=a,a&&(a.prev=s),this.head=s,this.tail||(this.tail=s),this.length++}},i.prototype.pushNode=function(s){if(s!==this.tail){s.list&&s.list.removeNode(s);var a=this.tail;s.list=this,s.prev=a,a&&(a.next=s),this.tail=s,this.head||(this.head=s),this.length++}},i.prototype.push=function(){for(var s=0,a=arguments.length;s<a;s++)t(this,arguments[s]);return this.length},i.prototype.unshift=function(){for(var s=0,a=arguments.length;s<a;s++)n(this,arguments[s]);return this.length},i.prototype.pop=function(){if(this.tail){var s=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,s}},i.prototype.shift=function(){if(this.head){var s=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,s}},i.prototype.forEach=function(s,a){a=a||this;for(var l=this.head,o=0;l!==null;o++)s.call(a,l.value,o,this),l=l.next},i.prototype.forEachReverse=function(s,a){a=a||this;for(var l=this.tail,o=this.length-1;l!==null;o--)s.call(a,l.value,o,this),l=l.prev},i.prototype.get=function(s){for(var a=0,l=this.head;l!==null&&a<s;a++)l=l.next;if(a===s&&l!==null)return l.value},i.prototype.getReverse=function(s){for(var a=0,l=this.tail;l!==null&&a<s;a++)l=l.prev;if(a===s&&l!==null)return l.value},i.prototype.map=function(s,a){a=a||this;for(var l=new i,o=this.head;o!==null;)l.push(s.call(a,o.value,this)),o=o.next;return l},i.prototype.mapReverse=function(s,a){a=a||this;for(var l=new i,o=this.tail;o!==null;)l.push(s.call(a,o.value,this)),o=o.prev;return l},i.prototype.reduce=function(s,a){var l,o=this.head;if(arguments.length>1)l=a;else if(this.head)o=this.head.next,l=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var c=0;o!==null;c++)l=s(l,o.value,c),o=o.next;return l},i.prototype.reduceReverse=function(s,a){var l,o=this.tail;if(arguments.length>1)l=a;else if(this.tail)o=this.tail.prev,l=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var c=this.length-1;o!==null;c--)l=s(l,o.value,c),o=o.prev;return l},i.prototype.toArray=function(){for(var s=new Array(this.length),a=0,l=this.head;l!==null;a++)s[a]=l.value,l=l.next;return s},i.prototype.toArrayReverse=function(){for(var s=new Array(this.length),a=0,l=this.tail;l!==null;a++)s[a]=l.value,l=l.prev;return s},i.prototype.slice=function(s,a){a=a||this.length,a<0&&(a+=this.length),s=s||0,s<0&&(s+=this.length);var l=new i;if(a<s||a<0)return l;s<0&&(s=0),a>this.length&&(a=this.length);for(var o=0,c=this.head;c!==null&&o<s;o++)c=c.next;for(;c!==null&&o<a;o++,c=c.next)l.push(c.value);return l},i.prototype.sliceReverse=function(s,a){a=a||this.length,a<0&&(a+=this.length),s=s||0,s<0&&(s+=this.length);var l=new i;if(a<s||a<0)return l;s<0&&(s=0),a>this.length&&(a=this.length);for(var o=this.length,c=this.tail;c!==null&&o>a;o--)c=c.prev;for(;c!==null&&o>s;o--,c=c.prev)l.push(c.value);return l},i.prototype.splice=function(s,a,...l){s>this.length&&(s=this.length-1),s<0&&(s=this.length+s);for(var o=0,c=this.head;c!==null&&o<s;o++)c=c.next;for(var u=[],o=0;c&&o<a;o++)u.push(c.value),c=this.removeNode(c);c===null&&(c=this.tail),c!==this.head&&c!==this.tail&&(c=c.prev);for(var o=0;o<l.length;o++)c=e(this,c,l[o]);return u},i.prototype.reverse=function(){for(var s=this.head,a=this.tail,l=s;l!==null;l=l.prev){var o=l.prev;l.prev=l.next,l.next=o}return this.head=a,this.tail=s,this};function e(s,a,l){var o=a===s.head?new r(l,null,a,s):new r(l,a,a.next,s);return o.next===null&&(s.tail=o),o.prev===null&&(s.head=o),s.length++,o}function t(s,a){s.tail=new r(a,s.tail,null,s),s.head||(s.head=s.tail),s.length++}function n(s,a){s.head=new r(a,null,s.head,s),s.tail||(s.tail=s.head),s.length++}function r(s,a,l,o){if(!(this instanceof r))return new r(s,a,l,o);this.list=o,this.value=s,a?(a.next=this,this.prev=a):this.prev=null,l?(l.prev=this,this.next=l):this.next=null}try{Ds()(i)}catch{}return gt}var bt,nn;function Ps(){if(nn)return bt;nn=1;const i=ks(),e=Symbol("max"),t=Symbol("length"),n=Symbol("lengthCalculator"),r=Symbol("allowStale"),s=Symbol("maxAge"),a=Symbol("dispose"),l=Symbol("noDisposeOnSet"),o=Symbol("lruList"),c=Symbol("cache"),u=Symbol("updateAgeOnGet"),f=()=>1;class m{constructor(d){if(typeof d=="number"&&(d={max:d}),d||(d={}),d.max&&(typeof d.max!="number"||d.max<0))throw new TypeError("max must be a non-negative number");this[e]=d.max||1/0;const O=d.length||f;if(this[n]=typeof O!="function"?f:O,this[r]=d.stale||!1,d.maxAge&&typeof d.maxAge!="number")throw new TypeError("maxAge must be a number");this[s]=d.maxAge||0,this[a]=d.dispose,this[l]=d.noDisposeOnSet||!1,this[u]=d.updateAgeOnGet||!1,this.reset()}set max(d){if(typeof d!="number"||d<0)throw new TypeError("max must be a non-negative number");this[e]=d||1/0,P(this)}get max(){return this[e]}set allowStale(d){this[r]=!!d}get allowStale(){return this[r]}set maxAge(d){if(typeof d!="number")throw new TypeError("maxAge must be a non-negative number");this[s]=d,P(this)}get maxAge(){return this[s]}set lengthCalculator(d){typeof d!="function"&&(d=f),d!==this[n]&&(this[n]=d,this[t]=0,this[o].forEach(O=>{O.length=this[n](O.value,O.key),this[t]+=O.length})),P(this)}get lengthCalculator(){return this[n]}get length(){return this[t]}get itemCount(){return this[o].length}rforEach(d,O){O=O||this;for(let B=this[o].tail;B!==null;){const Y=B.prev;v(this,d,B,O),B=Y}}forEach(d,O){O=O||this;for(let B=this[o].head;B!==null;){const Y=B.next;v(this,d,B,O),B=Y}}keys(){return this[o].toArray().map(d=>d.key)}values(){return this[o].toArray().map(d=>d.value)}reset(){this[a]&&this[o]&&this[o].length&&this[o].forEach(d=>this[a](d.key,d.value)),this[c]=new Map,this[o]=new i,this[t]=0}dump(){return this[o].map(d=>g(this,d)?!1:{k:d.key,v:d.value,e:d.now+(d.maxAge||0)}).toArray().filter(d=>d)}dumpLru(){return this[o]}set(d,O,B){if(B=B||this[s],B&&typeof B!="number")throw new TypeError("maxAge must be a number");const Y=B?Date.now():0,ee=this[n](O,d);if(this[c].has(d)){if(ee>this[e])return w(this,this[c].get(d)),!1;const pe=this[c].get(d).value;return this[a]&&(this[l]||this[a](d,pe.value)),pe.now=Y,pe.maxAge=B,pe.value=O,this[t]+=ee-pe.length,pe.length=ee,this.get(d),P(this),!0}const te=new I(d,O,ee,Y,B);return te.length>this[e]?(this[a]&&this[a](d,O),!1):(this[t]+=te.length,this[o].unshift(te),this[c].set(d,this[o].head),P(this),!0)}has(d){if(!this[c].has(d))return!1;const O=this[c].get(d).value;return!g(this,O)}get(d){return h(this,d,!0)}peek(d){return h(this,d,!1)}pop(){const d=this[o].tail;return d?(w(this,d),d.value):null}del(d){w(this,this[c].get(d))}load(d){this.reset();const O=Date.now();for(let B=d.length-1;B>=0;B--){const Y=d[B],ee=Y.e||0;if(ee===0)this.set(Y.k,Y.v);else{const te=ee-O;te>0&&this.set(Y.k,Y.v,te)}}}prune(){this[c].forEach((d,O)=>h(this,O,!1))}}const h=(_,d,O)=>{const B=_[c].get(d);if(B){const Y=B.value;if(g(_,Y)){if(w(_,B),!_[r])return}else O&&(_[u]&&(B.value.now=Date.now()),_[o].unshiftNode(B));return Y.value}},g=(_,d)=>{if(!d||!d.maxAge&&!_[s])return!1;const O=Date.now()-d.now;return d.maxAge?O>d.maxAge:_[s]&&O>_[s]},P=_=>{if(_[t]>_[e])for(let d=_[o].tail;_[t]>_[e]&&d!==null;){const O=d.prev;w(_,d),d=O}},w=(_,d)=>{if(d){const O=d.value;_[a]&&_[a](O.key,O.value),_[t]-=O.length,_[c].delete(O.key),_[o].removeNode(d)}};class I{constructor(d,O,B,Y,ee){this.key=d,this.value=O,this.length=B,this.now=Y,this.maxAge=ee||0}}const v=(_,d,O,B)=>{let Y=O.value;g(_,Y)&&(w(_,O),_[r]||(Y=void 0)),Y&&d.call(B,Y.value,Y.key,_)};return bt=m,bt}var vt,rn;function we(){if(rn)return vt;rn=1;class i{constructor(S,H){if(H=n(H),S instanceof i)return S.loose===!!H.loose&&S.includePrerelease===!!H.includePrerelease?S:new i(S.raw,H);if(S instanceof r)return this.raw=S.value,this.set=[[S]],this.format(),this;if(this.options=H,this.loose=!!H.loose,this.includePrerelease=!!H.includePrerelease,this.raw=S.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(U=>this.parseRange(U.trim())).filter(U=>U.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const U=this.set[0];if(this.set=this.set.filter(V=>!g(V[0])),this.set.length===0)this.set=[U];else if(this.set.length>1){for(const V of this.set)if(V.length===1&&P(V[0])){this.set=[V];break}}}this.format()}format(){return this.range=this.set.map(S=>S.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(S){const U=((this.options.includePrerelease&&m)|(this.options.loose&&h))+":"+S,V=t.get(U);if(V)return V;const k=this.options.loose,q=k?l[o.HYPHENRANGELOOSE]:l[o.HYPHENRANGE];S=S.replace(q,pe(this.options.includePrerelease)),s("hyphen replace",S),S=S.replace(l[o.COMPARATORTRIM],c),s("comparator trim",S),S=S.replace(l[o.TILDETRIM],u),s("tilde trim",S),S=S.replace(l[o.CARETTRIM],f),s("caret trim",S);let Z=S.split(" ").map(ie=>I(ie,this.options)).join(" ").split(/\s+/).map(ie=>ae(ie,this.options));k&&(Z=Z.filter(ie=>(s("loose invalid filter",ie,this.options),!!ie.match(l[o.COMPARATORLOOSE])))),s("range list",Z);const X=new Map,ne=Z.map(ie=>new r(ie,this.options));for(const ie of ne){if(g(ie))return[ie];X.set(ie.value,ie)}X.size>1&&X.has("")&&X.delete("");const ue=[...X.values()];return t.set(U,ue),ue}intersects(S,H){if(!(S instanceof i))throw new TypeError("a Range is required");return this.set.some(U=>w(U,H)&&S.set.some(V=>w(V,H)&&U.every(k=>V.every(q=>k.intersects(q,H)))))}test(S){if(!S)return!1;if(typeof S=="string")try{S=new a(S,this.options)}catch{return!1}for(let H=0;H<this.set.length;H++)if(z(this.set[H],S,this.options))return!0;return!1}}vt=i;const e=Ps(),t=new e({max:1e3}),n=Tt,r=pt(),s=dt,a=ge,{safeRe:l,t:o,comparatorTrimReplace:c,tildeTrimReplace:u,caretTrimReplace:f}=Ke,{FLAG_INCLUDE_PRERELEASE:m,FLAG_LOOSE:h}=ht,g=E=>E.value==="<0.0.0-0",P=E=>E.value==="",w=(E,S)=>{let H=!0;const U=E.slice();let V=U.pop();for(;H&&U.length;)H=U.every(k=>V.intersects(k,S)),V=U.pop();return H},I=(E,S)=>(s("comp",E,S),E=O(E,S),s("caret",E),E=_(E,S),s("tildes",E),E=Y(E,S),s("xrange",E),E=te(E,S),s("stars",E),E),v=E=>!E||E.toLowerCase()==="x"||E==="*",_=(E,S)=>E.trim().split(/\s+/).map(H=>d(H,S)).join(" "),d=(E,S)=>{const H=S.loose?l[o.TILDELOOSE]:l[o.TILDE];return E.replace(H,(U,V,k,q,Z)=>{s("tilde",E,U,V,k,q,Z);let X;return v(V)?X="":v(k)?X=`>=${V}.0.0 <${+V+1}.0.0-0`:v(q)?X=`>=${V}.${k}.0 <${V}.${+k+1}.0-0`:Z?(s("replaceTilde pr",Z),X=`>=${V}.${k}.${q}-${Z} <${V}.${+k+1}.0-0`):X=`>=${V}.${k}.${q} <${V}.${+k+1}.0-0`,s("tilde return",X),X})},O=(E,S)=>E.trim().split(/\s+/).map(H=>B(H,S)).join(" "),B=(E,S)=>{s("caret",E,S);const H=S.loose?l[o.CARETLOOSE]:l[o.CARET],U=S.includePrerelease?"-0":"";return E.replace(H,(V,k,q,Z,X)=>{s("caret",E,V,k,q,Z,X);let ne;return v(k)?ne="":v(q)?ne=`>=${k}.0.0${U} <${+k+1}.0.0-0`:v(Z)?k==="0"?ne=`>=${k}.${q}.0${U} <${k}.${+q+1}.0-0`:ne=`>=${k}.${q}.0${U} <${+k+1}.0.0-0`:X?(s("replaceCaret pr",X),k==="0"?q==="0"?ne=`>=${k}.${q}.${Z}-${X} <${k}.${q}.${+Z+1}-0`:ne=`>=${k}.${q}.${Z}-${X} <${k}.${+q+1}.0-0`:ne=`>=${k}.${q}.${Z}-${X} <${+k+1}.0.0-0`):(s("no pr"),k==="0"?q==="0"?ne=`>=${k}.${q}.${Z}${U} <${k}.${q}.${+Z+1}-0`:ne=`>=${k}.${q}.${Z}${U} <${k}.${+q+1}.0-0`:ne=`>=${k}.${q}.${Z} <${+k+1}.0.0-0`),s("caret return",ne),ne})},Y=(E,S)=>(s("replaceXRanges",E,S),E.split(/\s+/).map(H=>ee(H,S)).join(" ")),ee=(E,S)=>{E=E.trim();const H=S.loose?l[o.XRANGELOOSE]:l[o.XRANGE];return E.replace(H,(U,V,k,q,Z,X)=>{s("xRange",E,U,V,k,q,Z,X);const ne=v(k),ue=ne||v(q),ie=ue||v(Z),Ye=ie;return V==="="&&Ye&&(V=""),X=S.includePrerelease?"-0":"",ne?V===">"||V==="<"?U="<0.0.0-0":U="*":V&&Ye?(ue&&(q=0),Z=0,V===">"?(V=">=",ue?(k=+k+1,q=0,Z=0):(q=+q+1,Z=0)):V==="<="&&(V="<",ue?k=+k+1:q=+q+1),V==="<"&&(X="-0"),U=`${V+k}.${q}.${Z}${X}`):ue?U=`>=${k}.0.0${X} <${+k+1}.0.0-0`:ie&&(U=`>=${k}.${q}.0${X} <${k}.${+q+1}.0-0`),s("xRange return",U),U})},te=(E,S)=>(s("replaceStars",E,S),E.trim().replace(l[o.STAR],"")),ae=(E,S)=>(s("replaceGTE0",E,S),E.trim().replace(l[S.includePrerelease?o.GTE0PRE:o.GTE0],"")),pe=E=>(S,H,U,V,k,q,Z,X,ne,ue,ie,Ye,Yl)=>(v(U)?H="":v(V)?H=`>=${U}.0.0${E?"-0":""}`:v(k)?H=`>=${U}.${V}.0${E?"-0":""}`:q?H=`>=${H}`:H=`>=${H}${E?"-0":""}`,v(ne)?X="":v(ue)?X=`<${+ne+1}.0.0-0`:v(ie)?X=`<${ne}.${+ue+1}.0-0`:Ye?X=`<=${ne}.${ue}.${ie}-${Ye}`:E?X=`<${ne}.${ue}.${+ie+1}-0`:X=`<=${X}`,`${H} ${X}`.trim()),z=(E,S,H)=>{for(let U=0;U<E.length;U++)if(!E[U].test(S))return!1;if(S.prerelease.length&&!H.includePrerelease){for(let U=0;U<E.length;U++)if(s(E[U].semver),E[U].semver!==r.ANY&&E[U].semver.prerelease.length>0){const V=E[U].semver;if(V.major===S.major&&V.minor===S.minor&&V.patch===S.patch)return!0}return!1}return!0};return vt}var $t,sn;function pt(){if(sn)return $t;sn=1;const i=Symbol("SemVer ANY");class e{static get ANY(){return i}constructor(u,f){if(f=t(f),u instanceof e){if(u.loose===!!f.loose)return u;u=u.value}u=u.trim().split(/\s+/).join(" "),a("comparator",u,f),this.options=f,this.loose=!!f.loose,this.parse(u),this.semver===i?this.value="":this.value=this.operator+this.semver.version,a("comp",this)}parse(u){const f=this.options.loose?n[r.COMPARATORLOOSE]:n[r.COMPARATOR],m=u.match(f);if(!m)throw new TypeError(`Invalid comparator: ${u}`);this.operator=m[1]!==void 0?m[1]:"",this.operator==="="&&(this.operator=""),m[2]?this.semver=new l(m[2],this.options.loose):this.semver=i}toString(){return this.value}test(u){if(a("Comparator.test",u,this.options.loose),this.semver===i||u===i)return!0;if(typeof u=="string")try{u=new l(u,this.options)}catch{return!1}return s(u,this.operator,this.semver,this.options)}intersects(u,f){if(!(u instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new o(u.value,f).test(this.value):u.operator===""?u.value===""?!0:new o(this.value,f).test(u.semver):(f=t(f),f.includePrerelease&&(this.value==="<0.0.0-0"||u.value==="<0.0.0-0")||!f.includePrerelease&&(this.value.startsWith("<0.0.0")||u.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&u.operator.startsWith(">")||this.operator.startsWith("<")&&u.operator.startsWith("<")||this.semver.version===u.semver.version&&this.operator.includes("=")&&u.operator.includes("=")||s(this.semver,"<",u.semver,f)&&this.operator.startsWith(">")&&u.operator.startsWith("<")||s(this.semver,">",u.semver,f)&&this.operator.startsWith("<")&&u.operator.startsWith(">")))}}$t=e;const t=Tt,{safeRe:n,t:r}=Ke,s=Zn,a=dt,l=ge,o=we();return $t}const Bs=we(),Us=(i,e,t)=>{try{e=new Bs(e,t)}catch{return!1}return e.test(i)};var Et=Us;const Gs=we(),Fs=(i,e)=>new Gs(i,e).set.map(t=>t.map(n=>n.value).join(" ").trim().split(" "));var Vs=Fs;const Hs=ge,xs=we(),js=(i,e,t)=>{let n=null,r=null,s=null;try{s=new xs(e,t)}catch{return null}return i.forEach(a=>{s.test(a)&&(!n||r.compare(a)===-1)&&(n=a,r=new Hs(n,t))}),n};var qs=js;const Ys=ge,zs=we(),Xs=(i,e,t)=>{let n=null,r=null,s=null;try{s=new zs(e,t)}catch{return null}return i.forEach(a=>{s.test(a)&&(!n||r.compare(a)===1)&&(n=a,r=new Ys(n,t))}),n};var Ws=Xs;const Nt=ge,Js=we(),an=mt,Ks=(i,e)=>{i=new Js(i,e);let t=new Nt("0.0.0");if(i.test(t)||(t=new Nt("0.0.0-0"),i.test(t)))return t;t=null;for(let n=0;n<i.set.length;++n){const r=i.set[n];let s=null;r.forEach(a=>{const l=new Nt(a.semver.version);switch(a.operator){case">":l.prerelease.length===0?l.patch++:l.prerelease.push(0),l.raw=l.format();case"":case">=":(!s||an(l,s))&&(s=l);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${a.operator}`)}}),s&&(!t||an(t,s))&&(t=s)}return t&&i.test(t)?t:null};var Qs=Ks;const Zs=we(),ei=(i,e)=>{try{return new Zs(i,e).range||"*"}catch{return null}};var ti=ei;const ni=ge,er=pt(),{ANY:ri}=er,si=we(),ii=Et,ln=mt,on=Lt,ai=kt,li=Dt,oi=(i,e,t,n)=>{i=new ni(i,n),e=new si(e,n);let r,s,a,l,o;switch(t){case">":r=ln,s=ai,a=on,l=">",o=">=";break;case"<":r=on,s=li,a=ln,l="<",o="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(ii(i,e,n))return!1;for(let c=0;c<e.set.length;++c){const u=e.set[c];let f=null,m=null;if(u.forEach(h=>{h.semver===ri&&(h=new er(">=0.0.0")),f=f||h,m=m||h,r(h.semver,f.semver,n)?f=h:a(h.semver,m.semver,n)&&(m=h)}),f.operator===l||f.operator===o||(!m.operator||m.operator===l)&&s(i,m.semver))return!1;if(m.operator===o&&a(i,m.semver))return!1}return!0};var Pt=oi;const ci=Pt,fi=(i,e,t)=>ci(i,e,">",t);var ui=fi;const hi=Pt,di=(i,e,t)=>hi(i,e,"<",t);var mi=di;const cn=we(),pi=(i,e,t)=>(i=new cn(i,t),e=new cn(e,t),i.intersects(e,t));var Ei=pi;const _i=Et,gi=ye;var bi=(i,e,t)=>{const n=[];let r=null,s=null;const a=i.sort((u,f)=>gi(u,f,t));for(const u of a)_i(u,e,t)?(s=u,r||(r=u)):(s&&n.push([r,s]),s=null,r=null);r&&n.push([r,null]);const l=[];for(const[u,f]of n)u===f?l.push(u):!f&&u===a[0]?l.push("*"):f?u===a[0]?l.push(`<=${f}`):l.push(`${u} - ${f}`):l.push(`>=${u}`);const o=l.join(" || "),c=typeof e.raw=="string"?e.raw:String(e);return o.length<c.length?o:e};const fn=we(),Bt=pt(),{ANY:St}=Bt,ze=Et,Ut=ye,vi=(i,e,t={})=>{if(i===e)return!0;i=new fn(i,t),e=new fn(e,t);let n=!1;e:for(const r of i.set){for(const s of e.set){const a=Ni(r,s,t);if(n=n||a!==null,a)continue e}if(n)return!1}return!0},$i=[new Bt(">=0.0.0-0")],un=[new Bt(">=0.0.0")],Ni=(i,e,t)=>{if(i===e)return!0;if(i.length===1&&i[0].semver===St){if(e.length===1&&e[0].semver===St)return!0;t.includePrerelease?i=$i:i=un}if(e.length===1&&e[0].semver===St){if(t.includePrerelease)return!0;e=un}const n=new Set;let r,s;for(const h of i)h.operator===">"||h.operator===">="?r=hn(r,h,t):h.operator==="<"||h.operator==="<="?s=dn(s,h,t):n.add(h.semver);if(n.size>1)return null;let a;if(r&&s){if(a=Ut(r.semver,s.semver,t),a>0)return null;if(a===0&&(r.operator!==">="||s.operator!=="<="))return null}for(const h of n){if(r&&!ze(h,String(r),t)||s&&!ze(h,String(s),t))return null;for(const g of e)if(!ze(h,String(g),t))return!1;return!0}let l,o,c,u,f=s&&!t.includePrerelease&&s.semver.prerelease.length?s.semver:!1,m=r&&!t.includePrerelease&&r.semver.prerelease.length?r.semver:!1;f&&f.prerelease.length===1&&s.operator==="<"&&f.prerelease[0]===0&&(f=!1);for(const h of e){if(u=u||h.operator===">"||h.operator===">=",c=c||h.operator==="<"||h.operator==="<=",r){if(m&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===m.major&&h.semver.minor===m.minor&&h.semver.patch===m.patch&&(m=!1),h.operator===">"||h.operator===">="){if(l=hn(r,h,t),l===h&&l!==r)return!1}else if(r.operator===">="&&!ze(r.semver,String(h),t))return!1}if(s){if(f&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===f.major&&h.semver.minor===f.minor&&h.semver.patch===f.patch&&(f=!1),h.operator==="<"||h.operator==="<="){if(o=dn(s,h,t),o===h&&o!==s)return!1}else if(s.operator==="<="&&!ze(s.semver,String(h),t))return!1}if(!h.operator&&(s||r)&&a!==0)return!1}return!(r&&c&&!s&&a!==0||s&&u&&!r&&a!==0||m||f)},hn=(i,e,t)=>{if(!i)return e;const n=Ut(i.semver,e.semver,t);return n>0?i:n<0||e.operator===">"&&i.operator===">="?e:i},dn=(i,e,t)=>{if(!i)return e;const n=Ut(i.semver,e.semver,t);return n<0?i:n>0||e.operator==="<"&&i.operator==="<="?e:i};var Si=vi;const yt=Ke,mn=ht,yi=ge,pn=Jn,wi=qe,Ii=Tr,Ri=Dr,Ai=Pr,Ci=Ur,Mi=Vr,Ti=jr,Oi=zr,Li=Jr,Di=ye,ki=es,Pi=rs,Bi=Ot,Ui=ls,Gi=fs,Fi=mt,Vi=Lt,Hi=Kn,xi=Qn,ji=Dt,qi=kt,Yi=Zn,zi=Ls,Xi=pt(),Wi=we(),Ji=Et,Ki=Vs,Qi=qs,Zi=Ws,ea=Qs,ta=ti,na=Pt,ra=ui,sa=mi,ia=Ei,aa=bi,la=Si;var Ce={parse:wi,valid:Ii,clean:Ri,inc:Ai,diff:Ci,major:Mi,minor:Ti,patch:Oi,prerelease:Li,compare:Di,rcompare:ki,compareLoose:Pi,compareBuild:Bi,sort:Ui,rsort:Gi,gt:Fi,lt:Vi,eq:Hi,neq:xi,gte:ji,lte:qi,cmp:Yi,coerce:zi,Comparator:Xi,Range:Wi,satisfies:Ji,toComparators:Ki,maxSatisfying:Qi,minSatisfying:Zi,minVersion:ea,validRange:ta,outside:na,gtr:ra,ltr:sa,intersects:ia,simplifyRange:aa,subset:la,SemVer:yi,re:yt.re,src:yt.src,tokens:yt.t,SEMVER_SPEC_VERSION:mn.SEMVER_SPEC_VERSION,RELEASE_TYPES:mn.RELEASE_TYPES,compareIdentifiers:pn.compareIdentifiers,rcompareIdentifiers:pn.rcompareIdentifiers};class $e{constructor(e=!1){this.eventMap={},this.eventsSuspended=e==!0}addListener(e,t,n={}){if(typeof e=="string"&&e.length<1||e instanceof String&&e.length<1||typeof e!="string"&&!(e instanceof String)&&e!==$e.ANY_EVENT)throw new TypeError("The 'event' parameter must be a string or EventEmitter.ANY_EVENT.");if(typeof t!="function")throw new TypeError("The callback must be a function.");const r=new En(e,this,t,n);return this.eventMap[e]||(this.eventMap[e]=[]),n.prepend?this.eventMap[e].unshift(r):this.eventMap[e].push(r),r}addOneTimeListener(e,t,n={}){n.remaining=1,this.addListener(e,t,n)}static get ANY_EVENT(){return Symbol.for("Any event")}hasListener(e,t){return e===void 0?this.eventMap[$e.ANY_EVENT]&&this.eventMap[$e.ANY_EVENT].length>0?!0:Object.entries(this.eventMap).some(([,n])=>n.length>0):this.eventMap[e]&&this.eventMap[e].length>0?t instanceof En?this.eventMap[e].filter(r=>r===t).length>0:typeof t=="function"?this.eventMap[e].filter(r=>r.callback===t).length>0:t==null:!1}get eventNames(){return Object.keys(this.eventMap)}getListeners(e){return this.eventMap[e]||[]}suspendEvent(e){this.getListeners(e).forEach(t=>{t.suspended=!0})}unsuspendEvent(e){this.getListeners(e).forEach(t=>{t.suspended=!1})}getListenerCount(e){return this.getListeners(e).length}emit(e,...t){if(typeof e!="string"&&!(e instanceof String))throw new TypeError("The 'event' parameter must be a string.");if(this.eventsSuspended)return;let n=[],r=this.eventMap[$e.ANY_EVENT]||[];return this.eventMap[e]&&(r=r.concat(this.eventMap[e])),r.forEach(s=>{if(s.suspended)return;let a=[...t];Array.isArray(s.arguments)&&(a=a.concat(s.arguments)),s.remaining>0&&(n.push(s.callback.apply(s.context,a)),s.count++),--s.remaining<1&&s.remove()}),n}removeListener(e,t,n={}){if(e===void 0){this.eventMap={};return}else if(!this.eventMap[e])return;let r=this.eventMap[e].filter(s=>t&&s.callback!==t||n.remaining&&n.remaining!==s.remaining||n.context&&n.context!==s.context);r.length?this.eventMap[e]=r:delete this.eventMap[e]}async waitFor(e,t={}){return t.duration=parseInt(t.duration),(isNaN(t.duration)||t.duration<=0)&&(t.duration=1/0),new Promise((n,r)=>{let s,a=this.addListener(e,()=>{clearTimeout(s),n()},{remaining:1});t.duration!==1/0&&(s=setTimeout(()=>{a.remove(),r("The duration expired before the event was emitted.")},t.duration))})}get eventCount(){return Object.keys(this.eventMap).length}}class En{constructor(e,t,n,r={}){if(typeof e!="string"&&!(e instanceof String)&&e!==$e.ANY_EVENT)throw new TypeError("The 'event' parameter must be a string or EventEmitter.ANY_EVENT.");if(!t)throw new ReferenceError("The 'target' parameter is mandatory.");if(typeof n!="function")throw new TypeError("The 'callback' must be a function.");r.arguments!==void 0&&!Array.isArray(r.arguments)&&(r.arguments=[r.arguments]),r=Object.assign({context:t,remaining:1/0,arguments:void 0,duration:1/0},r),r.duration!==1/0&&setTimeout(()=>this.remove(),r.duration),this.arguments=r.arguments,this.callback=n,this.context=r.context,this.count=0,this.event=e,this.remaining=parseInt(r.remaining)>=1?parseInt(r.remaining):1/0,this.suspended=!1,this.target=t}remove(){this.target.removeListener(this.event,this.callback,{context:this.context,remaining:this.remaining})}}/**
 * The `Enumerations` class contains enumerations and arrays of elements used throughout the
 * library. All its properties are static and should be referenced using the class name. For
 * example: `Enumerations.CHANNEL_MESSAGES`.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class b{static get MIDI_CHANNEL_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MESSAGES enum has been deprecated. Use the Enumerations.CHANNEL_MESSAGES enum instead."),b.CHANNEL_MESSAGES}static get CHANNEL_MESSAGES(){return{noteoff:8,noteon:9,keyaftertouch:10,controlchange:11,programchange:12,channelaftertouch:13,pitchbend:14}}static get CHANNEL_NUMBERS(){return[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]}static get MIDI_CHANNEL_NUMBERS(){return this.validation&&console.warn("The MIDI_CHANNEL_NUMBERS array has been deprecated. Use the Enumerations.CHANNEL_NUMBERS array instead."),[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]}static get CHANNEL_MODE_MESSAGES(){return{allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127}}static get MIDI_CHANNEL_MODE_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MODE_MESSAGES enum has been deprecated. Use the Enumerations.CHANNEL_MODE_MESSAGES enum instead."),b.CHANNEL_MODE_MESSAGES}static get MIDI_CONTROL_CHANGE_MESSAGES(){return this.validation&&console.warn("The MIDI_CONTROL_CHANGE_MESSAGES enum has been deprecated. Use the Enumerations.CONTROL_CHANGE_MESSAGES array instead."),{bankselectcoarse:0,modulationwheelcoarse:1,breathcontrollercoarse:2,controller3:3,footcontrollercoarse:4,portamentotimecoarse:5,dataentrycoarse:6,volumecoarse:7,balancecoarse:8,controller9:9,pancoarse:10,expressioncoarse:11,effectcontrol1coarse:12,effectcontrol2coarse:13,controller14:14,controller15:15,generalpurposeslider1:16,generalpurposeslider2:17,generalpurposeslider3:18,generalpurposeslider4:19,controller20:20,controller21:21,controller22:22,controller23:23,controller24:24,controller25:25,controller26:26,controller27:27,controller28:28,controller29:29,controller30:30,controller31:31,bankselectfine:32,modulationwheelfine:33,breathcontrollerfine:34,controller35:35,footcontrollerfine:36,portamentotimefine:37,dataentryfine:38,volumefine:39,balancefine:40,controller41:41,panfine:42,expressionfine:43,effectcontrol1fine:44,effectcontrol2fine:45,controller46:46,controller47:47,controller48:48,controller49:49,controller50:50,controller51:51,controller52:52,controller53:53,controller54:54,controller55:55,controller56:56,controller57:57,controller58:58,controller59:59,controller60:60,controller61:61,controller62:62,controller63:63,holdpedal:64,portamento:65,sustenutopedal:66,softpedal:67,legatopedal:68,hold2pedal:69,soundvariation:70,resonance:71,soundreleasetime:72,soundattacktime:73,brightness:74,soundcontrol6:75,soundcontrol7:76,soundcontrol8:77,soundcontrol9:78,soundcontrol10:79,generalpurposebutton1:80,generalpurposebutton2:81,generalpurposebutton3:82,generalpurposebutton4:83,controller84:84,controller85:85,controller86:86,controller87:87,controller88:88,controller89:89,controller90:90,reverblevel:91,tremololevel:92,choruslevel:93,celestelevel:94,phaserlevel:95,databuttonincrement:96,databuttondecrement:97,nonregisteredparametercoarse:98,nonregisteredparameterfine:99,registeredparametercoarse:100,registeredparameterfine:101,controller102:102,controller103:103,controller104:104,controller105:105,controller106:106,controller107:107,controller108:108,controller109:109,controller110:110,controller111:111,controller112:112,controller113:113,controller114:114,controller115:115,controller116:116,controller117:117,controller118:118,controller119:119,allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127}}static get CONTROL_CHANGE_MESSAGES(){return[{number:0,name:"bankselectcoarse",description:"Bank Select (Coarse)",position:"msb"},{number:1,name:"modulationwheelcoarse",description:"Modulation Wheel (Coarse)",position:"msb"},{number:2,name:"breathcontrollercoarse",description:"Breath Controller (Coarse)",position:"msb"},{number:3,name:"controller3",description:"Undefined",position:"msb"},{number:4,name:"footcontrollercoarse",description:"Foot Controller (Coarse)",position:"msb"},{number:5,name:"portamentotimecoarse",description:"Portamento Time (Coarse)",position:"msb"},{number:6,name:"dataentrycoarse",description:"Data Entry (Coarse)",position:"msb"},{number:7,name:"volumecoarse",description:"Channel Volume (Coarse)",position:"msb"},{number:8,name:"balancecoarse",description:"Balance (Coarse)",position:"msb"},{number:9,name:"controller9",description:"Controller 9 (Coarse)",position:"msb"},{number:10,name:"pancoarse",description:"Pan (Coarse)",position:"msb"},{number:11,name:"expressioncoarse",description:"Expression Controller (Coarse)",position:"msb"},{number:12,name:"effectcontrol1coarse",description:"Effect Control 1 (Coarse)",position:"msb"},{number:13,name:"effectcontrol2coarse",description:"Effect Control 2 (Coarse)",position:"msb"},{number:14,name:"controller14",description:"Undefined",position:"msb"},{number:15,name:"controller15",description:"Undefined",position:"msb"},{number:16,name:"generalpurposecontroller1",description:"General Purpose Controller 1 (Coarse)",position:"msb"},{number:17,name:"generalpurposecontroller2",description:"General Purpose Controller 2 (Coarse)",position:"msb"},{number:18,name:"generalpurposecontroller3",description:"General Purpose Controller 3 (Coarse)",position:"msb"},{number:19,name:"generalpurposecontroller4",description:"General Purpose Controller 4 (Coarse)",position:"msb"},{number:20,name:"controller20",description:"Undefined",position:"msb"},{number:21,name:"controller21",description:"Undefined",position:"msb"},{number:22,name:"controller22",description:"Undefined",position:"msb"},{number:23,name:"controller23",description:"Undefined",position:"msb"},{number:24,name:"controller24",description:"Undefined",position:"msb"},{number:25,name:"controller25",description:"Undefined",position:"msb"},{number:26,name:"controller26",description:"Undefined",position:"msb"},{number:27,name:"controller27",description:"Undefined",position:"msb"},{number:28,name:"controller28",description:"Undefined",position:"msb"},{number:29,name:"controller29",description:"Undefined",position:"msb"},{number:30,name:"controller30",description:"Undefined",position:"msb"},{number:31,name:"controller31",description:"Undefined",position:"msb"},{number:32,name:"bankselectfine",description:"Bank Select (Fine)",position:"lsb"},{number:33,name:"modulationwheelfine",description:"Modulation Wheel (Fine)",position:"lsb"},{number:34,name:"breathcontrollerfine",description:"Breath Controller (Fine)",position:"lsb"},{number:35,name:"controller35",description:"Undefined",position:"lsb"},{number:36,name:"footcontrollerfine",description:"Foot Controller (Fine)",position:"lsb"},{number:37,name:"portamentotimefine",description:"Portamento Time (Fine)",position:"lsb"},{number:38,name:"dataentryfine",description:"Data Entry (Fine)",position:"lsb"},{number:39,name:"channelvolumefine",description:"Channel Volume (Fine)",position:"lsb"},{number:40,name:"balancefine",description:"Balance (Fine)",position:"lsb"},{number:41,name:"controller41",description:"Undefined",position:"lsb"},{number:42,name:"panfine",description:"Pan (Fine)",position:"lsb"},{number:43,name:"expressionfine",description:"Expression Controller (Fine)",position:"lsb"},{number:44,name:"effectcontrol1fine",description:"Effect control 1 (Fine)",position:"lsb"},{number:45,name:"effectcontrol2fine",description:"Effect control 2 (Fine)",position:"lsb"},{number:46,name:"controller46",description:"Undefined",position:"lsb"},{number:47,name:"controller47",description:"Undefined",position:"lsb"},{number:48,name:"controller48",description:"General Purpose Controller 1 (Fine)",position:"lsb"},{number:49,name:"controller49",description:"General Purpose Controller 2 (Fine)",position:"lsb"},{number:50,name:"controller50",description:"General Purpose Controller 3 (Fine)",position:"lsb"},{number:51,name:"controller51",description:"General Purpose Controller 4 (Fine)",position:"lsb"},{number:52,name:"controller52",description:"Undefined",position:"lsb"},{number:53,name:"controller53",description:"Undefined",position:"lsb"},{number:54,name:"controller54",description:"Undefined",position:"lsb"},{number:55,name:"controller55",description:"Undefined",position:"lsb"},{number:56,name:"controller56",description:"Undefined",position:"lsb"},{number:57,name:"controller57",description:"Undefined",position:"lsb"},{number:58,name:"controller58",description:"Undefined",position:"lsb"},{number:59,name:"controller59",description:"Undefined",position:"lsb"},{number:60,name:"controller60",description:"Undefined",position:"lsb"},{number:61,name:"controller61",description:"Undefined",position:"lsb"},{number:62,name:"controller62",description:"Undefined",position:"lsb"},{number:63,name:"controller63",description:"Undefined",position:"lsb"},{number:64,name:"damperpedal",description:"Damper Pedal On/Off"},{number:65,name:"portamento",description:"Portamento On/Off"},{number:66,name:"sostenuto",description:"Sostenuto On/Off"},{number:67,name:"softpedal",description:"Soft Pedal On/Off"},{number:68,name:"legatopedal",description:"Legato Pedal On/Off"},{number:69,name:"hold2",description:"Hold 2 On/Off"},{number:70,name:"soundvariation",description:"Sound Variation",position:"lsb"},{number:71,name:"resonance",description:"Resonance",position:"lsb"},{number:72,name:"releasetime",description:"Release Time",position:"lsb"},{number:73,name:"attacktime",description:"Attack Time",position:"lsb"},{number:74,name:"brightness",description:"Brightness",position:"lsb"},{number:75,name:"decaytime",description:"Decay Time",position:"lsb"},{number:76,name:"vibratorate",description:"Vibrato Rate",position:"lsb"},{number:77,name:"vibratodepth",description:"Vibrato Depth",position:"lsb"},{number:78,name:"vibratodelay",description:"Vibrato Delay",position:"lsb"},{number:79,name:"controller79",description:"Undefined",position:"lsb"},{number:80,name:"generalpurposecontroller5",description:"General Purpose Controller 5",position:"lsb"},{number:81,name:"generalpurposecontroller6",description:"General Purpose Controller 6",position:"lsb"},{number:82,name:"generalpurposecontroller7",description:"General Purpose Controller 7",position:"lsb"},{number:83,name:"generalpurposecontroller8",description:"General Purpose Controller 8",position:"lsb"},{number:84,name:"portamentocontrol",description:"Portamento Control",position:"lsb"},{number:85,name:"controller85",description:"Undefined"},{number:86,name:"controller86",description:"Undefined"},{number:87,name:"controller87",description:"Undefined"},{number:88,name:"highresolutionvelocityprefix",description:"High Resolution Velocity Prefix",position:"lsb"},{number:89,name:"controller89",description:"Undefined"},{number:90,name:"controller90",description:"Undefined"},{number:91,name:"effect1depth",description:"Effects 1 Depth (Reverb Send Level)"},{number:92,name:"effect2depth",description:"Effects 2 Depth"},{number:93,name:"effect3depth",description:"Effects 3 Depth (Chorus Send Level)"},{number:94,name:"effect4depth",description:"Effects 4 Depth"},{number:95,name:"effect5depth",description:"Effects 5 Depth"},{number:96,name:"dataincrement",description:"Data Increment"},{number:97,name:"datadecrement",description:"Data Decrement"},{number:98,name:"nonregisteredparameterfine",description:"Non-Registered Parameter Number (Fine)",position:"lsb"},{number:99,name:"nonregisteredparametercoarse",description:"Non-Registered Parameter Number (Coarse)",position:"msb"},{number:100,name:"registeredparameterfine",description:"Registered Parameter Number (Fine)",position:"lsb"},{number:101,name:"registeredparametercoarse",description:"Registered Parameter Number (Coarse)",position:"msb"},{number:102,name:"controller102",description:"Undefined"},{number:103,name:"controller103",description:"Undefined"},{number:104,name:"controller104",description:"Undefined"},{number:105,name:"controller105",description:"Undefined"},{number:106,name:"controller106",description:"Undefined"},{number:107,name:"controller107",description:"Undefined"},{number:108,name:"controller108",description:"Undefined"},{number:109,name:"controller109",description:"Undefined"},{number:110,name:"controller110",description:"Undefined"},{number:111,name:"controller111",description:"Undefined"},{number:112,name:"controller112",description:"Undefined"},{number:113,name:"controller113",description:"Undefined"},{number:114,name:"controller114",description:"Undefined"},{number:115,name:"controller115",description:"Undefined"},{number:116,name:"controller116",description:"Undefined"},{number:117,name:"controller117",description:"Undefined"},{number:118,name:"controller118",description:"Undefined"},{number:119,name:"controller119",description:"Undefined"},{number:120,name:"allsoundoff",description:"All Sound Off"},{number:121,name:"resetallcontrollers",description:"Reset All Controllers"},{number:122,name:"localcontrol",description:"Local Control On/Off"},{number:123,name:"allnotesoff",description:"All Notes Off"},{number:124,name:"omnimodeoff",description:"Omni Mode Off"},{number:125,name:"omnimodeon",description:"Omni Mode On"},{number:126,name:"monomodeon",description:"Mono Mode On"},{number:127,name:"polymodeon",description:"Poly Mode On"}]}static get REGISTERED_PARAMETERS(){return{pitchbendrange:[0,0],channelfinetuning:[0,1],channelcoarsetuning:[0,2],tuningprogram:[0,3],tuningbank:[0,4],modulationrange:[0,5],azimuthangle:[61,0],elevationangle:[61,1],gain:[61,2],distanceratio:[61,3],maximumdistance:[61,4],maximumdistancegain:[61,5],referencedistanceratio:[61,6],panspreadangle:[61,7],rollangle:[61,8]}}static get MIDI_REGISTERED_PARAMETERS(){return this.validation&&console.warn("The MIDI_REGISTERED_PARAMETERS enum has been deprecated. Use the Enumerations.REGISTERED_PARAMETERS enum instead."),b.MIDI_REGISTERED_PARAMETERS}static get SYSTEM_MESSAGES(){return{sysex:240,timecode:241,songposition:242,songselect:243,tunerequest:246,tuningrequest:246,sysexend:247,clock:248,start:250,continue:251,stop:252,activesensing:254,reset:255,midimessage:0,unknownsystemmessage:-1}}static get MIDI_SYSTEM_MESSAGES(){return this.validation&&console.warn("The MIDI_SYSTEM_MESSAGES enum has been deprecated. Use the Enumerations.SYSTEM_MESSAGES enum instead."),b.SYSTEM_MESSAGES}static get CHANNEL_EVENTS(){return["noteoff","controlchange","noteon","keyaftertouch","programchange","channelaftertouch","pitchbend","allnotesoff","allsoundoff","localcontrol","monomode","omnimode","resetallcontrollers","nrpn","nrpn-dataentrycoarse","nrpn-dataentryfine","nrpn-dataincrement","nrpn-datadecrement","rpn","rpn-dataentrycoarse","rpn-dataentryfine","rpn-dataincrement","rpn-datadecrement","nrpn-databuttonincrement","nrpn-databuttondecrement","rpn-databuttonincrement","rpn-databuttondecrement"]}}/**
 * The `Note` class represents a single musical note such as `"D3"`, `"G#4"`, `"F-1"`, `"Gb7"`, etc.
 *
 * `Note` objects can be played back on a single channel by calling
 * [`OutputChannel.playNote()`]{@link OutputChannel#playNote} or, on multiple channels of the same
 * output, by calling [`Output.playNote()`]{@link Output#playNote}.
 *
 * The note has [`attack`](#attack) and [`release`](#release) velocities set at `0.5` by default.
 * These can be changed by passing in the appropriate option. It is also possible to set a
 * system-wide default for attack and release velocities by using the
 * [`WebMidi.defaults`](WebMidi#defaults) property.
 *
 * If you prefer to work with raw MIDI values (`0` to `127`), you can use [`rawAttack`](#rawAttack) and
 * [`rawRelease`](#rawRelease) to both get and set the values.
 *
 * The note may have a [`duration`](#duration). If it does, playback will be automatically stopped
 * when the duration has elapsed by sending a `"noteoff"` event. By default, the duration is set to
 * `Infinity`. In this case, it will never stop playing unless explicitly stopped by calling a
 * method such as [`OutputChannel.stopNote()`]{@link OutputChannel#stopNote},
 * [`Output.stopNote()`]{@link Output#stopNote} or similar.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class ke{constructor(e,t={}){this.duration=R.defaults.note.duration,this.attack=R.defaults.note.attack,this.release=R.defaults.note.release,t.duration!=null&&(this.duration=t.duration),t.attack!=null&&(this.attack=t.attack),t.rawAttack!=null&&(this.attack=A.from7bitToFloat(t.rawAttack)),t.release!=null&&(this.release=t.release),t.rawRelease!=null&&(this.release=A.from7bitToFloat(t.rawRelease)),Number.isInteger(e)?this.identifier=A.toNoteIdentifier(e):this.identifier=e}get identifier(){return this._name+(this._accidental||"")+this._octave}set identifier(e){const t=A.getNoteDetails(e);if(R.validation&&!e)throw new Error("Invalid note identifier");this._name=t.name,this._accidental=t.accidental,this._octave=t.octave}get name(){return this._name}set name(e){if(R.validation&&(e=e.toUpperCase(),!["C","D","E","F","G","A","B"].includes(e)))throw new Error("Invalid name value");this._name=e}get accidental(){return this._accidental}set accidental(e){if(R.validation&&(e=e.toLowerCase(),!["#","##","b","bb"].includes(e)))throw new Error("Invalid accidental value");this._accidental=e}get octave(){return this._octave}set octave(e){if(R.validation&&(e=parseInt(e),isNaN(e)))throw new Error("Invalid octave value");this._octave=e}get duration(){return this._duration}set duration(e){if(R.validation&&(e=parseFloat(e),isNaN(e)||e===null||e<0))throw new RangeError("Invalid duration value.");this._duration=e}get attack(){return this._attack}set attack(e){if(R.validation&&(e=parseFloat(e),isNaN(e)||!(e>=0&&e<=1)))throw new RangeError("Invalid attack value.");this._attack=e}get release(){return this._release}set release(e){if(R.validation&&(e=parseFloat(e),isNaN(e)||!(e>=0&&e<=1)))throw new RangeError("Invalid release value.");this._release=e}get rawAttack(){return A.fromFloatTo7Bit(this._attack)}set rawAttack(e){this._attack=A.from7bitToFloat(e)}get rawRelease(){return A.fromFloatTo7Bit(this._release)}set rawRelease(e){this._release=A.from7bitToFloat(e)}get number(){return A.toNoteNumber(this.identifier)}getOffsetNumber(e=0,t=0){return R.validation&&(e=parseInt(e)||0,t=parseInt(t)||0),Math.min(Math.max(this.number+e*12+t,0),127)}}/**
 * The `Utilities` class contains general-purpose utility methods. All methods are static and
 * should be called using the class name. For example: `Utilities.getNoteDetails("C4")`.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class A{static toNoteNumber(e,t=0){if(t=t==null?0:parseInt(t),isNaN(t))throw new RangeError("Invalid 'octaveOffset' value");typeof e!="string"&&(e="");const n=this.getNoteDetails(e);if(!n)throw new TypeError("Invalid note identifier");const r={C:0,D:2,E:4,F:5,G:7,A:9,B:11};let s=(n.octave+1+t)*12;if(s+=r[n.name],n.accidental&&(n.accidental.startsWith("b")?s-=n.accidental.length:s+=n.accidental.length),s<0||s>127)throw new RangeError("Invalid octaveOffset value");return s}static getNoteDetails(e){Number.isInteger(e)&&(e=this.toNoteIdentifier(e));const t=e.match(/^([CDEFGAB])(#{0,2}|b{0,2})(-?\d+)$/i);if(!t)throw new TypeError("Invalid note identifier");const n=t[1].toUpperCase(),r=parseInt(t[3]);let s=t[2].toLowerCase();return s=s===""?void 0:s,{accidental:s,identifier:n+(s||"")+r,name:n,octave:r}}static sanitizeChannels(e){let t;if(R.validation){if(e==="all")t=["all"];else if(e==="none")return[]}return Array.isArray(e)?t=e:t=[e],t.indexOf("all")>-1&&(t=b.MIDI_CHANNEL_NUMBERS),t.map(function(n){return parseInt(n)}).filter(function(n){return n>=1&&n<=16})}static toTimestamp(e){let t=!1;const n=parseFloat(e);return isNaN(n)?!1:(typeof e=="string"&&e.substring(0,1)==="+"?n>=0&&(t=R.time+n):n>=0&&(t=n),t)}static guessNoteNumber(e,t){t=parseInt(t)||0;let n=!1;if(Number.isInteger(e)&&e>=0&&e<=127)n=parseInt(e);else if(parseInt(e)>=0&&parseInt(e)<=127)n=parseInt(e);else if(typeof e=="string"||e instanceof String)try{n=this.toNoteNumber(e.trim(),t)}catch{return!1}return n}static toNoteIdentifier(e,t){if(e=parseInt(e),isNaN(e)||e<0||e>127)throw new RangeError("Invalid note number");if(t=t==null?0:parseInt(t),isNaN(t))throw new RangeError("Invalid octaveOffset value");const n=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],r=Math.floor(e/12-1)+t;return n[e%12]+r.toString()}static buildNote(e,t={}){if(t.octaveOffset=parseInt(t.octaveOffset)||0,e instanceof ke)return e;let n=this.guessNoteNumber(e,t.octaveOffset);if(n===!1)throw new TypeError(`The input could not be parsed as a note (${e})`);return t.octaveOffset=void 0,new ke(n,t)}static buildNoteArray(e,t={}){let n=[];return Array.isArray(e)||(e=[e]),e.forEach(r=>{n.push(this.buildNote(r,t))}),n}static from7bitToFloat(e){return e===1/0&&(e=127),e=parseInt(e)||0,Math.min(Math.max(e/127,0),1)}static fromFloatTo7Bit(e){return e===1/0&&(e=1),e=parseFloat(e)||0,Math.min(Math.max(Math.round(e*127),0),127)}static fromMsbLsbToFloat(e,t=0){R.validation&&(e=Math.min(Math.max(parseInt(e)||0,0),127),t=Math.min(Math.max(parseInt(t)||0,0),127));const n=((e<<7)+t)/16383;return Math.min(Math.max(n,0),1)}static fromFloatToMsbLsb(e){R.validation&&(e=Math.min(Math.max(parseFloat(e)||0,0),1));const t=Math.round(e*16383);return{msb:t>>7,lsb:t&127}}static offsetNumber(e,t=0,n=0){if(R.validation){if(e=parseInt(e),isNaN(e))throw new Error("Invalid note number");t=parseInt(t)||0,n=parseInt(n)||0}return Math.min(Math.max(e+t*12+n,0),127)}static getPropertyByValue(e,t){return Object.keys(e).find(n=>e[n]===t)}static getCcNameByNumber(e){if(!(R.validation&&(e=parseInt(e),!(e>=0&&e<=127))))return b.CONTROL_CHANGE_MESSAGES[e].name}static getCcNumberByName(e){let t=b.CONTROL_CHANGE_MESSAGES.find(n=>n.name===e);return t?t.number:b.MIDI_CONTROL_CHANGE_MESSAGES[e]}static getChannelModeByNumber(e){if(!(e>=120&&e<=127))return!1;for(let t in b.CHANNEL_MODE_MESSAGES)if(b.CHANNEL_MODE_MESSAGES.hasOwnProperty(t)&&e===b.CHANNEL_MODE_MESSAGES[t])return t;return!1}static get isNode(){return typeof process<"u"&&process.versions!=null&&process.versions.node!=null}static get isBrowser(){return typeof window<"u"&&typeof window.document<"u"}}/**
 * The `OutputChannel` class represents a single output MIDI channel. `OutputChannel` objects are
 * provided by an [`Output`](Output) port which, itself, is made available by a device. The
 * `OutputChannel` object is derived from the host's MIDI subsystem and should not be instantiated
 * directly.
 *
 * All 16 `OutputChannel` objects can be found inside the parent output's
 * [`channels`]{@link Output#channels} property.
 *
 * @param {Output} output The [`Output`](Output) this channel belongs to.
 * @param {number} number The MIDI channel number (`1` - `16`).
 *
 * @extends EventEmitter
 * @license Apache-2.0
 * @since 3.0.0
 */class oa extends $e{constructor(e,t){super(),this._output=e,this._number=t,this._octaveOffset=0}destroy(){this._output=null,this._number=null,this._octaveOffset=0,this.removeListener()}send(e,t={time:0}){return this.output.send(e,t),this}sendKeyAftertouch(e,t,n={}){if(R.validation){if(n.useRawValue&&(n.rawValue=n.useRawValue),isNaN(parseFloat(t)))throw new RangeError("Invalid key aftertouch value.");if(n.rawValue){if(!(t>=0&&t<=127&&Number.isInteger(t)))throw new RangeError("Key aftertouch raw value must be an integer between 0 and 127.")}else if(!(t>=0&&t<=1))throw new RangeError("Key aftertouch value must be a float between 0 and 1.")}n.rawValue||(t=A.fromFloatTo7Bit(t));const r=R.octaveOffset+this.output.octaveOffset+this.octaveOffset;return Array.isArray(e)||(e=[e]),A.buildNoteArray(e).forEach(s=>{this.send([(b.CHANNEL_MESSAGES.keyaftertouch<<4)+(this.number-1),s.getOffsetNumber(r),t],{time:A.toTimestamp(n.time)})}),this}sendControlChange(e,t,n={}){if(typeof e=="string"&&(e=A.getCcNumberByName(e)),Array.isArray(t)||(t=[t]),R.validation){if(e===void 0)throw new TypeError("Control change must be identified with a valid name or an integer between 0 and 127.");if(!Number.isInteger(e)||!(e>=0&&e<=127))throw new TypeError("Control change number must be an integer between 0 and 127.");if(t=t.map(r=>{const s=Math.min(Math.max(parseInt(r),0),127);if(isNaN(s))throw new TypeError("Values must be integers between 0 and 127");return s}),t.length===2&&e>=32)throw new TypeError("To use a value array, the controller must be between 0 and 31")}return t.forEach((r,s)=>{this.send([(b.CHANNEL_MESSAGES.controlchange<<4)+(this.number-1),e+s*32,t[s]],{time:A.toTimestamp(n.time)})}),this}_selectNonRegisteredParameter(e,t={}){return this.sendControlChange(99,e[0],t),this.sendControlChange(98,e[1],t),this}_deselectRegisteredParameter(e={}){return this.sendControlChange(101,127,e),this.sendControlChange(100,127,e),this}_deselectNonRegisteredParameter(e={}){return this.sendControlChange(101,127,e),this.sendControlChange(100,127,e),this}_selectRegisteredParameter(e,t={}){return this.sendControlChange(101,e[0],t),this.sendControlChange(100,e[1],t),this}_setCurrentParameter(e,t={}){return e=[].concat(e),this.sendControlChange(6,e[0],t),e.length<2?this:(this.sendControlChange(38,e[1],t),this)}sendRpnDecrement(e,t={}){if(Array.isArray(e)||(e=b.REGISTERED_PARAMETERS[e]),R.validation){if(e===void 0)throw new TypeError("The specified registered parameter is invalid.");let n=!1;if(Object.getOwnPropertyNames(b.REGISTERED_PARAMETERS).forEach(r=>{b.REGISTERED_PARAMETERS[r][0]===e[0]&&b.REGISTERED_PARAMETERS[r][1]===e[1]&&(n=!0)}),!n)throw new TypeError("The specified registered parameter is invalid.")}return this._selectRegisteredParameter(e,t),this.sendControlChange(97,0,t),this._deselectRegisteredParameter(t),this}sendRpnIncrement(e,t={}){if(Array.isArray(e)||(e=b.REGISTERED_PARAMETERS[e]),R.validation){if(e===void 0)throw new TypeError("The specified registered parameter is invalid.");let n=!1;if(Object.getOwnPropertyNames(b.REGISTERED_PARAMETERS).forEach(r=>{b.REGISTERED_PARAMETERS[r][0]===e[0]&&b.REGISTERED_PARAMETERS[r][1]===e[1]&&(n=!0)}),!n)throw new TypeError("The specified registered parameter is invalid.")}return this._selectRegisteredParameter(e,t),this.sendControlChange(96,0,t),this._deselectRegisteredParameter(t),this}playNote(e,t={}){this.sendNoteOn(e,t);const n=Array.isArray(e)?e:[e];for(let r of n)if(parseInt(r.duration)>0){const s={time:(A.toTimestamp(t.time)||R.time)+parseInt(r.duration),release:r.release,rawRelease:r.rawRelease};this.sendNoteOff(r,s)}else if(parseInt(t.duration)>0){const s={time:(A.toTimestamp(t.time)||R.time)+parseInt(t.duration),release:t.release,rawRelease:t.rawRelease};this.sendNoteOff(r,s)}return this}sendNoteOff(e,t={}){if(R.validation){if(t.rawRelease!=null&&!(t.rawRelease>=0&&t.rawRelease<=127))throw new RangeError("The 'rawRelease' option must be an integer between 0 and 127");if(t.release!=null&&!(t.release>=0&&t.release<=1))throw new RangeError("The 'release' option must be an number between 0 and 1");t.rawVelocity&&(t.rawRelease=t.velocity,console.warn("The 'rawVelocity' option is deprecated. Use 'rawRelease' instead.")),t.velocity&&(t.release=t.velocity,console.warn("The 'velocity' option is deprecated. Use 'attack' instead."))}let n=64;t.rawRelease!=null?n=t.rawRelease:isNaN(t.release)||(n=Math.round(t.release*127));const r=R.octaveOffset+this.output.octaveOffset+this.octaveOffset;return A.buildNoteArray(e,{rawRelease:parseInt(n)}).forEach(s=>{this.send([(b.CHANNEL_MESSAGES.noteoff<<4)+(this.number-1),s.getOffsetNumber(r),s.rawRelease],{time:A.toTimestamp(t.time)})}),this}stopNote(e,t={}){return this.sendNoteOff(e,t)}sendNoteOn(e,t={}){if(R.validation){if(t.rawAttack!=null&&!(t.rawAttack>=0&&t.rawAttack<=127))throw new RangeError("The 'rawAttack' option must be an integer between 0 and 127");if(t.attack!=null&&!(t.attack>=0&&t.attack<=1))throw new RangeError("The 'attack' option must be an number between 0 and 1");t.rawVelocity&&(t.rawAttack=t.velocity,t.rawRelease=t.release,console.warn("The 'rawVelocity' option is deprecated. Use 'rawAttack' or 'rawRelease'.")),t.velocity&&(t.attack=t.velocity,console.warn("The 'velocity' option is deprecated. Use 'attack' instead."))}let n=64;t.rawAttack!=null?n=t.rawAttack:isNaN(t.attack)||(n=Math.round(t.attack*127));const r=R.octaveOffset+this.output.octaveOffset+this.octaveOffset;return A.buildNoteArray(e,{rawAttack:n}).forEach(s=>{this.send([(b.CHANNEL_MESSAGES.noteon<<4)+(this.number-1),s.getOffsetNumber(r),s.rawAttack],{time:A.toTimestamp(t.time)})}),this}sendChannelMode(e,t=0,n={}){if(typeof e=="string"&&(e=b.CHANNEL_MODE_MESSAGES[e]),R.validation){if(e===void 0)throw new TypeError("Invalid channel mode message name or number.");if(isNaN(e)||!(e>=120&&e<=127))throw new TypeError("Invalid channel mode message number.");if(isNaN(parseInt(t))||t<0||t>127)throw new RangeError("Value must be an integer between 0 and 127.")}return this.send([(b.CHANNEL_MESSAGES.controlchange<<4)+(this.number-1),e,t],{time:A.toTimestamp(n.time)}),this}sendOmniMode(e,t={}){return e===void 0||e?this.sendChannelMode("omnimodeon",0,t):this.sendChannelMode("omnimodeoff",0,t),this}sendChannelAftertouch(e,t={}){if(R.validation){if(isNaN(parseFloat(e)))throw new RangeError("Invalid channel aftertouch value.");if(t.rawValue){if(!(e>=0&&e<=127&&Number.isInteger(e)))throw new RangeError("Channel aftertouch raw value must be an integer between 0 and 127.")}else if(!(e>=0&&e<=1))throw new RangeError("Channel aftertouch value must be a float between 0 and 1.")}return this.send([(b.CHANNEL_MESSAGES.channelaftertouch<<4)+(this.number-1),Math.round(e*127)],{time:A.toTimestamp(t.time)}),this}sendMasterTuning(e,t={}){if(e=parseFloat(e)||0,R.validation&&!(e>-65&&e<64))throw new RangeError("The value must be a decimal number larger than -65 and smaller than 64.");let n=Math.floor(e)+64,r=e-Math.floor(e);r=Math.round((r+1)/2*16383);let s=r>>7&127,a=r&127;return this.sendRpnValue("channelcoarsetuning",n,t),this.sendRpnValue("channelfinetuning",[s,a],t),this}sendModulationRange(e,t,n={}){if(R.validation){if(!Number.isInteger(e)||!(e>=0&&e<=127))throw new RangeError("The semitones value must be an integer between 0 and 127.");if(t!=null&&(!Number.isInteger(t)||!(t>=0&&t<=127)))throw new RangeError("If specified, the cents value must be an integer between 0 and 127.")}return t>=0&&t<=127||(t=0),this.sendRpnValue("modulationrange",[e,t],n),this}sendNrpnValue(e,t,n={}){if(t=[].concat(t),R.validation){if(!Array.isArray(e)||!Number.isInteger(e[0])||!Number.isInteger(e[1]))throw new TypeError("The specified NRPN is invalid.");if(!(e[0]>=0&&e[0]<=127))throw new RangeError("The first byte of the NRPN must be between 0 and 127.");if(!(e[1]>=0&&e[1]<=127))throw new RangeError("The second byte of the NRPN must be between 0 and 127.");t.forEach(r=>{if(!(r>=0&&r<=127))throw new RangeError("The data bytes of the NRPN must be between 0 and 127.")})}return this._selectNonRegisteredParameter(e,n),this._setCurrentParameter(t,n),this._deselectNonRegisteredParameter(n),this}sendPitchBend(e,t={}){if(R.validation)if(t.rawValue&&Array.isArray(e)){if(!(e[0]>=0&&e[0]<=127))throw new RangeError("The pitch bend MSB must be an integer between 0 and 127.");if(!(e[1]>=0&&e[1]<=127))throw new RangeError("The pitch bend LSB must be an integer between 0 and 127.")}else if(t.rawValue&&!Array.isArray(e)){if(!(e>=0&&e<=127))throw new RangeError("The pitch bend MSB must be an integer between 0 and 127.")}else{if(isNaN(e)||e===null)throw new RangeError("Invalid pitch bend value.");if(!(e>=-1&&e<=1))throw new RangeError("The pitch bend value must be a float between -1 and 1.")}let n=0,r=0;if(t.rawValue&&Array.isArray(e))n=e[0],r=e[1];else if(t.rawValue&&!Array.isArray(e))n=e;else{const s=A.fromFloatToMsbLsb((e+1)/2);n=s.msb,r=s.lsb}return this.send([(b.CHANNEL_MESSAGES.pitchbend<<4)+(this.number-1),r,n],{time:A.toTimestamp(t.time)}),this}sendPitchBendRange(e,t,n={}){if(R.validation){if(!Number.isInteger(e)||!(e>=0&&e<=127))throw new RangeError("The semitones value must be an integer between 0 and 127.");if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new RangeError("The cents value must be an integer between 0 and 127.")}return this.sendRpnValue("pitchbendrange",[e,t],n),this}sendProgramChange(e,t={}){if(e=parseInt(e)||0,R.validation&&!(e>=0&&e<=127))throw new RangeError("The program number must be between 0 and 127.");return this.send([(b.CHANNEL_MESSAGES.programchange<<4)+(this.number-1),e],{time:A.toTimestamp(t.time)}),this}sendRpnValue(e,t,n={}){if(Array.isArray(e)||(e=b.REGISTERED_PARAMETERS[e]),R.validation){if(!Number.isInteger(e[0])||!Number.isInteger(e[1]))throw new TypeError("The specified NRPN is invalid.");if(!(e[0]>=0&&e[0]<=127))throw new RangeError("The first byte of the RPN must be between 0 and 127.");if(!(e[1]>=0&&e[1]<=127))throw new RangeError("The second byte of the RPN must be between 0 and 127.");[].concat(t).forEach(r=>{if(!(r>=0&&r<=127))throw new RangeError("The data bytes of the RPN must be between 0 and 127.")})}return this._selectRegisteredParameter(e,n),this._setCurrentParameter(t,n),this._deselectRegisteredParameter(n),this}sendTuningBank(e,t={}){if(R.validation&&(!Number.isInteger(e)||!(e>=0&&e<=127)))throw new RangeError("The tuning bank number must be between 0 and 127.");return this.sendRpnValue("tuningbank",e,t),this}sendTuningProgram(e,t={}){if(R.validation&&(!Number.isInteger(e)||!(e>=0&&e<=127)))throw new RangeError("The tuning program number must be between 0 and 127.");return this.sendRpnValue("tuningprogram",e,t),this}sendLocalControl(e,t={}){return e?this.sendChannelMode("localcontrol",127,t):this.sendChannelMode("localcontrol",0,t)}sendAllNotesOff(e={}){return this.sendChannelMode("allnotesoff",0,e)}sendAllSoundOff(e={}){return this.sendChannelMode("allsoundoff",0,e)}sendResetAllControllers(e={}){return this.sendChannelMode("resetallcontrollers",0,e)}sendPolyphonicMode(e,t={}){return e==="mono"?this.sendChannelMode("monomodeon",0,t):this.sendChannelMode("polymodeon",0,t)}get octaveOffset(){return this._octaveOffset}set octaveOffset(e){if(this.validation&&(e=parseInt(e),isNaN(e)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=e}get output(){return this._output}get number(){return this._number}}/**
 * The `Output` class represents a single MIDI output port (not to be confused with a MIDI channel).
 * A port is made available by a MIDI device. A MIDI device can advertise several input and output
 * ports. Each port has 16 MIDI channels which can be accessed via the [`channels`](#channels)
 * property.
 *
 * The `Output` object is automatically instantiated by the library according to the host's MIDI
 * subsystem and should not be directly instantiated.
 *
 * You can access all available `Output` objects by referring to the
 * [`WebMidi.outputs`](WebMidi#outputs) array or by using methods such as
 * [`WebMidi.getOutputByName()`](WebMidi#getOutputByName) or
 * [`WebMidi.getOutputById()`](WebMidi#getOutputById).
 *
 * @fires Output#opened
 * @fires Output#disconnected
 * @fires Output#closed
 *
 * @extends EventEmitter
 * @license Apache-2.0
 */class Ct extends $e{constructor(e){super(),this._midiOutput=e,this._octaveOffset=0,this.channels=[];for(let t=1;t<=16;t++)this.channels[t]=new oa(this,t);this._midiOutput.onstatechange=this._onStateChange.bind(this)}async destroy(){this.removeListener(),this.channels.forEach(e=>e.destroy()),this.channels=[],this._midiOutput&&(this._midiOutput.onstatechange=null),await this.close(),this._midiOutput=null}_onStateChange(e){let t={timestamp:R.time};e.port.connection==="open"?(t.type="opened",t.target=this,t.port=t.target,this.emit("opened",t)):e.port.connection==="closed"&&e.port.state==="connected"?(t.type="closed",t.target=this,t.port=t.target,this.emit("closed",t)):e.port.connection==="closed"&&e.port.state==="disconnected"?(t.type="disconnected",t.port={connection:e.port.connection,id:e.port.id,manufacturer:e.port.manufacturer,name:e.port.name,state:e.port.state,type:e.port.type},this.emit("disconnected",t)):e.port.connection==="pending"&&e.port.state==="disconnected"||console.warn("This statechange event was not caught:",e.port.connection,e.port.state)}async open(){try{return await this._midiOutput.open(),Promise.resolve(this)}catch(e){return Promise.reject(e)}}async close(){this._midiOutput?await this._midiOutput.close():await Promise.resolve()}send(e,t={time:0},n=0){if(e instanceof tr&&(e=A.isNode?e.data:e.rawData),e instanceof Uint8Array&&A.isNode&&(e=Array.from(e)),R.validation){if(!Array.isArray(e)&&!(e instanceof Uint8Array)&&(e=[e],Array.isArray(t)&&(e=e.concat(t)),t=isNaN(n)?{time:0}:{time:n}),!(parseInt(e[0])>=128&&parseInt(e[0])<=255))throw new RangeError("The first byte (status) must be an integer between 128 and 255.");e.slice(1).forEach(r=>{if(r=parseInt(r),!(r>=0&&r<=255))throw new RangeError("Data bytes must be integers between 0 and 255.")}),t||(t={time:0})}return this._midiOutput.send(e,A.toTimestamp(t.time)),this}sendSysex(e,t=[],n={}){if(e=[].concat(e),t instanceof Uint8Array){const r=new Uint8Array(1+e.length+t.length+1);r[0]=b.SYSTEM_MESSAGES.sysex,r.set(Uint8Array.from(e),1),r.set(t,1+e.length),r[r.length-1]=b.SYSTEM_MESSAGES.sysexend,this.send(r,{time:n.time})}else{const r=e.concat(t,b.SYSTEM_MESSAGES.sysexend);this.send([b.SYSTEM_MESSAGES.sysex].concat(r),{time:n.time})}return this}clear(){return this._midiOutput.clear?this._midiOutput.clear():R.validation&&console.warn("The 'clear()' method has not yet been implemented in your environment."),this}sendTimecodeQuarterFrame(e,t={}){if(R.validation&&(e=parseInt(e),isNaN(e)||!(e>=0&&e<=127)))throw new RangeError("The value must be an integer between 0 and 127.");return this.send([b.SYSTEM_MESSAGES.timecode,e],{time:t.time}),this}sendSongPosition(e=0,t={}){e=Math.floor(e)||0;var n=e>>7&127,r=e&127;return this.send([b.SYSTEM_MESSAGES.songposition,n,r],{time:t.time}),this}sendSongSelect(e=0,t={}){if(R.validation&&(e=parseInt(e),isNaN(e)||!(e>=0&&e<=127)))throw new RangeError("The program value must be between 0 and 127");return this.send([b.SYSTEM_MESSAGES.songselect,e],{time:t.time}),this}sendTuneRequest(e={}){return this.send([b.SYSTEM_MESSAGES.tunerequest],{time:e.time}),this}sendClock(e={}){return this.send([b.SYSTEM_MESSAGES.clock],{time:e.time}),this}sendStart(e={}){return this.send([b.SYSTEM_MESSAGES.start],{time:e.time}),this}sendContinue(e={}){return this.send([b.SYSTEM_MESSAGES.continue],{time:e.time}),this}sendStop(e={}){return this.send([b.SYSTEM_MESSAGES.stop],{time:e.time}),this}sendActiveSensing(e={}){return this.send([b.SYSTEM_MESSAGES.activesensing],{time:e.time}),this}sendReset(e={}){return this.send([b.SYSTEM_MESSAGES.reset],{time:e.time}),this}sendTuningRequest(e={}){return R.validation&&console.warn("The sendTuningRequest() method has been deprecated. Use sendTuningRequest() instead."),this.sendTuneRequest(e)}sendKeyAftertouch(e,t,n={}){return n.channels==null&&(n.channels=b.MIDI_CHANNEL_NUMBERS),A.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].sendKeyAftertouch(e,t,n)}),this}sendControlChange(e,t,n={},r={}){if(R.validation&&(Array.isArray(n)||Number.isInteger(n)||n==="all")){const s=n;n=r,n.channels=s,n.channels==="all"&&(n.channels=b.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=b.MIDI_CHANNEL_NUMBERS),A.sanitizeChannels(n.channels).forEach(s=>{this.channels[s].sendControlChange(e,t,n)}),this}sendPitchBendRange(e=0,t=0,n={}){return n.channels==null&&(n.channels=b.MIDI_CHANNEL_NUMBERS),A.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].sendPitchBendRange(e,t,n)}),this}setPitchBendRange(e=0,t=0,n="all",r={}){return R.validation&&(console.warn("The setPitchBendRange() method is deprecated. Use sendPitchBendRange() instead."),r.channels=n,r.channels==="all"&&(r.channels=b.MIDI_CHANNEL_NUMBERS)),this.sendPitchBendRange(e,t,r)}sendRpnValue(e,t,n={}){return n.channels==null&&(n.channels=b.MIDI_CHANNEL_NUMBERS),A.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].sendRpnValue(e,t,n)}),this}setRegisteredParameter(e,t=[],n="all",r={}){return R.validation&&(console.warn("The setRegisteredParameter() method is deprecated. Use sendRpnValue() instead."),r.channels=n,r.channels==="all"&&(r.channels=b.MIDI_CHANNEL_NUMBERS)),this.sendRpnValue(e,t,r)}sendChannelAftertouch(e,t={},n={}){if(R.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=n,t.channels=r,t.channels==="all"&&(t.channels=b.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=b.MIDI_CHANNEL_NUMBERS),A.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendChannelAftertouch(e,t)}),this}sendPitchBend(e,t={},n={}){if(R.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=n,t.channels=r,t.channels==="all"&&(t.channels=b.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=b.MIDI_CHANNEL_NUMBERS),A.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendPitchBend(e,t)}),this}sendProgramChange(e=0,t={},n={}){if(R.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=n,t.channels=r,t.channels==="all"&&(t.channels=b.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=b.MIDI_CHANNEL_NUMBERS),A.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendProgramChange(e,t)}),this}sendModulationRange(e,t,n={}){return n.channels==null&&(n.channels=b.MIDI_CHANNEL_NUMBERS),A.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].sendModulationRange(e,t,n)}),this}setModulationRange(e=0,t=0,n="all",r={}){return R.validation&&(console.warn("The setModulationRange() method is deprecated. Use sendModulationRange() instead."),r.channels=n,r.channels==="all"&&(r.channels=b.MIDI_CHANNEL_NUMBERS)),this.sendModulationRange(e,t,r)}sendMasterTuning(e,t={}){return t.channels==null&&(t.channels=b.MIDI_CHANNEL_NUMBERS),A.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].sendMasterTuning(e,t)}),this}setMasterTuning(e,t={},n={}){return R.validation&&(console.warn("The setMasterTuning() method is deprecated. Use sendMasterTuning() instead."),n.channels=t,n.channels==="all"&&(n.channels=b.MIDI_CHANNEL_NUMBERS)),this.sendMasterTuning(e,n)}sendTuningProgram(e,t={}){return t.channels==null&&(t.channels=b.MIDI_CHANNEL_NUMBERS),A.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].sendTuningProgram(e,t)}),this}setTuningProgram(e,t="all",n={}){return R.validation&&(console.warn("The setTuningProgram() method is deprecated. Use sendTuningProgram() instead."),n.channels=t,n.channels==="all"&&(n.channels=b.MIDI_CHANNEL_NUMBERS)),this.sendTuningProgram(e,n)}sendTuningBank(e=0,t={}){return t.channels==null&&(t.channels=b.MIDI_CHANNEL_NUMBERS),A.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].sendTuningBank(e,t)}),this}setTuningBank(e,t="all",n={}){return R.validation&&(console.warn("The setTuningBank() method is deprecated. Use sendTuningBank() instead."),n.channels=t,n.channels==="all"&&(n.channels=b.MIDI_CHANNEL_NUMBERS)),this.sendTuningBank(e,n)}sendChannelMode(e,t=0,n={},r={}){if(R.validation&&(Array.isArray(n)||Number.isInteger(n)||n==="all")){const s=n;n=r,n.channels=s,n.channels==="all"&&(n.channels=b.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=b.MIDI_CHANNEL_NUMBERS),A.sanitizeChannels(n.channels).forEach(s=>{this.channels[s].sendChannelMode(e,t,n)}),this}sendAllSoundOff(e={}){return e.channels==null&&(e.channels=b.MIDI_CHANNEL_NUMBERS),A.sanitizeChannels(e.channels).forEach(t=>{this.channels[t].sendAllSoundOff(e)}),this}sendAllNotesOff(e={}){return e.channels==null&&(e.channels=b.MIDI_CHANNEL_NUMBERS),A.sanitizeChannels(e.channels).forEach(t=>{this.channels[t].sendAllNotesOff(e)}),this}sendResetAllControllers(e={},t={}){if(R.validation&&(Array.isArray(e)||Number.isInteger(e)||e==="all")){const n=e;e=t,e.channels=n,e.channels==="all"&&(e.channels=b.MIDI_CHANNEL_NUMBERS)}return e.channels==null&&(e.channels=b.MIDI_CHANNEL_NUMBERS),A.sanitizeChannels(e.channels).forEach(n=>{this.channels[n].sendResetAllControllers(e)}),this}sendPolyphonicMode(e,t={},n={}){if(R.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=n,t.channels=r,t.channels==="all"&&(t.channels=b.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=b.MIDI_CHANNEL_NUMBERS),A.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendPolyphonicMode(e,t)}),this}sendLocalControl(e,t={},n={}){if(R.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=n,t.channels=r,t.channels==="all"&&(t.channels=b.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=b.MIDI_CHANNEL_NUMBERS),A.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendLocalControl(e,t)}),this}sendOmniMode(e,t={},n={}){if(R.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=n,t.channels=r,t.channels==="all"&&(t.channels=b.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=b.MIDI_CHANNEL_NUMBERS),A.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendOmniMode(e,t)}),this}sendNrpnValue(e,t,n={}){return n.channels==null&&(n.channels=b.MIDI_CHANNEL_NUMBERS),A.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].sendNrpnValue(e,t,n)}),this}setNonRegisteredParameter(e,t=[],n="all",r={}){return R.validation&&(console.warn("The setNonRegisteredParameter() method is deprecated. Use sendNrpnValue() instead."),r.channels=n,r.channels==="all"&&(r.channels=b.MIDI_CHANNEL_NUMBERS)),this.sendNrpnValue(e,t,r)}sendRpnIncrement(e,t={}){return t.channels==null&&(t.channels=b.MIDI_CHANNEL_NUMBERS),A.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].sendRpnIncrement(e,t)}),this}incrementRegisteredParameter(e,t="all",n={}){return R.validation&&(console.warn("The incrementRegisteredParameter() method is deprecated. Use sendRpnIncrement() instead."),n.channels=t,n.channels==="all"&&(n.channels=b.MIDI_CHANNEL_NUMBERS)),this.sendRpnIncrement(e,n)}sendRpnDecrement(e,t={}){return t.channels==null&&(t.channels=b.MIDI_CHANNEL_NUMBERS),A.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].sendRpnDecrement(e,t)}),this}decrementRegisteredParameter(e,t="all",n={}){return R.validation&&(console.warn("The decrementRegisteredParameter() method is deprecated. Use sendRpnDecrement() instead."),n.channels=t,n.channels==="all"&&(n.channels=b.MIDI_CHANNEL_NUMBERS)),this.sendRpnDecrement(e,n)}sendNoteOff(e,t={},n={}){if(R.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=n,t.channels=r,t.channels==="all"&&(t.channels=b.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=b.MIDI_CHANNEL_NUMBERS),A.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendNoteOff(e,t)}),this}stopNote(e,t){return this.sendNoteOff(e,t)}playNote(e,t={},n={}){if(R.validation&&(t.rawVelocity&&console.warn("The 'rawVelocity' option is deprecated. Use 'rawAttack' instead."),t.velocity&&console.warn("The 'velocity' option is deprecated. Use 'velocity' instead."),Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=n,t.channels=r,t.channels==="all"&&(t.channels=b.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=b.MIDI_CHANNEL_NUMBERS),A.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].playNote(e,t)}),this}sendNoteOn(e,t={},n={}){if(R.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=n,t.channels=r,t.channels==="all"&&(t.channels=b.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=b.MIDI_CHANNEL_NUMBERS),A.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendNoteOn(e,t)}),this}get name(){return this._midiOutput.name}get id(){return this._midiOutput.id}get connection(){return this._midiOutput.connection}get manufacturer(){return this._midiOutput.manufacturer}get state(){return this._midiOutput.state}get type(){return this._midiOutput.type}get octaveOffset(){return this._octaveOffset}set octaveOffset(e){if(this.validation&&(e=parseInt(e),isNaN(e)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=e}}/**
 * The `Forwarder` class allows the forwarding of MIDI messages to predetermined outputs. When you
 * call its [`forward()`](#forward) method, it will send the specified [`Message`](Message) object
 * to all the outputs listed in its [`destinations`](#destinations) property.
 *
 * If specific channels or message types have been defined in the [`channels`](#channels) or
 * [`types`](#types) properties, only messages matching the channels/types will be forwarded.
 *
 * While it can be manually instantiated, you are more likely to come across a `Forwarder` object as
 * the return value of the [`Input.addForwarder()`](Input#addForwarder) method.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class _n{constructor(e=[],t={}){this.destinations=[],this.types=[...Object.keys(b.SYSTEM_MESSAGES),...Object.keys(b.CHANNEL_MESSAGES)],this.channels=b.MIDI_CHANNEL_NUMBERS,this.suspended=!1,Array.isArray(e)||(e=[e]),t.types&&!Array.isArray(t.types)&&(t.types=[t.types]),t.channels&&!Array.isArray(t.channels)&&(t.channels=[t.channels]),R.validation&&(e.forEach(n=>{if(!(n instanceof Ct))throw new TypeError("Destinations must be of type 'Output'.")}),t.types!==void 0&&t.types.forEach(n=>{if(!b.SYSTEM_MESSAGES.hasOwnProperty(n)&&!b.CHANNEL_MESSAGES.hasOwnProperty(n))throw new TypeError("Type must be a valid message type.")}),t.channels!==void 0&&t.channels.forEach(n=>{if(!b.MIDI_CHANNEL_NUMBERS.includes(n))throw new TypeError("MIDI channel must be between 1 and 16.")})),this.destinations=e,t.types&&(this.types=t.types),t.channels&&(this.channels=t.channels)}forward(e){this.suspended||this.types.includes(e.type)&&(e.channel&&!this.channels.includes(e.channel)||this.destinations.forEach(t=>{R.validation&&!(t instanceof Ct)||t.send(e)}))}}/**
 * The `InputChannel` class represents a single MIDI input channel (1-16) from a single input
 * device. This object is derived from the host's MIDI subsystem and should not be instantiated
 * directly.
 *
 * All 16 `InputChannel` objects can be found inside the input's [`channels`](Input#channels)
 * property.
 *
 * @fires InputChannel#midimessage
 * @fires InputChannel#unknownmessage
 *
 * @fires InputChannel#noteoff
 * @fires InputChannel#noteon
 * @fires InputChannel#keyaftertouch
 * @fires InputChannel#programchange
 * @fires InputChannel#channelaftertouch
 * @fires InputChannel#pitchbend
 *
 * @fires InputChannel#allnotesoff
 * @fires InputChannel#allsoundoff
 * @fires InputChannel#localcontrol
 * @fires InputChannel#monomode
 * @fires InputChannel#omnimode
 * @fires InputChannel#resetallcontrollers
 *
 * @fires InputChannel#event:nrpn
 * @fires InputChannel#event:nrpn-dataentrycoarse
 * @fires InputChannel#event:nrpn-dataentryfine
 * @fires InputChannel#event:nrpn-dataincrement
 * @fires InputChannel#event:nrpn-datadecrement
 * @fires InputChannel#event:rpn
 * @fires InputChannel#event:rpn-dataentrycoarse
 * @fires InputChannel#event:rpn-dataentryfine
 * @fires InputChannel#event:rpn-dataincrement
 * @fires InputChannel#event:rpn-datadecrement
 *
 * @fires InputChannel#controlchange
 * @fires InputChannel#event:controlchange-controllerxxx
 * @fires InputChannel#event:controlchange-bankselectcoarse
 * @fires InputChannel#event:controlchange-modulationwheelcoarse
 * @fires InputChannel#event:controlchange-breathcontrollercoarse
 * @fires InputChannel#event:controlchange-footcontrollercoarse
 * @fires InputChannel#event:controlchange-portamentotimecoarse
 * @fires InputChannel#event:controlchange-dataentrycoarse
 * @fires InputChannel#event:controlchange-volumecoarse
 * @fires InputChannel#event:controlchange-balancecoarse
 * @fires InputChannel#event:controlchange-pancoarse
 * @fires InputChannel#event:controlchange-expressioncoarse
 * @fires InputChannel#event:controlchange-effectcontrol1coarse
 * @fires InputChannel#event:controlchange-effectcontrol2coarse
 * @fires InputChannel#event:controlchange-generalpurposecontroller1
 * @fires InputChannel#event:controlchange-generalpurposecontroller2
 * @fires InputChannel#event:controlchange-generalpurposecontroller3
 * @fires InputChannel#event:controlchange-generalpurposecontroller4
 * @fires InputChannel#event:controlchange-bankselectfine
 * @fires InputChannel#event:controlchange-modulationwheelfine
 * @fires InputChannel#event:controlchange-breathcontrollerfine
 * @fires InputChannel#event:controlchange-footcontrollerfine
 * @fires InputChannel#event:controlchange-portamentotimefine
 * @fires InputChannel#event:controlchange-dataentryfine
 * @fires InputChannel#event:controlchange-channelvolumefine
 * @fires InputChannel#event:controlchange-balancefine
 * @fires InputChannel#event:controlchange-panfine
 * @fires InputChannel#event:controlchange-expressionfine
 * @fires InputChannel#event:controlchange-effectcontrol1fine
 * @fires InputChannel#event:controlchange-effectcontrol2fine
 * @fires InputChannel#event:controlchange-damperpedal
 * @fires InputChannel#event:controlchange-portamento
 * @fires InputChannel#event:controlchange-sostenuto
 * @fires InputChannel#event:controlchange-softpedal
 * @fires InputChannel#event:controlchange-legatopedal
 * @fires InputChannel#event:controlchange-hold2
 * @fires InputChannel#event:controlchange-soundvariation
 * @fires InputChannel#event:controlchange-resonance
 * @fires InputChannel#event:controlchange-releasetime
 * @fires InputChannel#event:controlchange-attacktime
 * @fires InputChannel#event:controlchange-brightness
 * @fires InputChannel#event:controlchange-decaytime
 * @fires InputChannel#event:controlchange-vibratorate
 * @fires InputChannel#event:controlchange-vibratodepth
 * @fires InputChannel#event:controlchange-vibratodelay
 * @fires InputChannel#event:controlchange-generalpurposecontroller5
 * @fires InputChannel#event:controlchange-generalpurposecontroller6
 * @fires InputChannel#event:controlchange-generalpurposecontroller7
 * @fires InputChannel#event:controlchange-generalpurposecontroller8
 * @fires InputChannel#event:controlchange-portamentocontrol
 * @fires InputChannel#event:controlchange-highresolutionvelocityprefix
 * @fires InputChannel#event:controlchange-effect1depth
 * @fires InputChannel#event:controlchange-effect2depth
 * @fires InputChannel#event:controlchange-effect3depth
 * @fires InputChannel#event:controlchange-effect4depth
 * @fires InputChannel#event:controlchange-effect5depth
 * @fires InputChannel#event:controlchange-dataincrement
 * @fires InputChannel#event:controlchange-datadecrement
 * @fires InputChannel#event:controlchange-nonregisteredparameterfine
 * @fires InputChannel#event:controlchange-nonregisteredparametercoarse
 * @fires InputChannel#event:controlchange-registeredparameterfine
 * @fires InputChannel#event:controlchange-registeredparametercoarse
 * @fires InputChannel#event:controlchange-allsoundoff
 * @fires InputChannel#event:controlchange-resetallcontrollers
 * @fires InputChannel#event:controlchange-localcontrol
 * @fires InputChannel#event:controlchange-allnotesoff
 * @fires InputChannel#event:controlchange-omnimodeoff
 * @fires InputChannel#event:controlchange-omnimodeon
 * @fires InputChannel#event:controlchange-monomodeon
 * @fires InputChannel#event:controlchange-polymodeon
 * @fires InputChannel#event:
 *
 * @extends EventEmitter
 * @license Apache-2.0
 * @since 3.0.0
 */class ca extends $e{constructor(e,t){super(),this._input=e,this._number=t,this._octaveOffset=0,this._nrpnBuffer=[],this._rpnBuffer=[],this.parameterNumberEventsEnabled=!0,this.notesState=new Array(128).fill(!1)}destroy(){this._input=null,this._number=null,this._octaveOffset=0,this._nrpnBuffer=[],this.notesState=new Array(128).fill(!1),this.parameterNumberEventsEnabled=!1,this.removeListener()}_processMidiMessageEvent(e){const t=Object.assign({},e);t.port=this.input,t.target=this,t.type="midimessage",this.emit(t.type,t),this._parseEventForStandardMessages(t)}_parseEventForStandardMessages(e){const t=Object.assign({},e);t.type=t.message.type||"unknownmessage";const n=e.message.dataBytes[0],r=e.message.dataBytes[1];if(t.type==="noteoff"||t.type==="noteon"&&r===0)this.notesState[n]=!1,t.type="noteoff",t.note=new ke(A.offsetNumber(n,this.octaveOffset+this.input.octaveOffset+R.octaveOffset),{rawAttack:0,rawRelease:r}),t.value=A.from7bitToFloat(r),t.rawValue=r,t.velocity=t.note.release,t.rawVelocity=t.note.rawRelease;else if(t.type==="noteon")this.notesState[n]=!0,t.note=new ke(A.offsetNumber(n,this.octaveOffset+this.input.octaveOffset+R.octaveOffset),{rawAttack:r}),t.value=A.from7bitToFloat(r),t.rawValue=r,t.velocity=t.note.attack,t.rawVelocity=t.note.rawAttack;else if(t.type==="keyaftertouch")t.note=new ke(A.offsetNumber(n,this.octaveOffset+this.input.octaveOffset+R.octaveOffset)),t.value=A.from7bitToFloat(r),t.rawValue=r,t.identifier=t.note.identifier,t.key=t.note.number,t.rawKey=n;else if(t.type==="controlchange"){t.controller={number:n,name:b.CONTROL_CHANGE_MESSAGES[n].name,description:b.CONTROL_CHANGE_MESSAGES[n].description,position:b.CONTROL_CHANGE_MESSAGES[n].position},t.subtype=t.controller.name||"controller"+n,t.value=A.from7bitToFloat(r),t.rawValue=r;const s=Object.assign({},t);s.type=`${t.type}-controller${n}`,delete s.subtype,this.emit(s.type,s);const a=Object.assign({},t);a.type=`${t.type}-`+b.CONTROL_CHANGE_MESSAGES[n].name,delete a.subtype,a.type.indexOf("controller")!==0&&this.emit(a.type,a),t.message.dataBytes[0]>=120&&this._parseChannelModeMessage(t),this.parameterNumberEventsEnabled&&this._isRpnOrNrpnController(t.message.dataBytes[0])&&this._parseEventForParameterNumber(t)}else t.type==="programchange"?(t.value=n,t.rawValue=t.value):t.type==="channelaftertouch"?(t.value=A.from7bitToFloat(n),t.rawValue=n):t.type==="pitchbend"?(t.value=((r<<7)+n-8192)/8192,t.rawValue=(r<<7)+n):t.type="unknownmessage";this.emit(t.type,t)}_parseChannelModeMessage(e){const t=Object.assign({},e);t.type=t.controller.name,t.type==="localcontrol"&&(t.value=t.message.data[2]===127,t.rawValue=t.message.data[2]),t.type==="omnimodeon"?(t.type="omnimode",t.value=!0,t.rawValue=t.message.data[2]):t.type==="omnimodeoff"&&(t.type="omnimode",t.value=!1,t.rawValue=t.message.data[2]),t.type==="monomodeon"?(t.type="monomode",t.value=!0,t.rawValue=t.message.data[2]):t.type==="polymodeon"&&(t.type="monomode",t.value=!1,t.rawValue=t.message.data[2]),this.emit(t.type,t)}_parseEventForParameterNumber(e){const t=e.message.dataBytes[0],n=e.message.dataBytes[1];t===99||t===101?(this._nrpnBuffer=[],this._rpnBuffer=[],t===99?this._nrpnBuffer=[e.message]:n!==127&&(this._rpnBuffer=[e.message])):t===98||t===100?t===98?(this._rpnBuffer=[],this._nrpnBuffer.length===1?this._nrpnBuffer.push(e.message):this._nrpnBuffer=[]):(this._nrpnBuffer=[],this._rpnBuffer.length===1&&n!==127?this._rpnBuffer.push(e.message):this._rpnBuffer=[]):(t===6||t===38||t===96||t===97)&&(this._rpnBuffer.length===2?this._dispatchParameterNumberEvent("rpn",this._rpnBuffer[0].dataBytes[1],this._rpnBuffer[1].dataBytes[1],e):this._nrpnBuffer.length===2?this._dispatchParameterNumberEvent("nrpn",this._nrpnBuffer[0].dataBytes[1],this._nrpnBuffer[1].dataBytes[1],e):(this._nrpnBuffer=[],this._rpnBuffer=[]))}_isRpnOrNrpnController(e){return e===6||e===38||e===96||e===97||e===98||e===99||e===100||e===101}_dispatchParameterNumberEvent(e,t,n,r){e=e==="nrpn"?"nrpn":"rpn";const s={target:r.target,timestamp:r.timestamp,message:r.message,parameterMsb:t,parameterLsb:n,value:A.from7bitToFloat(r.message.dataBytes[1]),rawValue:r.message.dataBytes[1]};e==="rpn"?s.parameter=Object.keys(b.REGISTERED_PARAMETERS).find(o=>b.REGISTERED_PARAMETERS[o][0]===t&&b.REGISTERED_PARAMETERS[o][1]===n):s.parameter=(t<<7)+n;const a=b.CONTROL_CHANGE_MESSAGES[r.message.dataBytes[0]].name;s.type=`${e}-${a}`,this.emit(s.type,s);const l=Object.assign({},s);l.type==="nrpn-dataincrement"?l.type="nrpn-databuttonincrement":l.type==="nrpn-datadecrement"?l.type="nrpn-databuttondecrement":l.type==="rpn-dataincrement"?l.type="rpn-databuttonincrement":l.type==="rpn-datadecrement"&&(l.type="rpn-databuttondecrement"),this.emit(l.type,l),s.type=e,s.subtype=a,this.emit(s.type,s)}getChannelModeByNumber(e){return R.validation&&(console.warn("The 'getChannelModeByNumber()' method has been moved to the 'Utilities' class."),e=Math.floor(e)),A.getChannelModeByNumber(e)}getCcNameByNumber(e){if(R.validation&&(console.warn("The 'getCcNameByNumber()' method has been moved to the 'Utilities' class."),e=parseInt(e),!(e>=0&&e<=127)))throw new RangeError("Invalid control change number.");return A.getCcNameByNumber(e)}getNoteState(e){e instanceof ke&&(e=e.identifier);const t=A.guessNoteNumber(e,R.octaveOffset+this.input.octaveOffset+this.octaveOffset);return this.notesState[t]}get octaveOffset(){return this._octaveOffset}set octaveOffset(e){if(this.validation&&(e=parseInt(e),isNaN(e)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=e}get input(){return this._input}get number(){return this._number}get nrpnEventsEnabled(){return this.parameterNumberEventsEnabled}set nrpnEventsEnabled(e){this.validation&&(e=!!e),this.parameterNumberEventsEnabled=e}}/**
 * The `Message` class represents a single MIDI message. It has several properties that make it
 * easy to make sense of the binary data it contains.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class tr{constructor(e){this.rawData=e,this.data=Array.from(this.rawData),this.statusByte=this.rawData[0],this.rawDataBytes=this.rawData.slice(1),this.dataBytes=this.data.slice(1),this.isChannelMessage=!1,this.isSystemMessage=!1,this.command=void 0,this.channel=void 0,this.manufacturerId=void 0,this.type=void 0,this.statusByte<240?(this.isChannelMessage=!0,this.command=this.statusByte>>4,this.channel=(this.statusByte&15)+1):(this.isSystemMessage=!0,this.command=this.statusByte),this.isChannelMessage?this.type=A.getPropertyByValue(b.CHANNEL_MESSAGES,this.command):this.isSystemMessage&&(this.type=A.getPropertyByValue(b.SYSTEM_MESSAGES,this.command)),this.statusByte===b.SYSTEM_MESSAGES.sysex&&(this.dataBytes[0]===0?(this.manufacturerId=this.dataBytes.slice(0,3),this.dataBytes=this.dataBytes.slice(3,this.rawDataBytes.length-1),this.rawDataBytes=this.rawDataBytes.slice(3,this.rawDataBytes.length-1)):(this.manufacturerId=[this.dataBytes[0]],this.dataBytes=this.dataBytes.slice(1,this.dataBytes.length-1),this.rawDataBytes=this.rawDataBytes.slice(1,this.rawDataBytes.length-1)))}}/**
 * The `Input` class represents a single MIDI input port. This object is automatically instantiated
 * by the library according to the host's MIDI subsystem and does not need to be directly
 * instantiated. Instead, you can access all `Input` objects by referring to the
 * [`WebMidi.inputs`](WebMidi#inputs) array. You can also retrieve inputs by using methods such as
 * [`WebMidi.getInputByName()`](WebMidi#getInputByName) and
 * [`WebMidi.getInputById()`](WebMidi#getInputById).
 *
 * Note that a single MIDI device may expose several inputs and/or outputs.
 *
 * **Important**: the `Input` class does not directly fire channel-specific MIDI messages
 * (such as [`noteon`](InputChannel#event:noteon) or
 * [`controlchange`](InputChannel#event:controlchange), etc.). The [`InputChannel`](InputChannel)
 * object does that. However, you can still use the
 * [`Input.addListener()`](#addListener) method to listen to channel-specific events on multiple
 * [`InputChannel`](InputChannel) objects at once.
 *
 * @fires Input#opened
 * @fires Input#disconnected
 * @fires Input#closed
 * @fires Input#midimessage
 *
 * @fires Input#sysex
 * @fires Input#timecode
 * @fires Input#songposition
 * @fires Input#songselect
 * @fires Input#tunerequest
 * @fires Input#clock
 * @fires Input#start
 * @fires Input#continue
 * @fires Input#stop
 * @fires Input#activesensing
 * @fires Input#reset
 *
 * @fires Input#unknownmidimessage
 *
 * @extends EventEmitter
 * @license Apache-2.0
 */class fa extends $e{constructor(e){super(),this._midiInput=e,this._octaveOffset=0,this.channels=[];for(let t=1;t<=16;t++)this.channels[t]=new ca(this,t);this._forwarders=[],this._midiInput.onstatechange=this._onStateChange.bind(this),this._midiInput.onmidimessage=this._onMidiMessage.bind(this)}async destroy(){this.removeListener(),this.channels.forEach(e=>e.destroy()),this.channels=[],this._forwarders=[],this._midiInput&&(this._midiInput.onstatechange=null,this._midiInput.onmidimessage=null),await this.close(),this._midiInput=null}_onStateChange(e){let t={timestamp:R.time,target:this,port:this};e.port.connection==="open"?(t.type="opened",this.emit("opened",t)):e.port.connection==="closed"&&e.port.state==="connected"?(t.type="closed",this.emit("closed",t)):e.port.connection==="closed"&&e.port.state==="disconnected"?(t.type="disconnected",t.port={connection:e.port.connection,id:e.port.id,manufacturer:e.port.manufacturer,name:e.port.name,state:e.port.state,type:e.port.type},this.emit("disconnected",t)):e.port.connection==="pending"&&e.port.state==="disconnected"||console.warn("This statechange event was not caught: ",e.port.connection,e.port.state)}_onMidiMessage(e){const t=new tr(e.data),n={port:this,target:this,message:t,timestamp:e.timeStamp,type:"midimessage",data:t.data,rawData:t.data,statusByte:t.data[0],dataBytes:t.dataBytes};this.emit("midimessage",n),t.isSystemMessage?this._parseEvent(n):t.isChannelMessage&&this.channels[t.channel]._processMidiMessageEvent(n),this._forwarders.forEach(r=>r.forward(t))}_parseEvent(e){const t=Object.assign({},e);t.type=t.message.type||"unknownmidimessage",t.type==="songselect"&&(t.song=e.data[1]+1,t.value=e.data[1],t.rawValue=t.value),this.emit(t.type,t)}async open(){try{await this._midiInput.open()}catch(e){return Promise.reject(e)}return Promise.resolve(this)}async close(){if(!this._midiInput)return Promise.resolve(this);try{await this._midiInput.close()}catch(e){return Promise.reject(e)}return Promise.resolve(this)}getChannelModeByNumber(){R.validation&&console.warn("The 'getChannelModeByNumber()' method has been moved to the 'Utilities' class.")}addListener(e,t,n={}){if(R.validation&&typeof n=="function"){let r=t!=null?[].concat(t):void 0;t=n,n={channels:r}}if(b.CHANNEL_EVENTS.includes(e)){n.channels===void 0&&(n.channels=b.MIDI_CHANNEL_NUMBERS);let r=[];return A.sanitizeChannels(n.channels).forEach(s=>{r.push(this.channels[s].addListener(e,t,n))}),r}else return super.addListener(e,t,n)}addOneTimeListener(e,t,n={}){return n.remaining=1,this.addListener(e,t,n)}on(e,t,n,r){return this.addListener(e,t,n,r)}hasListener(e,t,n={}){if(R.validation&&typeof n=="function"){let r=[].concat(t);t=n,n={channels:r}}return b.CHANNEL_EVENTS.includes(e)?(n.channels===void 0&&(n.channels=b.MIDI_CHANNEL_NUMBERS),A.sanitizeChannels(n.channels).every(r=>this.channels[r].hasListener(e,t))):super.hasListener(e,t)}removeListener(e,t,n={}){if(R.validation&&typeof n=="function"){let r=[].concat(t);t=n,n={channels:r}}if(n.channels===void 0&&(n.channels=b.MIDI_CHANNEL_NUMBERS),e==null)return A.sanitizeChannels(n.channels).forEach(r=>{this.channels[r]&&this.channels[r].removeListener()}),super.removeListener();b.CHANNEL_EVENTS.includes(e)?A.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].removeListener(e,t,n)}):super.removeListener(e,t,n)}addForwarder(e,t={}){let n;return e instanceof _n?n=e:n=new _n(e,t),this._forwarders.push(n),n}removeForwarder(e){this._forwarders=this._forwarders.filter(t=>t!==e)}hasForwarder(e){return this._forwarders.includes(e)}get name(){return this._midiInput.name}get id(){return this._midiInput.id}get connection(){return this._midiInput.connection}get manufacturer(){return this._midiInput.manufacturer}get octaveOffset(){return this._octaveOffset}set octaveOffset(e){if(this.validation&&(e=parseInt(e),isNaN(e)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=e}get state(){return this._midiInput.state}get type(){return this._midiInput.type}get nrpnEventsEnabled(){return R.validation&&console.warn("The 'nrpnEventsEnabled' property has been moved to the 'InputChannel' class."),!1}}/**
 * The `WebMidi` object makes it easier to work with the low-level Web MIDI API. Basically, it
 * simplifies sending outgoing MIDI messages and reacting to incoming MIDI messages.
 *
 * When using the WebMidi.js library, you should know that the `WebMidi` class has already been
 * instantiated. You cannot instantiate it yourself. If you use the **IIFE** version, you should
 * simply use the global object called `WebMidi`. If you use the **CJS** (CommonJS) or **ESM** (ES6
 * module) version, you get an already-instantiated object when you import the module.
 *
 * @fires WebMidi#connected
 * @fires WebMidi#disabled
 * @fires WebMidi#disconnected
 * @fires WebMidi#enabled
 * @fires WebMidi#error
 * @fires WebMidi#midiaccessgranted
 * @fires WebMidi#portschanged
 *
 * @extends EventEmitter
 * @license Apache-2.0
 */class ua extends $e{constructor(){super(),this.defaults={note:{attack:A.from7bitToFloat(64),release:A.from7bitToFloat(64),duration:1/0}},this.interface=null,this.validation=!0,this._inputs=[],this._disconnectedInputs=[],this._outputs=[],this._disconnectedOutputs=[],this._stateChangeQueue=[],this._octaveOffset=0}async enable(e={},t=!1){if(A.isNode){try{window.navigator}catch{let l=await Object.getPrototypeOf(async function(){}).constructor(`
        let jzz = await import("jzz");
        return jzz.default;
        `)();global.navigator||(global.navigator={}),Object.assign(global.navigator,l)}try{}catch{global.performance=await Object.getPrototypeOf(async function(){}).constructor(`
        let perf_hooks = await import("perf_hooks");
        return perf_hooks.performance;
        `)()}}if(this.validation=e.validation!==!1,this.validation&&(typeof e=="function"&&(e={callback:e,sysex:t}),t&&(e.sysex=!0)),this.enabled)return typeof e.callback=="function"&&e.callback(),Promise.resolve();const n={timestamp:this.time,target:this,type:"error",error:void 0},r={timestamp:this.time,target:this,type:"midiaccessgranted"},s={timestamp:this.time,target:this,type:"enabled"};try{typeof e.requestMIDIAccessFunction=="function"?this.interface=await e.requestMIDIAccessFunction({sysex:e.sysex,software:e.software}):this.interface=await navigator.requestMIDIAccess({sysex:e.sysex,software:e.software})}catch(a){return n.error=a,this.emit("error",n),typeof e.callback=="function"&&e.callback(a),Promise.reject(a)}this.emit("midiaccessgranted",r),this.interface.onstatechange=this._onInterfaceStateChange.bind(this);try{await this._updateInputsAndOutputs()}catch(a){return n.error=a,this.emit("error",n),typeof e.callback=="function"&&e.callback(a),Promise.reject(a)}return this.emit("enabled",s),typeof e.callback=="function"&&e.callback(),Promise.resolve(this)}async disable(){return this.interface&&(this.interface.onstatechange=void 0),this._destroyInputsAndOutputs().then(()=>{navigator&&typeof navigator.close=="function"&&navigator.close(),this.interface=null;let e={timestamp:this.time,target:this,type:"disabled"};this.emit("disabled",e),this.removeListener()})}getInputById(e,t={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!e)return}if(t.disconnected){for(let n=0;n<this._disconnectedInputs.length;n++)if(this._disconnectedInputs[n].id===e.toString())return this._disconnectedInputs[n]}else for(let n=0;n<this.inputs.length;n++)if(this.inputs[n].id===e.toString())return this.inputs[n]}getInputByName(e,t={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!e)return;e=e.toString()}if(t.disconnected){for(let n=0;n<this._disconnectedInputs.length;n++)if(~this._disconnectedInputs[n].name.indexOf(e))return this._disconnectedInputs[n]}else for(let n=0;n<this.inputs.length;n++)if(~this.inputs[n].name.indexOf(e))return this.inputs[n]}getOutputByName(e,t={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!e)return;e=e.toString()}if(t.disconnected){for(let n=0;n<this._disconnectedOutputs.length;n++)if(~this._disconnectedOutputs[n].name.indexOf(e))return this._disconnectedOutputs[n]}else for(let n=0;n<this.outputs.length;n++)if(~this.outputs[n].name.indexOf(e))return this.outputs[n]}getOutputById(e,t={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!e)return}if(t.disconnected){for(let n=0;n<this._disconnectedOutputs.length;n++)if(this._disconnectedOutputs[n].id===e.toString())return this._disconnectedOutputs[n]}else for(let n=0;n<this.outputs.length;n++)if(this.outputs[n].id===e.toString())return this.outputs[n]}noteNameToNumber(e){return this.validation&&console.warn("The noteNameToNumber() method is deprecated. Use Utilities.toNoteNumber() instead."),A.toNoteNumber(e,this.octaveOffset)}getOctave(e){return this.validation&&(console.warn("The getOctave()is deprecated. Use Utilities.getNoteDetails() instead"),e=parseInt(e)),!isNaN(e)&&e>=0&&e<=127?A.getNoteDetails(A.offsetNumber(e,this.octaveOffset)).octave:!1}sanitizeChannels(e){return this.validation&&console.warn("The sanitizeChannels() method has been moved to the utilities class."),A.sanitizeChannels(e)}toMIDIChannels(e){return this.validation&&console.warn("The toMIDIChannels() method has been deprecated. Use Utilities.sanitizeChannels() instead."),A.sanitizeChannels(e)}guessNoteNumber(e){return this.validation&&console.warn("The guessNoteNumber() method has been deprecated. Use Utilities.guessNoteNumber() instead."),A.guessNoteNumber(e,this.octaveOffset)}getValidNoteArray(e,t={}){return this.validation&&console.warn("The getValidNoteArray() method has been moved to the Utilities.buildNoteArray()"),A.buildNoteArray(e,t)}convertToTimestamp(e){return this.validation&&console.warn("The convertToTimestamp() method has been moved to Utilities.toTimestamp()."),A.toTimestamp(e)}async _destroyInputsAndOutputs(){let e=[];return this.inputs.forEach(t=>e.push(t.destroy())),this.outputs.forEach(t=>e.push(t.destroy())),Promise.all(e).then(()=>{this._inputs=[],this._outputs=[]})}_onInterfaceStateChange(e){this._updateInputsAndOutputs();let t={timestamp:e.timeStamp,type:e.port.state,target:this};if(e.port.state==="connected"&&e.port.connection==="open"){e.port.type==="output"?t.port=this.getOutputById(e.port.id):e.port.type==="input"&&(t.port=this.getInputById(e.port.id)),this.emit(e.port.state,t);const n=Object.assign({},t);n.type="portschanged",this.emit(n.type,n)}else if(e.port.state==="disconnected"&&e.port.connection==="pending"){e.port.type==="input"?t.port=this.getInputById(e.port.id,{disconnected:!0}):e.port.type==="output"&&(t.port=this.getOutputById(e.port.id,{disconnected:!0})),this.emit(e.port.state,t);const n=Object.assign({},t);n.type="portschanged",this.emit(n.type,n)}}async _updateInputsAndOutputs(){return Promise.all([this._updateInputs(),this._updateOutputs()])}async _updateInputs(){if(!this.interface)return;for(let t=this._inputs.length-1;t>=0;t--){const n=this._inputs[t];Array.from(this.interface.inputs.values()).find(s=>s===n._midiInput)||(this._disconnectedInputs.push(n),this._inputs.splice(t,1))}let e=[];return this.interface.inputs.forEach(t=>{if(!this._inputs.find(n=>n._midiInput===t)){let n=this._disconnectedInputs.find(r=>r._midiInput===t);n||(n=new fa(t)),this._inputs.push(n),e.push(n.open())}}),Promise.all(e)}async _updateOutputs(){if(!this.interface)return;for(let t=this._outputs.length-1;t>=0;t--){const n=this._outputs[t];Array.from(this.interface.outputs.values()).find(s=>s===n._midiOutput)||(this._disconnectedOutputs.push(n),this._outputs.splice(t,1))}let e=[];return this.interface.outputs.forEach(t=>{if(!this._outputs.find(n=>n._midiOutput===t)){let n=this._disconnectedOutputs.find(r=>r._midiOutput===t);n||(n=new Ct(t)),this._outputs.push(n),e.push(n.open())}}),Promise.all(e)}get enabled(){return this.interface!==null}get inputs(){return this._inputs}get isNode(){return this.validation&&console.warn("WebMidi.isNode has been deprecated. Use Utilities.isNode instead."),A.isNode}get isBrowser(){return this.validation&&console.warn("WebMidi.isBrowser has been deprecated. Use Utilities.isBrowser instead."),A.isBrowser}get octaveOffset(){return this._octaveOffset}set octaveOffset(e){if(this.validation&&(e=parseInt(e),isNaN(e)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=e}get outputs(){return this._outputs}get supported(){return typeof navigator<"u"&&navigator.requestMIDIAccess}get sysexEnabled(){return!!(this.interface&&this.interface.sysexEnabled)}get time(){return performance.now()}get version(){return"3.1.7"}get flavour(){return"esm"}get CHANNEL_EVENTS(){return this.validation&&console.warn("The CHANNEL_EVENTS enum has been moved to Enumerations.CHANNEL_EVENTS."),b.CHANNEL_EVENTS}get MIDI_SYSTEM_MESSAGES(){return this.validation&&console.warn("The MIDI_SYSTEM_MESSAGES enum has been moved to Enumerations.SYSTEM_MESSAGES."),b.SYSTEM_MESSAGES}get MIDI_CHANNEL_MODE_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MODE_MESSAGES enum has been moved to Enumerations.CHANNEL_MODE_MESSAGES."),b.CHANNEL_MODE_MESSAGES}get MIDI_CONTROL_CHANGE_MESSAGES(){return this.validation&&console.warn("The MIDI_CONTROL_CHANGE_MESSAGES enum has been replaced by the Enumerations.CONTROL_CHANGE_MESSAGES array."),b.MIDI_CONTROL_CHANGE_MESSAGES}get MIDI_REGISTERED_PARAMETER(){return this.validation&&console.warn("The MIDI_REGISTERED_PARAMETER enum has been moved to Enumerations.REGISTERED_PARAMETERS."),b.REGISTERED_PARAMETERS}get NOTES(){return this.validation&&console.warn("The NOTES enum has been deprecated."),["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"]}}const R=new ua;R.constructor=null;const ct=(...i)=>{},nr=(i,e)=>{let t=i.ledOn==e.ledOn&&i.ledFlash==e.ledFlash&&i.controllerFlip==e.controllerFlip&&i.midiThru==e.midiThru;("i2cLeader"in i||"i2cLeader"in e)&&(t=t&&i.i2cLeader==e.i2cLeader),("faderMax"in i||"faderMax"in e)&&(t=t&&i.faderMax==e.faderMax&&i.faderMin==e.faderMin);let n=!0,r=!0;return i.usbControls.forEach((s,a)=>{const l=e.usbControls[a];(s.channel!=l.channel||s.cc!=l.cc)&&(n=!1)}),i.trsControls.forEach((s,a)=>{const l=e.trsControls[a];(s.channel!=l.channel||s.cc!=l.cc)&&(r=!1)}),t&&n&&r},Qe=i=>{const e=Array.from({length:84},()=>0),t=i.firmwareVersion.trim().split(".").map(f=>parseInt(f));e[0]=i.deviceId,e[1]=t[0],e[2]=t[1],e[3]=t[2],e[4]=i.ledOn?1:0,e[5]=i.ledFlash?1:0,e[6]=i.controllerFlip?1:0,e[7]=i.i2cLeader?1:0;const n=i.faderMin>>7,r=i.faderMin-(n<<7);e[8]=r,e[9]=n;const s=i.faderMax>>7,a=i.faderMax-(s<<7);e[10]=a,e[11]=s,e[12]=i.midiThru?1:0;const l=20,o=36,c=52,u=68;return i.usbControls.forEach((f,m)=>{e[m+l]=f.channel,e[m+c]=f.cc}),i.trsControls.forEach((f,m)=>{e[m+o]=f.channel,e[m+u]=f.cc}),e},ha=i=>Qe(i).slice(4,20),da=i=>{const e=Qe(i),t=e.slice(20,36),n=e.slice(52,68);return t.concat(n)},ma=i=>{const e=Qe(i),t=e.slice(36,52),n=e.slice(68,84);return t.concat(n)},pa=i=>{const e={...i},t=Re(i.deviceId).controlCount;return e.usbControls=e.usbControls.splice(0,t),e.usbControls.forEach(n=>delete n.val),e.trsControls=e.trsControls.splice(0,t),JSON.stringify(e,null,2)},Ea=(i,e)=>e.deviceId!=i.deviceId?`Cannot update - this data file is for a ${Re(e.deviceId).name}, but you are trying to install it on a ${Re(i.deviceId).name} `:!1,_a=(i,e)=>(Object.keys(e).forEach(t=>{i[t]=e[t]}),i),ga=i=>{const t=i[5],n=i[6]+"."+i[7]+"."+i[8],r=i[1+8]==1,s=i[2+8]==1,a=i[3+8]==1,l=i[4+8]==1,o=i[5+8],u=(i[6+8]<<7)+o,f=i[7+8],h=(i[8+8]<<7)+f,g=i[9+8]==1,P=[],w=[];return i.slice(17+8,33+8).forEach((I,v)=>{I!=127&&(P[v]={channel:I})}),i.slice(33+8,49+8).forEach((I,v)=>{I!=127&&(w[v]={channel:I})}),i.slice(49+8,65+8).forEach((I,v)=>{I!=127&&(P[v].cc=I)}),i.slice(65+8,81+8).forEach((I,v)=>{I!=127&&(w[v].cc=I)}),P.forEach(I=>I.val=0),{ledOn:r,ledFlash:s,controllerFlip:a,midiThru:g,usbControls:P,trsControls:w,deviceId:t,firmwareVersion:n,i2cLeader:l,faderMin:u,faderMax:h}},Re=i=>ba[i],Le=(i,e)=>!!Re(i.deviceId).capabilities[e],ba=[{name:"unknown",controlCount:0,capabilities:{}},{name:"Oxion development board",controlCount:4,capabilities:{led:!0}},{name:"16n",controlCount:16,capabilities:{i2c:!0,led:!0,faderCalibration:!0}},{name:"16n (LC)",controlCount:16,capabilities:{i2c:!0,led:!0,faderCalibration:!0},sendShortMessages:!0},{name:"16rx",controlCount:16,capabilities:{i2c:!0,led:!0}},{name:"16nx",controlCount:16,capabilities:{i2c:!0,led:!0}}],Ee={sysexMfgId:[125,0,0],requestInfoMsg:31,updateConfigMsg:14,updateDeviceOptionsMsg:13,updateUSBOptionsMessage:12,updateTRSOptionsMessage:11,factoryResetMsg:26},va=i=>i[1]==Ee.sysexMfgId[0]&&i[2]==Ee.sysexMfgId[1]&&i[3]==Ee.sysexMfgId[2],$a=(i,e)=>{Re(i.deviceId).sendShortMessages?Sa(i,e):Na(i,e)},Na=(i,e)=>{e.sendSysex(Ee.sysexMfgId,[Ee.updateConfigMsg,...Qe(i)])},Sa=(i,e)=>{e.sendSysex(Ee.sysexMfgId,[Ee.updateDeviceOptionsMsg,...ha(i)]),e.sendSysex(Ee.sysexMfgId,[Ee.updateUSBOptionsMessage,...da(i)]),e.sendSysex(Ee.sysexMfgId,[Ee.updateTRSOptionsMessage,...ma(i)])},rr=i=>{i.sendSysex(Ee.sysexMfgId,[Ee.requestInfoMsg])},sr=i=>{i.sendSysex(Ee.sysexMfgId,[Ee.factoryResetMsg])},_e=Se(null),ft=Se(!1),fe=Se(null),Ae=Se(!1),Be=Se([]),Xe=Se([]),We=Se(null),Me=Se(null),Gt=Se(!1);let st=-1;We.subscribe(i=>{i&&(ve(Be).forEach(e=>{e.removeListener()}),ar(i),lr(i),_e.set(null),Ft())});Me.subscribe(i=>{i&&(_e.set(null),Ft())});const wt=()=>R.inputs.sort(ir),It=()=>R.outputs.sort(ir),ir=(i,e)=>{const t=`${i.manufacturer} ${i.name}`,n=`${e.manufacturer} ${e.name}`;return t<n?-1:t>n?1:0},ya=()=>{Gt.set(!0),wa()},wa=()=>{Be.set(wt()),Xe.set(It()),rt(),R.addListener("connected",()=>{Be.set(wt()),Xe.set(It()),rt()}),R.addListener("disconnected",()=>{Be.set(wt()),Xe.set(It()),We.set(null),Me.set(null),_e.set(null),rt()}),setInterval(()=>{rt()},5e3)},rt=()=>{const i=ve(We),e=ve(Me);if(!i&&ve(Be).length>0){const t=ve(Be).find(n=>n.name.match(/.*16n.*/));t&&We.set(t)}if(!e&&ve(Xe).length>0){const t=ve(Xe).find(n=>n.name.match(/.*16n.*/));t&&Me.set(t)}!ve(_e)&&i&&e&&(ar(i),lr(i),Ft())},Ia=i=>{const e=ve(_e);e&&(e.usbControls.forEach(t=>{t.channel==i.message.channel&&t.cc==i.controller.number&&(t.val=i.rawValue)}),_e.set(e))},ar=i=>{i.addListener("controlchange",Ia)},lr=i=>{i.addListener("sysex",e=>{const t=e.message.data;va(t)&&t[4]==15&&(_e.set(ga(t)),ct("Received config",ve(_e)),st=-1,ft.set(!1))}),ct("Attached sysex listener to ",i.name)},Ft=()=>{st<0&&(st=Date.now()),Date.now()-st>8e3&&(ve(ft)||ft.set(!0));const i=ve(We),e=ve(Me);i&&e&&(ct("Requesting config over "+e.name),ct("Hoping to receive on "+i.name),rr(e))};function Ra(i){let e,t;return{c(){e=C("span"),this.h()},l(n){e=M(n,"SPAN",{class:!0}),D(e).forEach(p),this.h()},h(){L(e,"class",t="fas fa-"+i[0]+" "+i[1]+" svelte-pvbvkq")},m(n,r){N(n,e,r)},p(n,[r]){r&3&&t!==(t="fas fa-"+n[0]+" "+n[1]+" svelte-pvbvkq")&&L(e,"class",t)},i:le,o:le,d(n){n&&p(e)}}}function Aa(i,e,t){let{i:n}=e,{classList:r=""}=e;return i.$$set=s=>{"i"in s&&t(0,n=s.i),"classList"in s&&t(1,r=s.classList)},[n,r]}class Ca extends he{constructor(e){super(),de(this,e,Aa,Ra,me,{i:0,classList:1})}}function gn(i){let e,t;return e=new Ca({props:{i:i[1]}}),{c(){W(e.$$.fragment)},l(n){J(e.$$.fragment,n)},m(n,r){K(e,n,r),t=!0},p(n,r){const s={};r&2&&(s.i=n[1]),e.$set(s)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){T(e.$$.fragment,n),t=!1},d(n){Q(e,n)}}}function Ma(i){let e,t,n=i[1]&&i[1].trim()!=="",r,s,a,l,o,c=n&&gn(i);return{c(){e=C("div"),t=C("button"),c&&c.c(),r=x(),s=G(i[0]),this.h()},l(u){e=M(u,"DIV",{class:!0});var f=D(e);t=M(f,"BUTTON",{class:!0});var m=D(t);c&&c.l(m),r=j(m),s=F(m,i[0]),m.forEach(p),f.forEach(p),this.h()},h(){t.disabled=i[2],L(t,"class","svelte-1qu28ag"),L(e,"class","button-wrapper svelte-1qu28ag")},m(u,f){N(u,e,f),$(e,t),c&&c.m(t,null),$(t,r),$(t,s),a=!0,l||(o=be(t,"click",function(){dr(i[3])&&i[3].apply(this,arguments)}),l=!0)},p(u,[f]){i=u,f&2&&(n=i[1]&&i[1].trim()!==""),n?c?(c.p(i,f),f&2&&y(c,1)):(c=gn(i),c.c(),y(c,1),c.m(t,r)):c&&(oe(),T(c,1,1,()=>{c=null}),ce()),(!a||f&1)&&Ne(s,i[0]),(!a||f&4)&&(t.disabled=i[2])},i(u){a||(y(c),a=!0)},o(u){T(c),a=!1},d(u){u&&p(e),c&&c.d(),l=!1,o()}}}function Ta(i,e,t){let{label:n}=e,{icon:r=""}=e,{disabled:s=!1}=e,{click:a}=e;return i.$$set=l=>{"label"in l&&t(0,n=l.label),"icon"in l&&t(1,r=l.icon),"disabled"in l&&t(2,s=l.disabled),"click"in l&&t(3,a=l.click)},[n,r,s,a]}class Te extends he{constructor(e){super(),de(this,e,Ta,Ma,me,{label:0,icon:1,disabled:2,click:3})}}function bn(i){let e;function t(s,a){return s[2]?La:Oa}let n=t(i),r=n(i);return{c(){e=C("div"),r.c(),this.h()},l(s){e=M(s,"DIV",{class:!0});var a=D(e);r.l(a),a.forEach(p),this.h()},h(){L(e,"class","details svelte-ykry5x")},m(s,a){N(s,e,a),r.m(e,null)},p(s,a){n===(n=t(s))&&r?r.p(s,a):(r.d(1),r=n(s),r&&(r.c(),r.m(e,null)))},d(s){s&&p(e),r.d()}}}function Oa(i){let e,t;return{c(){e=C("p"),t=G("No device connected."),this.h()},l(n){e=M(n,"P",{class:!0});var r=D(e);t=F(r,"No device connected."),r.forEach(p),this.h()},h(){L(e,"class","device svelte-ykry5x")},m(n,r){N(n,e,r),$(e,t)},p:le,d(n){n&&p(e)}}}function La(i){let e,t,n,r=Re(i[2].deviceId).name+"",s,a,l,o=i[2].firmwareVersion+"",c,u,f=i[0].trim()!="",m=f&&vn(i);return{c(){e=C("p"),t=G("Connected: "),n=C("strong"),s=G(r),a=G(`
        running firmware
        `),l=C("strong"),c=G(o),u=x(),m&&m.c(),this.h()},l(h){e=M(h,"P",{class:!0});var g=D(e);t=F(g,"Connected: "),n=M(g,"STRONG",{});var P=D(n);s=F(P,r),P.forEach(p),a=F(g,`
        running firmware
        `),l=M(g,"STRONG",{});var w=D(l);c=F(w,o),w.forEach(p),u=j(g),m&&m.l(g),g.forEach(p),this.h()},h(){L(e,"class","device svelte-ykry5x")},m(h,g){N(h,e,g),$(e,t),$(e,n),$(n,s),$(e,a),$(e,l),$(l,c),$(e,u),m&&m.m(e,null)},p(h,g){g&4&&r!==(r=Re(h[2].deviceId).name+"")&&Ne(s,r),g&4&&o!==(o=h[2].firmwareVersion+"")&&Ne(c,o),g&1&&(f=h[0].trim()!=""),f?m?m.p(h,g):(m=vn(h),m.c(),m.m(e,null)):m&&(m.d(1),m=null)},d(h){h&&p(e),m&&m.d()}}}function vn(i){let e,t,n,r,s;return{c(){e=C("span"),t=G(i[0]),n=x(),r=C("a"),s=G("Download"),this.h()},l(a){e=M(a,"SPAN",{class:!0});var l=D(e);t=F(l,i[0]),n=j(l),r=M(l,"A",{href:!0});var o=D(r);s=F(o,"Download"),o.forEach(p),l.forEach(p),this.h()},h(){L(r,"href","https://github.com/16n-faderbank/16n/releases/latest"),L(e,"class","upgrade svelte-ykry5x")},m(a,l){N(a,e,l),$(e,t),$(e,n),$(e,r),$(r,s)},p(a,l){l&1&&Ne(t,a[0])},d(a){a&&p(e)}}}function Da(i){let e,t=i[1]&&bn(i);return{c(){t&&t.c(),e=re()},l(n){t&&t.l(n),e=re()},m(n,r){t&&t.m(n,r),N(n,e,r)},p(n,[r]){n[1]?t?t.p(n,r):(t=bn(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:le,o:le,d(n){t&&t.d(n),n&&p(e)}}}function ka(i,e,t){let n,r;se(i,Gt,c=>t(1,n=c)),se(i,_e,c=>t(2,r=c));let s="",a="2.1.1",l=!1;const o=_e.subscribe(c=>{c&&c.firmwareVersion&&a.trim()!==""&&!l&&(l=!0,Ce.gt(a,c.firmwareVersion)?t(0,s=`A new version of the 16n firmware (${a}) is available.`):t(0,s=""))});return Rt(()=>{o()}),[s,n,r]}class Pa extends he{constructor(e){super(),de(this,e,ka,Da,me,{})}}function Ba(i){let e,t,n,r,s,a,l;const o=i[2].default,c=Ve(o,i,i[1],null);return{c(){e=C("p"),t=C("label"),n=C("input"),r=x(),c&&c.c(),this.h()},l(u){e=M(u,"P",{});var f=D(e);t=M(f,"LABEL",{});var m=D(t);n=M(m,"INPUT",{type:!0}),r=j(m),c&&c.l(m),m.forEach(p),f.forEach(p),this.h()},h(){L(n,"type","checkbox")},m(u,f){N(u,e,f),$(e,t),$(t,n),n.checked=i[0],$(t,r),c&&c.m(t,null),s=!0,a||(l=be(n,"change",i[3]),a=!0)},p(u,[f]){f&1&&(n.checked=u[0]),c&&c.p&&(!s||f&2)&&He(c,o,u,u[1],s?je(o,u[1],f,null):xe(u[1]),null)},i(u){s||(y(c,u),s=!0)},o(u){T(c,u),s=!1},d(u){u&&p(e),c&&c.d(u),a=!1,l()}}}function Ua(i,e,t){let{$$slots:n={},$$scope:r}=e,{checked:s}=e;function a(){s=this.checked,t(0,s)}return i.$$set=l=>{"checked"in l&&t(0,s=l.checked),"$$scope"in l&&t(1,r=l.$$scope)},[s,r,n,a]}class ut extends he{constructor(e){super(),de(this,e,Ua,Ba,me,{checked:0})}}function $n(i){let e,t,n,r,s,a;function l(f){i[3](f)}let o={$$slots:{default:[Ga]},$$scope:{ctx:i}};i[0].ledOn!==void 0&&(o.checked=i[0].ledOn),e=new ut({props:o}),it.push(()=>at(e,"checked",l));function c(f){i[4](f)}let u={$$slots:{default:[Fa]},$$scope:{ctx:i}};return i[0].ledFlash!==void 0&&(u.checked=i[0].ledFlash),r=new ut({props:u}),it.push(()=>at(r,"checked",c)),{c(){W(e.$$.fragment),n=x(),W(r.$$.fragment)},l(f){J(e.$$.fragment,f),n=j(f),J(r.$$.fragment,f)},m(f,m){K(e,f,m),N(f,n,m),K(r,f,m),a=!0},p(f,m){const h={};m&1024&&(h.$$scope={dirty:m,ctx:f}),!t&&m&1&&(t=!0,h.checked=f[0].ledOn,lt(()=>t=!1)),e.$set(h);const g={};m&1024&&(g.$$scope={dirty:m,ctx:f}),!s&&m&1&&(s=!0,g.checked=f[0].ledFlash,lt(()=>s=!1)),r.$set(g)},i(f){a||(y(e.$$.fragment,f),y(r.$$.fragment,f),a=!0)},o(f){T(e.$$.fragment,f),T(r.$$.fragment,f),a=!1},d(f){Q(e,f),f&&p(n),Q(r,f)}}}function Ga(i){let e;return{c(){e=G("LED permanently on when powered")},l(t){e=F(t,"LED permanently on when powered")},m(t,n){N(t,e,n)},d(t){t&&p(e)}}}function Fa(i){let e;return{c(){e=G("LED flash on MIDI activity")},l(t){e=F(t,"LED flash on MIDI activity")},m(t,n){N(t,e,n)},d(t){t&&p(e)}}}function Va(i){let e;return{c(){e=G("Rotate controller 180")},l(t){e=F(t,"Rotate controller 180")},m(t,n){N(t,e,n)},d(t){t&&p(e)}}}function Nn(i){let e,t,n;function r(a){i[6](a)}let s={$$slots:{default:[Ha]},$$scope:{ctx:i}};return i[0].midiThru!==void 0&&(s.checked=i[0].midiThru),e=new ut({props:s}),it.push(()=>at(e,"checked",r)),{c(){W(e.$$.fragment)},l(a){J(e.$$.fragment,a)},m(a,l){K(e,a,l),n=!0},p(a,l){const o={};l&1024&&(o.$$scope={dirty:l,ctx:a}),!t&&l&1&&(t=!0,o.checked=a[0].midiThru,lt(()=>t=!1)),e.$set(o)},i(a){n||(y(e.$$.fragment,a),n=!0)},o(a){T(e.$$.fragment,a),n=!1},d(a){Q(e,a)}}}function Ha(i){let e;return{c(){e=G("Soft MIDI thru (echo MIDI clock/note data sent to USB out of the minijack)")},l(t){e=F(t,"Soft MIDI thru (echo MIDI clock/note data sent to USB out of the minijack)")},m(t,n){N(t,e,n)},d(t){t&&p(e)}}}function Sn(i){let e,t,n,r,s,a,l,o,c,u,f,m,h,g,P,w,I,v,_,d,O,B,Y,ee,te,ae,pe;return{c(){e=C("hr"),t=x(),n=C("h3"),r=G("Fader Minimum/Maximum calibration"),s=x(),a=C("div"),l=C("label"),o=G("Fader Minimum raw value"),c=x(),u=C("input"),f=x(),m=C("div"),h=C("label"),g=G("Fader Maximum raw value"),P=x(),w=C("input"),I=x(),v=C("p"),_=G(`You shouldn't touch this unless you are having issues with your faders
    either reaching `),d=C("code"),O=G("127"),B=G(`
    before the end of their travel, or not at all.`),Y=C("br"),ee=C("br"),te=G(`
    "Raw" analog values are read from the faders between 0 and 8192. Bring the fader
    maximum down until all faders smoothly travel from 0 to 127 on the debug view
    (bearing in mind there is a small dead zone at either end of a fader).`),this.h()},l(z){e=M(z,"HR",{}),t=j(z),n=M(z,"H3",{});var E=D(n);r=F(E,"Fader Minimum/Maximum calibration"),E.forEach(p),s=j(z),a=M(z,"DIV",{});var S=D(a);l=M(S,"LABEL",{for:!0,class:!0});var H=D(l);o=F(H,"Fader Minimum raw value"),H.forEach(p),c=j(S),u=M(S,"INPUT",{name:!0,type:!0,min:!0,max:!0}),S.forEach(p),f=j(z),m=M(z,"DIV",{});var U=D(m);h=M(U,"LABEL",{for:!0,class:!0});var V=D(h);g=F(V,"Fader Maximum raw value"),V.forEach(p),P=j(U),w=M(U,"INPUT",{name:!0,type:!0,min:!0,max:!0}),U.forEach(p),I=j(z),v=M(z,"P",{class:!0});var k=D(v);_=F(k,`You shouldn't touch this unless you are having issues with your faders
    either reaching `),d=M(k,"CODE",{});var q=D(d);O=F(q,"127"),q.forEach(p),B=F(k,`
    before the end of their travel, or not at all.`),Y=M(k,"BR",{}),ee=M(k,"BR",{}),te=F(k,`
    "Raw" analog values are read from the faders between 0 and 8192. Bring the fader
    maximum down until all faders smoothly travel from 0 to 127 on the debug view
    (bearing in mind there is a small dead zone at either end of a fader).`),k.forEach(p),this.h()},h(){L(l,"for","faderMin"),L(l,"class","svelte-idpdcv"),L(u,"name","faderMin"),L(u,"type","number"),L(u,"min","0"),L(u,"max",8192-1),L(h,"for","faderMax"),L(h,"class","svelte-idpdcv"),L(w,"name","faderMax"),L(w,"type","number"),L(w,"min","0"),L(w,"max",8192-1),L(v,"class","note svelte-idpdcv")},m(z,E){N(z,e,E),N(z,t,E),N(z,n,E),$(n,r),N(z,s,E),N(z,a,E),$(a,l),$(l,o),$(a,c),$(a,u),De(u,i[0].faderMin),N(z,f,E),N(z,m,E),$(m,h),$(h,g),$(m,P),$(m,w),De(w,i[0].faderMax),N(z,I,E),N(z,v,E),$(v,_),$(v,d),$(d,O),$(v,B),$(v,Y),$(v,ee),$(v,te),ae||(pe=[be(u,"input",i[7]),be(u,"blur",i[2]),be(w,"input",i[8]),be(w,"blur",i[2])],ae=!0)},p(z,E){E&1&&Fe(u.value)!==z[0].faderMin&&De(u,z[0].faderMin),E&1&&Fe(w.value)!==z[0].faderMax&&De(w,z[0].faderMax)},d(z){z&&p(e),z&&p(t),z&&p(n),z&&p(s),z&&p(a),z&&p(f),z&&p(m),z&&p(I),z&&p(v),ae=!1,Mt(pe)}}}function yn(i){let e,t,n,r,s,a,l,o,c,u,f,m,h,g,P,w,I,v,_,d,O,B,Y,ee,te,ae,pe,z;return{c(){e=C("hr"),t=x(),n=C("h3"),r=G("I2C Leader/Follower"),s=x(),a=C("select"),l=C("option"),o=G("Follower"),c=C("option"),u=G("Leader"),f=x(),m=C("p"),h=C("strong"),g=G("Follower"),P=G(" mode is for use with Teletype."),w=x(),I=C("p"),v=C("strong"),_=G("Leader"),d=G(` mode is for use with Ansible, TXo, ER-301. 16n will not
    respond to Teletype when in leader mode.`),O=x(),B=C("p"),Y=G("This will not take effect until you restart (disconnect/reconnect) your 16n."),ee=x(),te=C("p"),ae=G(`("Leader" is sometimes also referred to as 'master' mode)`),this.h()},l(E){e=M(E,"HR",{}),t=j(E),n=M(E,"H3",{});var S=D(n);r=F(S,"I2C Leader/Follower"),S.forEach(p),s=j(E),a=M(E,"SELECT",{});var H=D(a);l=M(H,"OPTION",{});var U=D(l);o=F(U,"Follower"),U.forEach(p),c=M(H,"OPTION",{});var V=D(c);u=F(V,"Leader"),V.forEach(p),H.forEach(p),f=j(E),m=M(E,"P",{class:!0});var k=D(m);h=M(k,"STRONG",{});var q=D(h);g=F(q,"Follower"),q.forEach(p),P=F(k," mode is for use with Teletype."),k.forEach(p),w=j(E),I=M(E,"P",{class:!0});var Z=D(I);v=M(Z,"STRONG",{});var X=D(v);_=F(X,"Leader"),X.forEach(p),d=F(Z,` mode is for use with Ansible, TXo, ER-301. 16n will not
    respond to Teletype when in leader mode.`),Z.forEach(p),O=j(E),B=M(E,"P",{class:!0});var ne=D(B);Y=F(ne,"This will not take effect until you restart (disconnect/reconnect) your 16n."),ne.forEach(p),ee=j(E),te=M(E,"P",{class:!0});var ue=D(te);ae=F(ue,`("Leader" is sometimes also referred to as 'master' mode)`),ue.forEach(p),this.h()},h(){l.__value=!1,l.value=l.__value,c.__value=!0,c.value=c.__value,i[0].i2cLeader===void 0&&jn(()=>i[9].call(a)),L(m,"class","note svelte-idpdcv"),L(I,"class","note svelte-idpdcv"),L(B,"class","note svelte-idpdcv"),L(te,"class","note small svelte-idpdcv")},m(E,S){N(E,e,S),N(E,t,S),N(E,n,S),$(n,r),N(E,s,S),N(E,a,S),$(a,l),$(l,o),$(a,c),$(c,u),ot(a,i[0].i2cLeader,!0),N(E,f,S),N(E,m,S),$(m,h),$(h,g),$(m,P),N(E,w,S),N(E,I,S),$(I,v),$(v,_),$(I,d),N(E,O,S),N(E,B,S),$(B,Y),N(E,ee,S),N(E,te,S),$(te,ae),pe||(z=[be(a,"change",i[9]),be(a,"change",i[2])],pe=!0)},p(E,S){S&1&&ot(a,E[0].i2cLeader)},d(E){E&&p(e),E&&p(t),E&&p(n),E&&p(s),E&&p(a),E&&p(f),E&&p(m),E&&p(w),E&&p(I),E&&p(O),E&&p(B),E&&p(ee),E&&p(te),pe=!1,Mt(z)}}}function xa(i){let e=Le(i[1],"led"),t,n,r,s,a=Ce.gte(i[1].firmwareVersion,"2.1.0"),l,o=Le(i[1],"faderCalibration"),c,u=Le(i[1],"i2c"),f,m,h=e&&$n(i);function g(_){i[5](_)}let P={$$slots:{default:[Va]},$$scope:{ctx:i}};i[0].controllerFlip!==void 0&&(P.checked=i[0].controllerFlip),n=new ut({props:P}),it.push(()=>at(n,"checked",g));let w=a&&Nn(i),I=o&&Sn(i),v=u&&yn(i);return{c(){h&&h.c(),t=x(),W(n.$$.fragment),s=x(),w&&w.c(),l=x(),I&&I.c(),c=x(),v&&v.c(),f=re()},l(_){h&&h.l(_),t=j(_),J(n.$$.fragment,_),s=j(_),w&&w.l(_),l=j(_),I&&I.l(_),c=j(_),v&&v.l(_),f=re()},m(_,d){h&&h.m(_,d),N(_,t,d),K(n,_,d),N(_,s,d),w&&w.m(_,d),N(_,l,d),I&&I.m(_,d),N(_,c,d),v&&v.m(_,d),N(_,f,d),m=!0},p(_,[d]){d&2&&(e=Le(_[1],"led")),e?h?(h.p(_,d),d&2&&y(h,1)):(h=$n(_),h.c(),y(h,1),h.m(t.parentNode,t)):h&&(oe(),T(h,1,1,()=>{h=null}),ce());const O={};d&1024&&(O.$$scope={dirty:d,ctx:_}),!r&&d&1&&(r=!0,O.checked=_[0].controllerFlip,lt(()=>r=!1)),n.$set(O),d&2&&(a=Ce.gte(_[1].firmwareVersion,"2.1.0")),a?w?(w.p(_,d),d&2&&y(w,1)):(w=Nn(_),w.c(),y(w,1),w.m(l.parentNode,l)):w&&(oe(),T(w,1,1,()=>{w=null}),ce()),d&2&&(o=Le(_[1],"faderCalibration")),o?I?I.p(_,d):(I=Sn(_),I.c(),I.m(c.parentNode,c)):I&&(I.d(1),I=null),d&2&&(u=Le(_[1],"i2c")),u?v?v.p(_,d):(v=yn(_),v.c(),v.m(f.parentNode,f)):v&&(v.d(1),v=null)},i(_){m||(y(h),y(n.$$.fragment,_),y(w),m=!0)},o(_){T(h),T(n.$$.fragment,_),T(w),m=!1},d(_){h&&h.d(_),_&&p(t),Q(n,_),_&&p(s),w&&w.d(_),_&&p(l),I&&I.d(_),_&&p(c),v&&v.d(_),_&&p(f)}}}function ja(i,e,t){let n,r;se(i,fe,h=>t(0,n=h)),se(i,_e,h=>t(1,r=h));const s=()=>{fe.set(n)};function a(h){i.$$.not_equal(n.ledOn,h)&&(n.ledOn=h,fe.set(n))}function l(h){i.$$.not_equal(n.ledFlash,h)&&(n.ledFlash=h,fe.set(n))}function o(h){i.$$.not_equal(n.controllerFlip,h)&&(n.controllerFlip=h,fe.set(n))}function c(h){i.$$.not_equal(n.midiThru,h)&&(n.midiThru=h,fe.set(n))}function u(){n.faderMin=Fe(this.value),fe.set(n)}function f(){n.faderMax=Fe(this.value),fe.set(n)}function m(){n.i2cLeader=qn(this),fe.set(n)}return[n,r,s,a,l,o,c,u,f,m]}class qa extends he{constructor(e){super(),de(this,e,ja,xa,me,{})}}function wn(i,e,t){const n=i.slice();return n[8]=e[t],n}function In(i){let e,t=i[8]+"",n,r;return{c(){e=C("option"),n=G(t),this.h()},l(s){e=M(s,"OPTION",{});var a=D(e);n=F(a,t),a.forEach(p),this.h()},h(){e.__value=r=i[8],e.value=e.__value},m(s,a){N(s,e,a),$(e,n)},p(s,a){a&4&&t!==(t=s[8]+"")&&Ne(n,t),a&4&&r!==(r=s[8])&&(e.__value=r,e.value=e.__value)},d(s){s&&p(e)}}}function Ya(i){let e,t,n=i[1]+1+"",r,s,a,l,o,c,u,f,m,h,g,P,w=i[2],I=[];for(let v=0;v<w.length;v+=1)I[v]=In(wn(i,w,v));return{c(){e=C("dl"),t=C("dt"),r=G(n),s=C("dt"),a=G("Channel"),l=C("dd"),o=C("select");for(let v=0;v<I.length;v+=1)I[v].c();c=x(),u=C("dt"),f=G("CC"),m=C("dd"),h=C("input"),this.h()},l(v){e=M(v,"DL",{class:!0});var _=D(e);t=M(_,"DT",{class:!0});var d=D(t);r=F(d,n),d.forEach(p),s=M(_,"DT",{class:!0});var O=D(s);a=F(O,"Channel"),O.forEach(p),l=M(_,"DD",{class:!0});var B=D(l);o=M(B,"SELECT",{});var Y=D(o);for(let ae=0;ae<I.length;ae+=1)I[ae].l(Y);Y.forEach(p),c=j(B),B.forEach(p),u=M(_,"DT",{class:!0});var ee=D(u);f=F(ee,"CC"),ee.forEach(p),m=M(_,"DD",{class:!0});var te=D(m);h=M(te,"INPUT",{type:!0,min:!0,max:!0,class:!0}),te.forEach(p),_.forEach(p),this.h()},h(){L(t,"class","index svelte-gqdu21"),L(s,"class","svelte-gqdu21"),i[0].channel===void 0&&jn(()=>i[5].call(o)),L(l,"class","svelte-gqdu21"),L(u,"class","svelte-gqdu21"),L(h,"type","number"),L(h,"min","0"),L(h,"max","127"),L(h,"class","svelte-gqdu21"),L(m,"class","svelte-gqdu21"),L(e,"class","config-column svelte-gqdu21")},m(v,_){N(v,e,_),$(e,t),$(t,r),$(e,s),$(s,a),$(e,l),$(l,o);for(let d=0;d<I.length;d+=1)I[d]&&I[d].m(o,null);ot(o,i[0].channel,!0),$(l,c),$(e,u),$(u,f),$(e,m),$(m,h),De(h,i[0].cc),g||(P=[be(o,"change",i[5]),be(o,"change",i[3]),be(h,"input",i[6]),be(h,"change",i[4]),be(h,"blur",i[4])],g=!0)},p(v,[_]){if(_&2&&n!==(n=v[1]+1+"")&&Ne(r,n),_&4){w=v[2];let d;for(d=0;d<w.length;d+=1){const O=wn(v,w,d);I[d]?I[d].p(O,_):(I[d]=In(O),I[d].c(),I[d].m(o,null))}for(;d<I.length;d+=1)I[d].d(1);I.length=w.length}_&5&&ot(o,v[0].channel),_&5&&Fe(h.value)!==v[0].cc&&De(h,v[0].cc)},i:le,o:le,d(v){v&&p(e),Je(I,v),g=!1,Mt(P)}}}function za(i,e,t){let n;se(i,fe,f=>t(7,n=f));let{index:r}=e,{editControl:s}=e;const a=Array.from(Array(16).keys());a.forEach((f,m)=>t(2,a[m]=f+1,a));const l=()=>{fe.set(n)},o=f=>{const m=f.target;parseInt(m.value)<0&&t(0,s.cc=0,s),parseInt(m.value)>127&&t(0,s.cc=127,s),fe.set(n)};function c(){s.channel=qn(this),t(0,s),t(2,a)}function u(){s.cc=Fe(this.value),t(0,s),t(2,a)}return i.$$set=f=>{"index"in f&&t(1,r=f.index),"editControl"in f&&t(0,s=f.editControl)},[s,r,a,l,o,c,u]}class or extends he{constructor(e){super(),de(this,e,za,Ya,me,{index:1,editControl:0})}}function Xa(i){let e,t,n,r,s,a,l,o;return l=new Te({props:{label:"Reset controller configuration to defaults",icon:"history",click:i[0]}}),l.$on("message",i[1]),{c(){e=C("p"),t=G(`"Factory Reset" will reset the configuration of your 16n back to 'default'
  values; primarily, MIDI CCs 32-48, Channel 1, for both TRS and USB MIDI.`),n=x(),r=C("p"),s=G(`Note that this will also reset any calibration data or other options you may
  have adjusted on the "Device Options" tab. You will need to repeat this
  configuration after performing a reset.`),a=x(),W(l.$$.fragment)},l(c){e=M(c,"P",{});var u=D(e);t=F(u,`"Factory Reset" will reset the configuration of your 16n back to 'default'
  values; primarily, MIDI CCs 32-48, Channel 1, for both TRS and USB MIDI.`),u.forEach(p),n=j(c),r=M(c,"P",{});var f=D(r);s=F(f,`Note that this will also reset any calibration data or other options you may
  have adjusted on the "Device Options" tab. You will need to repeat this
  configuration after performing a reset.`),f.forEach(p),a=j(c),J(l.$$.fragment,c)},m(c,u){N(c,e,u),$(e,t),N(c,n,u),N(c,r,u),$(r,s),N(c,a,u),K(l,c,u),o=!0},p:le,i(c){o||(y(l.$$.fragment,c),o=!0)},o(c){T(l.$$.fragment,c),o=!1},d(c){c&&p(e),c&&p(n),c&&p(r),c&&p(a),Q(l,c)}}}const Wa="Confirm that you wish to reset your controller configuration to the default values. You will lose any configuration stored on the controller.";function Ja(i,e,t){let n,r;se(i,Me,l=>t(2,n=l)),se(i,Ae,l=>t(3,r=l));const s=()=>{confirm(Wa)&&(Pe(Ae,r=!1,r),sr(n),setTimeout(()=>{rr(n)},50))};function a(l){Yn.call(this,i,l)}return[s,a]}class Ka extends he{constructor(e){super(),de(this,e,Ja,Xa,me,{})}}function Qa(i){let e,t,n,r,s,a;const l=i[2].default,o=Ve(l,i,i[1],null);return{c(){e=C("div"),t=C("h2"),n=G(i[0]),r=x(),s=C("div"),o&&o.c(),this.h()},l(c){e=M(c,"DIV",{class:!0});var u=D(e);t=M(u,"H2",{class:!0});var f=D(t);n=F(f,i[0]),f.forEach(p),r=j(u),s=M(u,"DIV",{class:!0});var m=D(s);o&&o.l(m),m.forEach(p),u.forEach(p),this.h()},h(){L(t,"class","svelte-1o2kpty"),L(s,"class","details svelte-1o2kpty"),L(e,"class","subhead svelte-1o2kpty")},m(c,u){N(c,e,u),$(e,t),$(t,n),$(e,r),$(e,s),o&&o.m(s,null),a=!0},p(c,[u]){(!a||u&1)&&Ne(n,c[0]),o&&o.p&&(!a||u&2)&&He(o,l,c,c[1],a?je(l,c[1],u,null):xe(c[1]),null)},i(c){a||(y(o,c),a=!0)},o(c){T(o,c),a=!1},d(c){c&&p(e),o&&o.d(c)}}}function Za(i,e,t){let{$$slots:n={},$$scope:r}=e,{title:s}=e;return i.$$set=a=>{"title"in a&&t(0,s=a.title),"$$scope"in a&&t(1,r=a.$$scope)},[s,r,n]}class cr extends he{constructor(e){super(),de(this,e,Za,Qa,me,{title:0})}}function el(i){let e,t;const n=i[1].default,r=Ve(n,i,i[0],null);return{c(){e=C("div"),r&&r.c(),this.h()},l(s){e=M(s,"DIV",{class:!0});var a=D(e);r&&r.l(a),a.forEach(p),this.h()},h(){L(e,"class","tabs")},m(s,a){N(s,e,a),r&&r.m(e,null),t=!0},p(s,[a]){r&&r.p&&(!t||a&1)&&He(r,n,s,s[0],t?je(n,s[0],a,null):xe(s[0]),null)},i(s){t||(y(r,s),t=!0)},o(s){T(r,s),t=!1},d(s){s&&p(e),r&&r.d(s)}}}const Vt={};function tl(i,e,t){let{$$slots:n={},$$scope:r}=e;const s=[],a=[],l=Se(null),o=Se(null);return mr(Vt,{registerTab:c=>{s.push(c),l.update(u=>u||c),Rt(()=>{const u=s.indexOf(c);s.splice(u,1),l.update(f=>f===c?s[u]||s[s.length-1]:f)})},registerPanel:c=>{a.push(c),o.update(u=>u||c),Rt(()=>{const u=a.indexOf(c);a.splice(u,1),o.update(f=>f===c?a[u]||a[a.length-1]:f)})},selectTab:c=>{const u=s.indexOf(c);l.set(c),o.set(a[u])},selectedTab:l,selectedPanel:o}),i.$$set=c=>{"$$scope"in c&&t(0,r=c.$$scope)},[r,n]}class fr extends he{constructor(e){super(),de(this,e,tl,el,me,{})}}function nl(i){let e,t;const n=i[1].default,r=Ve(n,i,i[0],null);return{c(){e=C("div"),r&&r.c(),this.h()},l(s){e=M(s,"DIV",{class:!0});var a=D(e);r&&r.l(a),a.forEach(p),this.h()},h(){L(e,"class","tab-list svelte-1c799zm")},m(s,a){N(s,e,a),r&&r.m(e,null),t=!0},p(s,[a]){r&&r.p&&(!t||a&1)&&He(r,n,s,s[0],t?je(n,s[0],a,null):xe(s[0]),null)},i(s){t||(y(r,s),t=!0)},o(s){T(r,s),t=!1},d(s){s&&p(e),r&&r.d(s)}}}function rl(i,e,t){let{$$slots:n={},$$scope:r}=e;return i.$$set=s=>{"$$scope"in s&&t(0,r=s.$$scope)},[r,n]}class ur extends he{constructor(e){super(),de(this,e,rl,nl,me,{})}}function Rn(i){let e;const t=i[4].default,n=Ve(t,i,i[3],null);return{c(){n&&n.c()},l(r){n&&n.l(r)},m(r,s){n&&n.m(r,s),e=!0},p(r,s){n&&n.p&&(!e||s&8)&&He(n,t,r,r[3],e?je(t,r[3],s,null):xe(r[3]),null)},i(r){e||(y(n,r),e=!0)},o(r){T(n,r),e=!1},d(r){n&&n.d(r)}}}function sl(i){let e,t,n=i[0]===i[1]&&Rn(i);return{c(){n&&n.c(),e=re()},l(r){n&&n.l(r),e=re()},m(r,s){n&&n.m(r,s),N(r,e,s),t=!0},p(r,[s]){r[0]===r[1]?n?(n.p(r,s),s&1&&y(n,1)):(n=Rn(r),n.c(),y(n,1),n.m(e.parentNode,e)):n&&(oe(),T(n,1,1,()=>{n=null}),ce())},i(r){t||(y(n),t=!0)},o(r){T(n),t=!1},d(r){n&&n.d(r),r&&p(e)}}}function il(i,e,t){let n,{$$slots:r={},$$scope:s}=e;const a={},{registerPanel:l,selectedPanel:o}=zn(Vt);return se(i,o,c=>t(0,n=c)),l(a),i.$$set=c=>{"$$scope"in c&&t(3,s=c.$$scope)},[n,a,o,s,r]}class Ue extends he{constructor(e){super(),de(this,e,il,sl,me,{})}}function al(i){let e,t,n,r;const s=i[5].default,a=Ve(s,i,i[4],null);return{c(){e=C("button"),a&&a.c(),this.h()},l(l){e=M(l,"BUTTON",{class:!0});var o=D(e);a&&a.l(o),o.forEach(p),this.h()},h(){L(e,"class","svelte-1rryekj"),Ht(e,"selected",i[0]===i[1])},m(l,o){N(l,e,o),a&&a.m(e,null),t=!0,n||(r=be(e,"click",i[6]),n=!0)},p(l,[o]){a&&a.p&&(!t||o&16)&&He(a,s,l,l[4],t?je(s,l[4],o,null):xe(l[4]),null),(!t||o&3)&&Ht(e,"selected",l[0]===l[1])},i(l){t||(y(a,l),t=!0)},o(l){T(a,l),t=!1},d(l){l&&p(e),a&&a.d(l),n=!1,r()}}}function ll(i,e,t){let n,{$$slots:r={},$$scope:s}=e;const a={},{registerTab:l,selectTab:o,selectedTab:c}=zn(Vt);se(i,c,f=>t(0,n=f)),l(a);const u=()=>o(a);return i.$$set=f=>{"$$scope"in f&&t(4,s=f.$$scope)},[n,a,o,c,s,r,u]}class Ge extends he{constructor(e){super(),de(this,e,ll,al,me,{})}}const ol=(i,e)=>{const t=document.createElement("input");t.type="file",t.id="uploadedConfig",t.addEventListener("change",n=>{const r=n.target.files;if(r&&r.length>0){const s=r[0],a=new FileReader;a.addEventListener("load",()=>{const l=JSON.parse(a.result),o=Ea(i,l);if(o){alert(o);return}else fe.update(()=>_a(i,l)),nr(i,e)?alert("Imported configuration is identical to currently loaded configuration; no changes to upload."):alert("New configuration imported. Choose 'update controller' to import, or 'Cancel' to abort")}),a.readAsText(s)}}),t.click(),t.remove()},cl=i=>{const e="data:text/json;charset=utf-8,"+encodeURIComponent(pa(i)),t=document.createElement("a");t.href=e,t.download=`${Re(i.deviceId).name}_controller_config.json`,document.body.appendChild(t),t.click(),t.remove()};function An(i,e,t){const n=i.slice();return n[10]=e[t],n[12]=t,n}function Cn(i,e,t){const n=i.slice();return n[10]=e[t],n[12]=t,n}function fl(i){let e,t,n,r,s,a;return e=new Te({props:{label:"Cancel",icon:"times",click:i[4]}}),n=new Te({props:{label:"Import config",icon:"file-import",click:i[5]}}),s=new Te({props:{label:"Update controller",icon:"download",click:i[6],disabled:!i[1]}}),{c(){W(e.$$.fragment),t=x(),W(n.$$.fragment),r=x(),W(s.$$.fragment)},l(l){J(e.$$.fragment,l),t=j(l),J(n.$$.fragment,l),r=j(l),J(s.$$.fragment,l)},m(l,o){K(e,l,o),N(l,t,o),K(n,l,o),N(l,r,o),K(s,l,o),a=!0},p(l,o){const c={};o&2&&(c.disabled=!l[1]),s.$set(c)},i(l){a||(y(e.$$.fragment,l),y(n.$$.fragment,l),y(s.$$.fragment,l),a=!0)},o(l){T(e.$$.fragment,l),T(n.$$.fragment,l),T(s.$$.fragment,l),a=!1},d(l){Q(e,l),l&&p(t),Q(n,l),l&&p(r),Q(s,l)}}}function ul(i){let e;return{c(){e=G("USB")},l(t){e=F(t,"USB")},m(t,n){N(t,e,n)},d(t){t&&p(e)}}}function hl(i){let e;return{c(){e=G("TRS Jack")},l(t){e=F(t,"TRS Jack")},m(t,n){N(t,e,n)},d(t){t&&p(e)}}}function dl(i){let e;return{c(){e=G("Device Options")},l(t){e=F(t,"Device Options")},m(t,n){N(t,e,n)},d(t){t&&p(e)}}}function Mn(i){let e,t;return e=new Ge({props:{$$slots:{default:[ml]},$$scope:{ctx:i}}}),{c(){W(e.$$.fragment)},l(n){J(e.$$.fragment,n)},m(n,r){K(e,n,r),t=!0},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){T(e.$$.fragment,n),t=!1},d(n){Q(e,n)}}}function ml(i){let e;return{c(){e=G("Factory Reset")},l(t){e=F(t,"Factory Reset")},m(t,n){N(t,e,n)},d(t){t&&p(e)}}}function pl(i){let e,t,n,r,s,a,l=Ce.gte(i[0].firmwareVersion,"2.1.0"),o,c;e=new Ge({props:{$$slots:{default:[ul]},$$scope:{ctx:i}}}),n=new Ge({props:{$$slots:{default:[hl]},$$scope:{ctx:i}}}),s=new Ge({props:{$$slots:{default:[dl]},$$scope:{ctx:i}}});let u=l&&Mn(i);return{c(){W(e.$$.fragment),t=x(),W(n.$$.fragment),r=x(),W(s.$$.fragment),a=x(),u&&u.c(),o=re()},l(f){J(e.$$.fragment,f),t=j(f),J(n.$$.fragment,f),r=j(f),J(s.$$.fragment,f),a=j(f),u&&u.l(f),o=re()},m(f,m){K(e,f,m),N(f,t,m),K(n,f,m),N(f,r,m),K(s,f,m),N(f,a,m),u&&u.m(f,m),N(f,o,m),c=!0},p(f,m){const h={};m&16384&&(h.$$scope={dirty:m,ctx:f}),e.$set(h);const g={};m&16384&&(g.$$scope={dirty:m,ctx:f}),n.$set(g);const P={};m&16384&&(P.$$scope={dirty:m,ctx:f}),s.$set(P),m&1&&(l=Ce.gte(f[0].firmwareVersion,"2.1.0")),l?u?m&1&&y(u,1):(u=Mn(f),u.c(),y(u,1),u.m(o.parentNode,o)):u&&(oe(),T(u,1,1,()=>{u=null}),ce())},i(f){c||(y(e.$$.fragment,f),y(n.$$.fragment,f),y(s.$$.fragment,f),y(u),c=!0)},o(f){T(e.$$.fragment,f),T(n.$$.fragment,f),T(s.$$.fragment,f),T(u),c=!1},d(f){Q(e,f),f&&p(t),Q(n,f),f&&p(r),Q(s,f),f&&p(a),u&&u.d(f),f&&p(o)}}}function Tn(i){let e,t;return e=new or({props:{editControl:i[10],index:i[12]}}),{c(){W(e.$$.fragment)},l(n){J(e.$$.fragment,n)},m(n,r){K(e,n,r),t=!0},p(n,r){const s={};r&8&&(s.editControl=n[10]),e.$set(s)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){T(e.$$.fragment,n),t=!1},d(n){Q(e,n)}}}function On(i){let e,t,n=i[2]&&i[12]<i[2].controlCount&&Tn(i);return{c(){n&&n.c(),e=re()},l(r){n&&n.l(r),e=re()},m(r,s){n&&n.m(r,s),N(r,e,s),t=!0},p(r,s){r[2]&&r[12]<r[2].controlCount?n?(n.p(r,s),s&4&&y(n,1)):(n=Tn(r),n.c(),y(n,1),n.m(e.parentNode,e)):n&&(oe(),T(n,1,1,()=>{n=null}),ce())},i(r){t||(y(n),t=!0)},o(r){T(n),t=!1},d(r){n&&n.d(r),r&&p(e)}}}function El(i){let e,t,n=i[3].usbControls,r=[];for(let a=0;a<n.length;a+=1)r[a]=On(Cn(i,n,a));const s=a=>T(r[a],1,1,()=>{r[a]=null});return{c(){e=C("div");for(let a=0;a<r.length;a+=1)r[a].c();this.h()},l(a){e=M(a,"DIV",{id:!0,class:!0});var l=D(e);for(let o=0;o<r.length;o+=1)r[o].l(l);l.forEach(p),this.h()},h(){L(e,"id","controls"),L(e,"class","svelte-13ul1lp")},m(a,l){N(a,e,l);for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(e,null);t=!0},p(a,l){if(l&12){n=a[3].usbControls;let o;for(o=0;o<n.length;o+=1){const c=Cn(a,n,o);r[o]?(r[o].p(c,l),y(r[o],1)):(r[o]=On(c),r[o].c(),y(r[o],1),r[o].m(e,null))}for(oe(),o=n.length;o<r.length;o+=1)s(o);ce()}},i(a){if(!t){for(let l=0;l<n.length;l+=1)y(r[l]);t=!0}},o(a){r=r.filter(Boolean);for(let l=0;l<r.length;l+=1)T(r[l]);t=!1},d(a){a&&p(e),Je(r,a)}}}function Ln(i){let e,t;return e=new or({props:{editControl:i[10],index:i[12]}}),{c(){W(e.$$.fragment)},l(n){J(e.$$.fragment,n)},m(n,r){K(e,n,r),t=!0},p(n,r){const s={};r&8&&(s.editControl=n[10]),e.$set(s)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){T(e.$$.fragment,n),t=!1},d(n){Q(e,n)}}}function Dn(i){let e,t,n=i[2]&&i[12]<i[2].controlCount&&Ln(i);return{c(){n&&n.c(),e=re()},l(r){n&&n.l(r),e=re()},m(r,s){n&&n.m(r,s),N(r,e,s),t=!0},p(r,s){r[2]&&r[12]<r[2].controlCount?n?(n.p(r,s),s&4&&y(n,1)):(n=Ln(r),n.c(),y(n,1),n.m(e.parentNode,e)):n&&(oe(),T(n,1,1,()=>{n=null}),ce())},i(r){t||(y(n),t=!0)},o(r){T(n),t=!1},d(r){n&&n.d(r),r&&p(e)}}}function _l(i){let e,t,n=i[3].trsControls,r=[];for(let a=0;a<n.length;a+=1)r[a]=Dn(An(i,n,a));const s=a=>T(r[a],1,1,()=>{r[a]=null});return{c(){e=C("div");for(let a=0;a<r.length;a+=1)r[a].c();this.h()},l(a){e=M(a,"DIV",{id:!0,class:!0});var l=D(e);for(let o=0;o<r.length;o+=1)r[o].l(l);l.forEach(p),this.h()},h(){L(e,"id","controls"),L(e,"class","svelte-13ul1lp")},m(a,l){N(a,e,l);for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(e,null);t=!0},p(a,l){if(l&12){n=a[3].trsControls;let o;for(o=0;o<n.length;o+=1){const c=An(a,n,o);r[o]?(r[o].p(c,l),y(r[o],1)):(r[o]=Dn(c),r[o].c(),y(r[o],1),r[o].m(e,null))}for(oe(),o=n.length;o<r.length;o+=1)s(o);ce()}},i(a){if(!t){for(let l=0;l<n.length;l+=1)y(r[l]);t=!0}},o(a){r=r.filter(Boolean);for(let l=0;l<r.length;l+=1)T(r[l]);t=!1},d(a){a&&p(e),Je(r,a)}}}function gl(i){let e,t;return e=new qa({}),{c(){W(e.$$.fragment)},l(n){J(e.$$.fragment,n)},m(n,r){K(e,n,r),t=!0},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){T(e.$$.fragment,n),t=!1},d(n){Q(e,n)}}}function kn(i){let e,t;return e=new Ue({props:{$$slots:{default:[bl]},$$scope:{ctx:i}}}),{c(){W(e.$$.fragment)},l(n){J(e.$$.fragment,n)},m(n,r){K(e,n,r),t=!0},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){T(e.$$.fragment,n),t=!1},d(n){Q(e,n)}}}function bl(i){let e,t;return e=new Ka({}),e.$on("message",i[7]),{c(){W(e.$$.fragment)},l(n){J(e.$$.fragment,n)},m(n,r){K(e,n,r),t=!0},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){T(e.$$.fragment,n),t=!1},d(n){Q(e,n)}}}function vl(i){let e,t,n,r,s,a,l,o,c=Ce.gte(i[0].firmwareVersion,"2.1.0"),u,f;e=new ur({props:{$$slots:{default:[pl]},$$scope:{ctx:i}}}),n=new Ue({props:{$$slots:{default:[El]},$$scope:{ctx:i}}}),s=new Ue({props:{$$slots:{default:[_l]},$$scope:{ctx:i}}}),l=new Ue({props:{$$slots:{default:[gl]},$$scope:{ctx:i}}});let m=c&&kn(i);return{c(){W(e.$$.fragment),t=x(),W(n.$$.fragment),r=x(),W(s.$$.fragment),a=x(),W(l.$$.fragment),o=x(),m&&m.c(),u=re()},l(h){J(e.$$.fragment,h),t=j(h),J(n.$$.fragment,h),r=j(h),J(s.$$.fragment,h),a=j(h),J(l.$$.fragment,h),o=j(h),m&&m.l(h),u=re()},m(h,g){K(e,h,g),N(h,t,g),K(n,h,g),N(h,r,g),K(s,h,g),N(h,a,g),K(l,h,g),N(h,o,g),m&&m.m(h,g),N(h,u,g),f=!0},p(h,g){const P={};g&16385&&(P.$$scope={dirty:g,ctx:h}),e.$set(P);const w={};g&16396&&(w.$$scope={dirty:g,ctx:h}),n.$set(w);const I={};g&16396&&(I.$$scope={dirty:g,ctx:h}),s.$set(I);const v={};g&16384&&(v.$$scope={dirty:g,ctx:h}),l.$set(v),g&1&&(c=Ce.gte(h[0].firmwareVersion,"2.1.0")),c?m?g&1&&y(m,1):(m=kn(h),m.c(),y(m,1),m.m(u.parentNode,u)):m&&(oe(),T(m,1,1,()=>{m=null}),ce())},i(h){f||(y(e.$$.fragment,h),y(n.$$.fragment,h),y(s.$$.fragment,h),y(l.$$.fragment,h),y(m),f=!0)},o(h){T(e.$$.fragment,h),T(n.$$.fragment,h),T(s.$$.fragment,h),T(l.$$.fragment,h),T(m),f=!1},d(h){Q(e,h),h&&p(t),Q(n,h),h&&p(r),Q(s,h),h&&p(a),Q(l,h),h&&p(o),m&&m.d(h),h&&p(u)}}}function $l(i){let e,t,n,r;return e=new cr({props:{title:"Edit Configuration",$$slots:{default:[fl]},$$scope:{ctx:i}}}),n=new fr({props:{$$slots:{default:[vl]},$$scope:{ctx:i}}}),{c(){W(e.$$.fragment),t=x(),W(n.$$.fragment)},l(s){J(e.$$.fragment,s),t=j(s),J(n.$$.fragment,s)},m(s,a){K(e,s,a),N(s,t,a),K(n,s,a),r=!0},p(s,[a]){const l={};a&16386&&(l.$$scope={dirty:a,ctx:s}),e.$set(l);const o={};a&16397&&(o.$$scope={dirty:a,ctx:s}),n.$set(o)},i(s){r||(y(e.$$.fragment,s),y(n.$$.fragment,s),r=!0)},o(s){T(e.$$.fragment,s),T(n.$$.fragment,s),r=!1},d(s){Q(e,s),s&&p(t),Q(n,s)}}}function Nl(i,e,t){let n,r,s,a,l;se(i,_e,h=>t(0,r=h)),se(i,Ae,h=>t(8,s=h)),se(i,fe,h=>t(3,a=h)),se(i,Me,h=>t(9,l=h));let o=!1;fe.subscribe(h=>{h&&r&&t(1,o=!nr(h,r))});const c=()=>{Pe(Ae,s=!1,s)},u=()=>{a&&r&&ol(a,r)},f=()=>{Qe(a),$a(a,l),Pe(_e,r=a,r),Pe(Ae,s=!1,s)};function m(h){Yn.call(this,i,h)}return i.$$.update=()=>{i.$$.dirty&1&&t(2,n=r?Re(r.deviceId):null)},[r,o,n,a,c,u,f,m]}class Sl extends he{constructor(e){super(),de(this,e,Nl,$l,me,{})}}function Pn(i){let e,t,n,r,s,a,l=i[0].val!==void 0&&Bn(i);return{c(){e=C("dt"),t=G("Value"),n=C("dd"),r=C("div"),l&&l.c(),s=x(),a=C("div"),this.h()},l(o){e=M(o,"DT",{class:!0});var c=D(e);t=F(c,"Value"),c.forEach(p),n=M(o,"DD",{class:!0});var u=D(n);r=M(u,"DIV",{class:!0});var f=D(r);l&&l.l(f),s=j(f),a=M(f,"DIV",{class:!0,style:!0}),D(a).forEach(p),f.forEach(p),u.forEach(p),this.h()},h(){L(e,"class","svelte-5fijw0"),L(a,"class","bar svelte-5fijw0"),xt(a,"height",i[0].val+"px"),L(r,"class","inner svelte-5fijw0"),L(n,"class","display svelte-5fijw0")},m(o,c){N(o,e,c),$(e,t),N(o,n,c),$(n,r),l&&l.m(r,null),$(r,s),$(r,a)},p(o,c){o[0].val!==void 0?l?l.p(o,c):(l=Bn(o),l.c(),l.m(r,s)):l&&(l.d(1),l=null),c&1&&xt(a,"height",o[0].val+"px")},d(o){o&&p(e),o&&p(n),l&&l.d()}}}function Bn(i){let e,t=i[0].val+"",n,r;return{c(){e=C("span"),n=G(t),this.h()},l(s){e=M(s,"SPAN",{class:!0});var a=D(e);n=F(a,t),a.forEach(p),this.h()},h(){L(e,"class",r=jt(i[0].val<27?"lowvalue":"")+" svelte-5fijw0")},m(s,a){N(s,e,a),$(e,n)},p(s,a){a&1&&t!==(t=s[0].val+"")&&Ne(n,t),a&1&&r!==(r=jt(s[0].val<27?"lowvalue":"")+" svelte-5fijw0")&&L(e,"class",r)},d(s){s&&p(e)}}}function yl(i){let e,t,n=i[1]+1+"",r,s,a,l,o=i[0].channel+"",c,u,f,m,h=i[0].cc+"",g,P=!i[2]&&Pn(i);return{c(){e=C("dl"),t=C("dt"),r=G(n),s=C("dt"),a=G("Channel"),l=C("dd"),c=G(o),u=C("dt"),f=G("CC"),m=C("dd"),g=G(h),P&&P.c(),this.h()},l(w){e=M(w,"DL",{class:!0});var I=D(e);t=M(I,"DT",{class:!0});var v=D(t);r=F(v,n),v.forEach(p),s=M(I,"DT",{class:!0});var _=D(s);a=F(_,"Channel"),_.forEach(p),l=M(I,"DD",{class:!0});var d=D(l);c=F(d,o),d.forEach(p),u=M(I,"DT",{class:!0});var O=D(u);f=F(O,"CC"),O.forEach(p),m=M(I,"DD",{class:!0});var B=D(m);g=F(B,h),B.forEach(p),P&&P.l(I),I.forEach(p),this.h()},h(){L(t,"class","index svelte-5fijw0"),L(s,"class","svelte-5fijw0"),L(l,"class","svelte-5fijw0"),L(u,"class","svelte-5fijw0"),L(m,"class","svelte-5fijw0"),L(e,"class","config-column svelte-5fijw0")},m(w,I){N(w,e,I),$(e,t),$(t,r),$(e,s),$(s,a),$(e,l),$(l,c),$(e,u),$(u,f),$(e,m),$(m,g),P&&P.m(e,null)},p(w,[I]){I&2&&n!==(n=w[1]+1+"")&&Ne(r,n),I&1&&o!==(o=w[0].channel+"")&&Ne(c,o),I&1&&h!==(h=w[0].cc+"")&&Ne(g,h),w[2]?P&&(P.d(1),P=null):P?P.p(w,I):(P=Pn(w),P.c(),P.m(e,null))},i:le,o:le,d(w){w&&p(e),P&&P.d()}}}function wl(i,e,t){let{control:n}=e,{index:r}=e,{disableValue:s=!1}=e;return i.$$set=a=>{"control"in a&&t(0,n=a.control),"index"in a&&t(1,r=a.index),"disableValue"in a&&t(2,s=a.disableValue)},[n,r,s]}class hr extends he{constructor(e){super(),de(this,e,wl,yl,me,{control:0,index:1,disableValue:2})}}function Un(i,e,t){const n=i.slice();return n[6]=e[t],n[8]=t,n}function Gn(i,e,t){const n=i.slice();return n[6]=e[t],n[8]=t,n}function Il(i){let e,t,n,r;return e=new Te({props:{label:"Export current config",icon:"file-export",click:i[2]}}),n=new Te({props:{label:"Edit Config",icon:"pencil-alt",click:i[3]}}),{c(){W(e.$$.fragment),t=x(),W(n.$$.fragment)},l(s){J(e.$$.fragment,s),t=j(s),J(n.$$.fragment,s)},m(s,a){K(e,s,a),N(s,t,a),K(n,s,a),r=!0},p:le,i(s){r||(y(e.$$.fragment,s),y(n.$$.fragment,s),r=!0)},o(s){T(e.$$.fragment,s),T(n.$$.fragment,s),r=!1},d(s){Q(e,s),s&&p(t),Q(n,s)}}}function Rl(i){let e;return{c(){e=G("USB")},l(t){e=F(t,"USB")},m(t,n){N(t,e,n)},d(t){t&&p(e)}}}function Al(i){let e;return{c(){e=G("TRS Jack")},l(t){e=F(t,"TRS Jack")},m(t,n){N(t,e,n)},d(t){t&&p(e)}}}function Cl(i){let e,t,n,r;return e=new Ge({props:{$$slots:{default:[Rl]},$$scope:{ctx:i}}}),n=new Ge({props:{$$slots:{default:[Al]},$$scope:{ctx:i}}}),{c(){W(e.$$.fragment),t=x(),W(n.$$.fragment)},l(s){J(e.$$.fragment,s),t=j(s),J(n.$$.fragment,s)},m(s,a){K(e,s,a),N(s,t,a),K(n,s,a),r=!0},p(s,a){const l={};a&1024&&(l.$$scope={dirty:a,ctx:s}),e.$set(l);const o={};a&1024&&(o.$$scope={dirty:a,ctx:s}),n.$set(o)},i(s){r||(y(e.$$.fragment,s),y(n.$$.fragment,s),r=!0)},o(s){T(e.$$.fragment,s),T(n.$$.fragment,s),r=!1},d(s){Q(e,s),s&&p(t),Q(n,s)}}}function Fn(i){let e,t;return e=new hr({props:{control:i[6],index:i[8]}}),{c(){W(e.$$.fragment)},l(n){J(e.$$.fragment,n)},m(n,r){K(e,n,r),t=!0},p(n,r){const s={};r&1&&(s.control=n[6]),e.$set(s)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){T(e.$$.fragment,n),t=!1},d(n){Q(e,n)}}}function Vn(i){let e,t,n=i[1]&&i[8]<i[1].controlCount&&Fn(i);return{c(){n&&n.c(),e=re()},l(r){n&&n.l(r),e=re()},m(r,s){n&&n.m(r,s),N(r,e,s),t=!0},p(r,s){r[1]&&r[8]<r[1].controlCount?n?(n.p(r,s),s&2&&y(n,1)):(n=Fn(r),n.c(),y(n,1),n.m(e.parentNode,e)):n&&(oe(),T(n,1,1,()=>{n=null}),ce())},i(r){t||(y(n),t=!0)},o(r){T(n),t=!1},d(r){n&&n.d(r),r&&p(e)}}}function Ml(i){let e,t,n=i[0].usbControls,r=[];for(let a=0;a<n.length;a+=1)r[a]=Vn(Gn(i,n,a));const s=a=>T(r[a],1,1,()=>{r[a]=null});return{c(){e=C("div");for(let a=0;a<r.length;a+=1)r[a].c();this.h()},l(a){e=M(a,"DIV",{id:!0,class:!0});var l=D(e);for(let o=0;o<r.length;o+=1)r[o].l(l);l.forEach(p),this.h()},h(){L(e,"id","controls"),L(e,"class","svelte-13ul1lp")},m(a,l){N(a,e,l);for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(e,null);t=!0},p(a,l){if(l&3){n=a[0].usbControls;let o;for(o=0;o<n.length;o+=1){const c=Gn(a,n,o);r[o]?(r[o].p(c,l),y(r[o],1)):(r[o]=Vn(c),r[o].c(),y(r[o],1),r[o].m(e,null))}for(oe(),o=n.length;o<r.length;o+=1)s(o);ce()}},i(a){if(!t){for(let l=0;l<n.length;l+=1)y(r[l]);t=!0}},o(a){r=r.filter(Boolean);for(let l=0;l<r.length;l+=1)T(r[l]);t=!1},d(a){a&&p(e),Je(r,a)}}}function Hn(i){let e,t;return e=new hr({props:{control:i[6],index:i[8],disableValue:!0}}),{c(){W(e.$$.fragment)},l(n){J(e.$$.fragment,n)},m(n,r){K(e,n,r),t=!0},p(n,r){const s={};r&1&&(s.control=n[6]),e.$set(s)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){T(e.$$.fragment,n),t=!1},d(n){Q(e,n)}}}function xn(i){let e,t,n=i[1]&&i[8]<i[1].controlCount&&Hn(i);return{c(){n&&n.c(),e=re()},l(r){n&&n.l(r),e=re()},m(r,s){n&&n.m(r,s),N(r,e,s),t=!0},p(r,s){r[1]&&r[8]<r[1].controlCount?n?(n.p(r,s),s&2&&y(n,1)):(n=Hn(r),n.c(),y(n,1),n.m(e.parentNode,e)):n&&(oe(),T(n,1,1,()=>{n=null}),ce())},i(r){t||(y(n),t=!0)},o(r){T(n),t=!1},d(r){n&&n.d(r),r&&p(e)}}}function Tl(i){let e,t,n,r,s,a=i[0].trsControls,l=[];for(let c=0;c<a.length;c+=1)l[c]=xn(Un(i,a,c));const o=c=>T(l[c],1,1,()=>{l[c]=null});return{c(){e=C("div");for(let c=0;c<l.length;c+=1)l[c].c();t=x(),n=C("p"),r=G("There is no realtime preview of the TRS outputs."),this.h()},l(c){e=M(c,"DIV",{id:!0,class:!0});var u=D(e);for(let m=0;m<l.length;m+=1)l[m].l(u);u.forEach(p),t=j(c),n=M(c,"P",{});var f=D(n);r=F(f,"There is no realtime preview of the TRS outputs."),f.forEach(p),this.h()},h(){L(e,"id","controls"),L(e,"class","svelte-13ul1lp")},m(c,u){N(c,e,u);for(let f=0;f<l.length;f+=1)l[f]&&l[f].m(e,null);N(c,t,u),N(c,n,u),$(n,r),s=!0},p(c,u){if(u&3){a=c[0].trsControls;let f;for(f=0;f<a.length;f+=1){const m=Un(c,a,f);l[f]?(l[f].p(m,u),y(l[f],1)):(l[f]=xn(m),l[f].c(),y(l[f],1),l[f].m(e,null))}for(oe(),f=a.length;f<l.length;f+=1)o(f);ce()}},i(c){if(!s){for(let u=0;u<a.length;u+=1)y(l[u]);s=!0}},o(c){l=l.filter(Boolean);for(let u=0;u<l.length;u+=1)T(l[u]);s=!1},d(c){c&&p(e),Je(l,c),c&&p(t),c&&p(n)}}}function Ol(i){let e,t,n,r,s,a;return e=new ur({props:{$$slots:{default:[Cl]},$$scope:{ctx:i}}}),n=new Ue({props:{$$slots:{default:[Ml]},$$scope:{ctx:i}}}),s=new Ue({props:{$$slots:{default:[Tl]},$$scope:{ctx:i}}}),{c(){W(e.$$.fragment),t=x(),W(n.$$.fragment),r=x(),W(s.$$.fragment)},l(l){J(e.$$.fragment,l),t=j(l),J(n.$$.fragment,l),r=j(l),J(s.$$.fragment,l)},m(l,o){K(e,l,o),N(l,t,o),K(n,l,o),N(l,r,o),K(s,l,o),a=!0},p(l,o){const c={};o&1024&&(c.$$scope={dirty:o,ctx:l}),e.$set(c);const u={};o&1027&&(u.$$scope={dirty:o,ctx:l}),n.$set(u);const f={};o&1027&&(f.$$scope={dirty:o,ctx:l}),s.$set(f)},i(l){a||(y(e.$$.fragment,l),y(n.$$.fragment,l),y(s.$$.fragment,l),a=!0)},o(l){T(e.$$.fragment,l),T(n.$$.fragment,l),T(s.$$.fragment,l),a=!1},d(l){Q(e,l),l&&p(t),Q(n,l),l&&p(r),Q(s,l)}}}function Ll(i){let e,t,n,r;return e=new cr({props:{title:"Current Configuration",$$slots:{default:[Il]},$$scope:{ctx:i}}}),n=new fr({props:{$$slots:{default:[Ol]},$$scope:{ctx:i}}}),{c(){W(e.$$.fragment),t=x(),W(n.$$.fragment)},l(s){J(e.$$.fragment,s),t=j(s),J(n.$$.fragment,s)},m(s,a){K(e,s,a),N(s,t,a),K(n,s,a),r=!0},p(s,[a]){const l={};a&1024&&(l.$$scope={dirty:a,ctx:s}),e.$set(l);const o={};a&1027&&(o.$$scope={dirty:a,ctx:s}),n.$set(o)},i(s){r||(y(e.$$.fragment,s),y(n.$$.fragment,s),r=!0)},o(s){T(e.$$.fragment,s),T(n.$$.fragment,s),r=!1},d(s){Q(e,s),s&&p(t),Q(n,s)}}}function Dl(i,e,t){let n,r,s,a;se(i,_e,c=>t(0,r=c)),se(i,fe,c=>t(4,s=c)),se(i,Ae,c=>t(5,a=c));const l=()=>{r&&cl(r)},o=()=>{Pe(Ae,a=!0,a),r&&Pe(fe,s=structuredClone(r),s)};return i.$$.update=()=>{i.$$.dirty&1&&t(1,n=r?Re(r.deviceId):null)},[r,n,l,o]}class kl extends he{constructor(e){super(),de(this,e,Dl,Ll,me,{})}}function Pl(i){let e,t;return{c(){e=C("p"),t=G(`WebMIDI could not be enabled. Please use a web browser that supports
        WebMIDI, such as Google Chrome.`),this.h()},l(n){e=M(n,"P",{class:!0});var r=D(e);t=F(r,`WebMIDI could not be enabled. Please use a web browser that supports
        WebMIDI, such as Google Chrome.`),r.forEach(p),this.h()},h(){L(e,"class","notice svelte-kpoxps")},m(n,r){N(n,e,r),$(e,t)},p:le,i:le,o:le,d(n){n&&p(e)}}}function Bl(i){let e,t,n,r;const s=[Gl,Ul],a=[];function l(o,c){return o[1]?0:1}return e=l(i),t=a[e]=s[e](i),{c(){t.c(),n=re()},l(o){t.l(o),n=re()},m(o,c){a[e].m(o,c),N(o,n,c),r=!0},p(o,c){let u=e;e=l(o),e===u?a[e].p(o,c):(oe(),T(a[u],1,1,()=>{a[u]=null}),ce(),t=a[e],t?t.p(o,c):(t=a[e]=s[e](o),t.c()),y(t,1),t.m(n.parentNode,n))},i(o){r||(y(t),r=!0)},o(o){T(t),r=!1},d(o){a[e].d(o),o&&p(n)}}}function Ul(i){let e,t;return{c(){e=C("p"),t=G("Connect a controller via USB."),this.h()},l(n){e=M(n,"P",{class:!0});var r=D(e);t=F(r,"Connect a controller via USB."),r.forEach(p),this.h()},h(){L(e,"class","notice svelte-kpoxps")},m(n,r){N(n,e,r),$(e,t)},p:le,i:le,o:le,d(n){n&&p(e)}}}function Gl(i){let e,t,n,r,s;const a=[Vl,Fl],l=[];function o(c,u){return u&6&&(e=null),e==null&&(e=!!(c[2]&&Ce.gte(c[1].firmwareVersion,"2.1.0"))),e?0:1}return t=o(i,-1),n=l[t]=a[t](i),{c(){n.c(),r=re()},l(c){n.l(c),r=re()},m(c,u){l[t].m(c,u),N(c,r,u),s=!0},p(c,u){let f=t;t=o(c,u),t===f?l[t].p(c,u):(oe(),T(l[f],1,1,()=>{l[f]=null}),ce(),n=l[t],n?n.p(c,u):(n=l[t]=a[t](c),n.c()),y(n,1),n.m(r.parentNode,r))},i(c){s||(y(n),s=!0)},o(c){T(n),s=!1},d(c){l[t].d(c),c&&p(r)}}}function Fl(i){let e,t,n,r,s;const a=[xl,Hl],l=[];function o(c,u){return c[3]?0:1}return e=o(i),t=l[e]=a[e](i),{c(){t.c(),n=x(),r=C("p")},l(c){t.l(c),n=j(c),r=M(c,"P",{}),D(r).forEach(p)},m(c,u){l[e].m(c,u),N(c,n,u),N(c,r,u),s=!0},p(c,u){let f=e;e=o(c),e!==f&&(oe(),T(l[f],1,1,()=>{l[f]=null}),ce(),t=l[e],t||(t=l[e]=a[e](c),t.c()),y(t,1),t.m(n.parentNode,n))},i(c){s||(y(t),s=!0)},o(c){T(t),s=!1},d(c){l[e].d(c),c&&p(n),c&&p(r)}}}function Vl(i){let e,t,n,r,s,a,l;return a=new Te({props:{label:"Click to reset your 16n's EEPROM to factory defaults",click:i[5]}}),{c(){e=C("div"),t=C("p"),n=G(`It looks like a 16n is trying to connect, but may have a corrupt
              memory.`),r=x(),s=C("p"),W(a.$$.fragment),this.h()},l(o){e=M(o,"DIV",{class:!0});var c=D(e);t=M(c,"P",{});var u=D(t);n=F(u,`It looks like a 16n is trying to connect, but may have a corrupt
              memory.`),u.forEach(p),r=j(c),s=M(c,"P",{});var f=D(s);J(a.$$.fragment,f),f.forEach(p),c.forEach(p),this.h()},h(){L(e,"class","notice svelte-kpoxps")},m(o,c){N(o,e,c),$(e,t),$(t,n),$(e,r),$(e,s),K(a,s,null),l=!0},p:le,i(o){l||(y(a.$$.fragment,o),l=!0)},o(o){T(a.$$.fragment,o),l=!1},d(o){o&&p(e),Q(a)}}}function Hl(i){let e,t;return e=new kl({}),{c(){W(e.$$.fragment)},l(n){J(e.$$.fragment,n)},m(n,r){K(e,n,r),t=!0},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){T(e.$$.fragment,n),t=!1},d(n){Q(e,n)}}}function xl(i){let e,t;return e=new Sl({}),{c(){W(e.$$.fragment)},l(n){J(e.$$.fragment,n)},m(n,r){K(e,n,r),t=!0},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){T(e.$$.fragment,n),t=!1},d(n){Q(e,n)}}}function jl(i){let e,t,n,r,s,a,l,o,c,u,f,m,h,g,P,w;a=new Pa({});const I=[Bl,Pl],v=[];function _(d,O){return d[0]?0:1}return c=_(i),u=v[c]=I[c](i),{c(){e=C("main"),t=C("div"),n=C("h1"),r=G("16n configuration tool"),s=x(),W(a.$$.fragment),l=x(),o=C("div"),u.c(),f=x(),m=C("div"),h=C("div"),g=G("16n Editor v"),P=G(i[4]),this.h()},l(d){e=M(d,"MAIN",{class:!0});var O=D(e);t=M(O,"DIV",{id:!0,class:!0});var B=D(t);n=M(B,"H1",{class:!0});var Y=D(n);r=F(Y,"16n configuration tool"),Y.forEach(p),s=j(B),J(a.$$.fragment,B),B.forEach(p),l=j(O),o=M(O,"DIV",{id:!0,class:!0});var ee=D(o);u.l(ee),ee.forEach(p),f=j(O),m=M(O,"DIV",{id:!0,class:!0});var te=D(m);h=M(te,"DIV",{class:!0});var ae=D(h);g=F(ae,"16n Editor v"),P=F(ae,i[4]),ae.forEach(p),te.forEach(p),O.forEach(p),this.h()},h(){L(n,"class","svelte-kpoxps"),L(t,"id","head"),L(t,"class","svelte-kpoxps"),L(o,"id","inner"),L(o,"class","svelte-kpoxps"),L(h,"class","foot-left svelte-kpoxps"),L(m,"id","foot"),L(m,"class","svelte-kpoxps"),L(e,"class","svelte-kpoxps")},m(d,O){N(d,e,O),$(e,t),$(t,n),$(n,r),$(t,s),K(a,t,null),$(e,l),$(e,o),v[c].m(o,null),$(e,f),$(e,m),$(m,h),$(h,g),$(h,P),w=!0},p(d,[O]){let B=c;c=_(d),c===B?v[c].p(d,O):(oe(),T(v[B],1,1,()=>{v[B]=null}),ce(),u=v[c],u?u.p(d,O):(u=v[c]=I[c](d),u.c()),y(u,1),u.m(o,null))},i(d){w||(y(a.$$.fragment,d),y(u),w=!0)},o(d){T(a.$$.fragment,d),T(u),w=!1},d(d){d&&p(e),Q(a),v[c].d()}}}function ql(i,e,t){let n,r,s,a,l;se(i,Me,f=>t(6,n=f)),se(i,Gt,f=>t(0,r=f)),se(i,_e,f=>t(1,s=f)),se(i,ft,f=>t(2,a=f)),se(i,Ae,f=>t(3,l=f));const o="2.0.5",c=!!navigator.requestMIDIAccess;return pr(()=>{c&&R.enable({sysex:!0}).then(ya).catch(f=>alert(f))}),[r,s,a,l,o,()=>{n&&sr(n)}]}class Wl extends he{constructor(e){super(),de(this,e,ql,jl,me,{})}}export{Wl as component};
